webpackJsonp([85],{"4O/J":function(t,e,a){"use strict";e.a={name:"detailStyle",props:["info"]}},"61ld":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{class:t.getClassName()},[a("div",{staticClass:"ui-label",class:{circle:"circle"==t.type}},[t._v("\n\t\t"+t._s(t.label)+"\n\t")]),a("div",{staticClass:"ui-text"},[t._t("default")],2)])},i=[],o={render:n,staticRenderFns:i};e.a=o},"9pIO":function(t,e,a){"use strict";function n(t,e){if(t)for(var a=t.querySelectorAll(".ivu-table-sort"),n=0;n<a.length;n++){var o=a[n];o.style.width="auto",o.style.height="40px";var r=o.parentNode,s=r.querySelectorAll("span")[0].innerHTML;i(o,t,s,e)}}function i(t,e,a,n){t.innerHTML="";var i=document.createElement("span");i.className=r("init"),t.appendChild(i),i.onclick=function(t){var i=t.target,l=i.className;s(e),i.className=r(l),n({label:a,order:o(l)})}}function o(t){return"kr-table-sort-icon-asc"===t?"desc":"asc"}function r(t){switch(t){case"kr-table-sort-icon-init":return"kr-table-sort-icon-asc";case"kr-table-sort-icon-asc":return"kr-table-sort-icon-desc";case"kr-table-sort-icon-desc":return"kr-table-sort-icon-asc";default:return"kr-table-sort-icon-init"}}function s(t){for(var e=t.querySelectorAll(".ivu-table-sort span"),a=0;a<e.length;a++){e[a].className=r("init")}}e.a=n},A7Ww:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,'.ui-labeltext{width:45%;height:14px;font-size:14px;color:#333;line-height:14px;padding-left:14px;margin-bottom:24px;display:inline-block}.ui-labeltext .circle:before{content:"";display:inline-block;width:8px;height:8px;border:1px solid #333;border-radius:5px}.ui-labeltext .ui-label{font-weight:700;line-height:20px}.ui-label-text-inline .ui-label,.ui-label-text-inline .ui-text{display:inline-block}.ui-label-text-unline .ui-label{margin-bottom:8px}.ui-label-text-unline .ui-label,.ui-label-text-unline .ui-text{display:block}',""])},Asao:function(t,e,a){"use strict";function n(){switch((0,Object.prototype.toString.call)(0)){case"[object String]":return"string";case"[object Number]":return"number";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Function]":return"function";case"[object Date]":return"date";case"[object Array]":return"array";case"[object RegExp]":return"regExp";case"[object Error]":return"error";case"[object HTMLDocument]":return"node";case"[object global]":return"global"}}e.a=n},DekW:function(t,e,a){"use strict";function n(t){a("feWE")}Object.defineProperty(e,"__esModule",{value:!0});var i=a("fw/o"),o=a("YH68"),r=a("VU/8"),s=n,l=r(i.a,o.a,!1,s,"data-v-6541b38a",null);e.default=l.exports},Eqh0:function(t,e,a){"use strict";function n(t){if(t){return o.a.dateToStr("YYYY/MM/DD HH:mm:SS",new Date(t)).replace(/\//g,"-")}return""}var i=a("g4Hp"),o=a.n(i);e.a=n},IoNu:function(t,e){t.exports=function(t,e,a,n){function i(){function i(){r=Number(new Date),a.apply(l,d)}function s(){o=void 0}var l=this,c=Number(new Date)-r,d=arguments;n&&!o&&i(),o&&clearTimeout(o),void 0===n&&c>t?i():!0!==e&&(o=setTimeout(n?s:i,void 0===n?t-c:t))}var o,r=0;return"boolean"!=typeof e&&(n=a,a=e,e=void 0),i}},Kozl:function(t,e,a){"use strict";e.a={name:"labelText",props:["label","inline","type"],data:function(){return{labeltextClass:"ui-labeltext",inlineClass:"inline",unlineClass:"unline"}},methods:{getClassName:function(){var t="ui-labeltext";return this.inline?t+=" ui-label-text-unline":t+=" ui-label-text-inline",t}}}},NpwQ:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"ui-detail-layout"},[a("div",{staticClass:"ui-content-title"},[a("span",{staticClass:"ui-circle"},[t._v(t._s(t.info))])]),t._t("default")],2)},i=[],o={render:n,staticRenderFns:i};e.a=o},"SP/+":function(t,e,a){"use strict";function n(t){a("dhjp")}var i=a("Kozl"),o=a("61ld"),r=a("VU/8"),s=n,l=r(i.a,o.a,!1,s,null,null);e.a=l.exports},"Ta+G":function(t,e,a){"use strict";function n(t){var e=t.type;return"DOMMouseScroll"!=e&&"mousewheel"!=e||(t.delta=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3),t.srcElement&&!t.target&&(t.target=t.srcElement),t.preventDefault||void 0===t.returnValue||(t.preventDefault=function(){t.returnValue=!1}),t}var i=function(t,e,a,i){console.log("-------"),window.addEventListener?("mousewheel"===e&&void 0!==document.mozFullScreen&&(e="DOMMouseScroll"),t.addEventListener(e,function(t){a(n(t))},i||!1)):window.attachEvent&&t.attachEvent("on"+e,function(t){t=t||window.event,a(n(t))})};e.a=i},YH68:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"g-order-detail"},[t._m(0),a("div",{staticClass:"m-detail-content"},[a("DetailStyle",{attrs:{info:"基本信息"}},[a("LabelText",{attrs:{label:"结算单编号："}},[t._v("\n\t\t\t    "+t._s(t.basicInfo.checklistNum)+"\n\t\t\t")]),a("LabelText",{attrs:{label:"状态："}},[t._v("\n\t\t\t\t"+t._s(t.basicInfo.checklistStatusName)+"\n\t\t\t")]),a("LabelText",{attrs:{label:"客户名称："}},[t._v("\n\t\t\t\t"+t._s(t.basicInfo.csrName)+"\n\t\t\t")]),a("LabelText",{attrs:{label:"社区名称："}},[t._v("\n\t\t\t\t"+t._s(t.basicInfo.cmtName)+"\n\t\t\t")]),a("LabelText",{attrs:{label:"服务尾日："}},[t._v("\n\t\t\t    "+t._s(t._f("dateFormat")(t.basicInfo.lastServiceDate,"YYYY-MM-dd"))+"\n\t\t\t")]),a("LabelText",{attrs:{label:"生效日期："}},[t._v("\n\t\t\t\t"+t._s(t._f("dateFormat")(t.basicInfo.effectDate,"YYYY-MM-dd HH:mm:ss"))+"\n\t\t\t")]),a("LabelText",{attrs:{label:"生成日期："}},[t._v("\n\t\t\t\t"+t._s(t._f("dateFormat")(t.basicInfo.ctime,"YYYY-MM-dd HH:mm:ss"))+"\n\t\t\t")])],1),a("DetailStyle",{attrs:{info:"结算信息"}},[a("Table",{attrs:{columns:t.service,data:t.details,border:""}}),a("div",[a("div",{staticClass:"amount-list"},[a("span",{staticClass:"amount-name"},[t._v("用户余额：")]),a("span",{staticClass:"amount-content"},[t._v(t._s(t._f("thousand")(t.basicInfo.balance))+" ")])]),a("div",{staticClass:"amount-list"},[a("span",{staticClass:"amount-name"},[t._v("在押履约保证金：")]),a("span",{staticClass:"amount-content"},[t._v(t._s(t._f("thousand")(t.basicInfo.deposit))+"  ")])]),a("div",{staticClass:"amount-list"},[a("span",{staticClass:"amount-name"},[t._v("未结算总额：")]),a("span",{staticClass:"amount-content"},[t._v(t._s(t._f("thousand")(t.ownAmount))+" ")])]),a("div",{staticClass:"amount-list",staticStyle:{color:"red"}},[a("span",{staticClass:"amount-name"},[t._v("应退款金额：")]),a("span",{staticClass:"amount-content"},[t._v(t._s(t._f("thousand")(t.totalRefunds))+" ")])])])],1),a("DetailStyle",{attrs:{info:"附件信息"}},[t.attachmentList.length?t._e():a("div",{staticClass:"none-list",staticStyle:{"margin-left":"12px"}},[t._v("暂无附件")]),t._l(t.attachmentList,function(e){return a("div",{staticClass:"file-list",staticStyle:{"margin-left":"12px"}},[a("span",{staticStyle:{cursor:"pointer"},on:{click:function(a){t.downFile(e)}}},[t._v(t._s(e.fileName))])])}),a("div",{staticStyle:{width:"200px","margin-left":"12px"}},[t.isUploading?a("Progress",{attrs:{percent:t.progress,"stroke-width":5}}):t._e()],1),a("div",{staticClass:"bottom",staticStyle:{height:"20px"}})],2)],1),a("div",{staticClass:"m-detail-buttons"},[a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.download}},[t._v("下载PDF文件")]),a("Button",{directives:[{name:"show",rawName:"v-show",value:"UNEFFECTIVE"==t.basicInfo.checklistStatus,expression:"basicInfo.checklistStatus=='UNEFFECTIVE'"}],staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.edit}},[t._v("编辑")]),a("Button",{directives:[{name:"show",rawName:"v-show",value:"UNEFFECTIVE"==t.basicInfo.checklistStatus&&t.attachmentList.length,expression:"basicInfo.checklistStatus=='UNEFFECTIVE' && attachmentList.length"}],staticStyle:{"margin-left":"8px"},attrs:{type:"primary"},on:{click:t.becomeEffective}},[t._v("生效")]),a("div",{staticClass:"file-button"},[a("input",{attrs:{type:"file",name:"file"},on:{change:t.onChange}}),t._v("上传附件")])],1),a("Modal",{attrs:{title:"账单生效",width:"660"},model:{value:t.openTakeEffect,callback:function(e){t.openTakeEffect=e},expression:"openTakeEffect"}},[a("div",[t._v("账单是否生效?")]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:t.takeEffectSubmit}},[t._v("确定")]),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.becomeEffective}},[t._v("取消")])],1)])],1)},i=[function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"m-detail-header"},[a("span",{staticClass:"u-border-left"}),t._v("\n\t\t客户撤场结算单\n\t")])}],o={render:n,staticRenderFns:i};e.a=o},bsze:function(t,e,a){"use strict";function n(t){var e=["角","分"],a=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],n=[["元","万","亿"],["","拾","佰","仟"]],i=t<0?"负":"";t=Math.abs(t);var o="",r=(t+"").split(".").length,s="00";r>1&&(s=(t+"").split(".")[1]);for(var l=0;l<e.length;l++)a[s[l]]&&(o+=(a[s[l]]+e[l]).replace(/零./,""));o=o||"整",t=Math.floor(t);for(var l=0;l<n[0].length&&t>0;l++){for(var c="",d=0;d<n[1].length&&t>0;d++)c=a[t%10]+n[1][d]+c,t=Math.floor(t/10);o=c.replace(/(零.)*零$/,"").replace(/^$/,"零")+n[0][l]+o}return i+o.replace(/(零.)*零元/,"元").replace(/(零.)+/g,"零").replace(/^整$/,"零元整")}function i(t){for(var e in t)t[e]=""}function o(t,e){var a=[];for(var n in t)t.hasOwnProperty(n)&&a.push(n+"="+t[n]);var e=e+"?"+a.join("&");window.location.href=e}function r(){var t=location.search,e=new Object;if(-1!=t.indexOf("?"))for(var a=t.substr(1),n=a.split("&"),i=0;i<n.length;i++)e[n[i].split("=")[0]]=unescape(n[i].split("=")[1]);return e}function s(t){var e=window.location.href,a=e.split("?")[0],n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(i+"="+t[i]);a=a+"?"+n.join("&"),location.href=a}function l(t){for(var e,a=0,n={},i=[];e=t[a++];){var o=e.id;n[o]||(n[o]=!0,i.push(e))}return i}function c(t,e,a,n){for(var i=0;i<e.length;i++)for(var o=0;o<t.length;o++){var r=a?t[o][a]:t[o],s=n?e[i][n]:e[i];r==s&&t.splice(o,1)}return t}function d(t,e){var a=document.createElement("a");a.href=t,a.download=e,console.log("a--",a,t,e),a.click()}function u(t,e){var a=document.createElement("a");a.href=t,a.target="_blank",a.download=e,a.click()}function p(t,e){return e=parseInt(e,10),new Date(t,e,0).getDate()}function f(t,e){var a,n,i;return a=t.split("-"),n=new Date(a[1]+"/"+a[2]+"/"+a[0]),a=e.split("-"),i=new Date(a[1]+"/"+a[2]+"/"+a[0]),parseInt(Math.abs(n-i)/1e3/60/60/24)}function h(t,e,a){return void 0===a?k()(t,e,!1):k()(t,a,!1!==e)}function m(t,e){var a=new Date(t),n=new Date(a.getFullYear(),a.getMonth(),a.getDate()+e);a.getFullYear(),a.getMonth(),a.getDate();return n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()}function b(){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var e=document.createElement("div"),a=e.style;a.position="absolute",a.top=0,a.left=0,a.pointerEvents="none",a.visibility="hidden",a.width="200px",a.height="150px",a.overflow="hidden",e.appendChild(t),document.body.appendChild(e);var n=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;return n===i&&(i=e.clientWidth),document.body.removeChild(e),n-i}function g(t,e){var a,n,i;return a=t.split("-"),n=new Date(a[1]+"/"+a[2]+"/"+a[0]),a=e.split("-"),i=new Date(a[1]+"/"+a[2]+"/"+a[0]),parseInt(Math.abs(n-i)/1e3/60/60/24)}var v=a("syeK"),x=a("Ta+G"),y=a("Asao"),w=a("IoNu"),k=a.n(w),_=a("Eqh0"),E=a("9pIO");e.a={smalltoBIG:n,clearForm:i,commonExport:o,getRequest:r,addParams:s,arrayNoRepeat:l,arrayCompare:c,thousand:v.a,downFile:d,addEvent:x.a,dataType:y.a,getDaysInOneMonth:p,dateDiff:f,debounce:h,getScrollBarSize:b,dateCompatible:_.a,tableSort:E.a,dateRange:m,downImg:u,timeRange:g}},bvBQ:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".g-order-detail[data-v-6541b38a]{margin:-10px}.g-order-detail .m-detail-header[data-v-6541b38a]{height:50px;border-bottom:1px solid #e8e9e9;line-height:50px;font-size:16px;color:#666}.g-order-detail .m-detail-header .u-border-left[data-v-6541b38a]{width:0;height:24px;border:2px solid #499df1;margin-right:20px}.g-order-detail .m-detail-content[data-v-6541b38a]{padding:30px 24px}.g-order-detail .m-detail-content .ivu-table-wrapper[data-v-6541b38a]{margin-bottom:30px}.g-order-detail .m-detail-buttons[data-v-6541b38a]{margin-left:40px;margin-bottom:40px}.g-order-detail .amount-list[data-v-6541b38a]{font-weight:700;display:block;width:230px;height:30px;line-height:30px;text-align:right;margin-left:auto}.g-order-detail .amount-list .amount-name[data-v-6541b38a]{width:120px;display:inline-block}.g-order-detail .amount-list .amount-content[data-v-6541b38a]{width:100px;display:inline-block}.g-order-detail .file-list[data-v-6541b38a]{color:#499df1;font-size:15px;font-weight:600;height:30px;line-height:30px}.g-order-detail .file-button[data-v-6541b38a]{height:32px;width:100px;color:#fff;background-color:#2d8cf0;border:none;line-height:35px;position:relative;text-align:center;overflow:hidden;display:inline-block;border-radius:4px;vertical-align:bottom;margin-left:8px}.g-order-detail .file-button input[type=file][data-v-6541b38a]{opacity:0;position:absolute;top:0;left:0;right:0;bottom:0}.g-order-detail .file-button .progress[data-v-6541b38a]{display:block;top:0;left:0;right:0;bottom:0;position:absolute;background:rgba(43,141,205,.7)}",""])},dhjp:function(t,e,a){var n=a("A7Ww");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("6397b5a0",n,!0,{sourceMap:!1})},feWE:function(t,e,a){var n=a("bvBQ");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("7e1529f5",n,!0,{sourceMap:!1})},"fw/o":function(t,e,a){"use strict";var n=a("yWLh"),i=a("SP/+"),o=a("bsze"),r=a("g4Hp");a.n(r);e.a={components:{DetailStyle:n.a,LabelText:i.a},head:function(){return{title:"结算单详情页"}},data:function(){return{disabled:!1,ownAmount:0,totalRefunds:0,location:"",openTakeEffect:!1,basicInfo:{},service:[{title:"费用名称",key:"feeTypeName",align:"center",render:function(t,e){return e.row.billId?e.row.billName:e.row.feeTypeName}},{title:"费用金额(元)",key:"payableAmount",align:"right",render:function(t,e){return o.a.thousand(e.row.payableAmount)}}],contract:[{title:"时间",key:"contractNum",align:"center"},{title:"账号",key:"rentAmount",align:"center"},{title:"详情",key:"orderStatusTypeName",align:"center"}],details:[],contractData:[],progress:0,isUploading:!1,attachmentList:[]}},mounted:function(){GLOBALSIDESWITCH("false");var t=this.$route.params,e={checklistId:t.billId};console.log("checklistId",e);var a=this;this.$http.get("get-settlement-detail",e,function(t){var e=0;t.data.details.map(function(t){e+=100*t.payableAmount}),a.ownAmount=e/100;var n=100*t.data.deposit,i=100*t.data.balance;a.totalRefunds=(n+i-e)/100,a.basicInfo=t.data,a.details=t.data.details,a.attachmentList=t.data.attachments},function(t){a.$Notice.error({title:t.message})})},methods:{becomeEffective:function(){this.openTakeEffect=!this.openTakeEffect},takeEffectSubmit:function(){var t=this;this.$http.post("post-effective",{checklistId:this.$route.params.billId}).then(function(e){t.becomeEffective(),t.$Notice.success({title:"生效成功"}),location.reload()}).catch(function(e){t.$Notice.error({title:e.message})})},edit:function(){var t=this.$route.params;window.open("/bill/settlement-list/"+t.billId+"/edit/")},download:function(){this.downloadUrl()},downloadUrl:function(){var t=this,e=this.$route.params;this.$http.get("get-settlement-pdf-id",{checklistId:e.billId}).then(function(e){t.downloadContent(e.data.pdfId)}).catch(function(e){t.$Notice.error({title:e.message})})},onChange:function(t){var e=this,a=t.target.files[0],n=a.name;if(a){if(a){this.progress=0,this.isUploading=!0;var i=window.setInterval(function(){e.progress>=100&&(this.isUploading=!1,window.clearInterval(i)),e.progress+=10},300)}var o=new FormData,r=new XMLHttpRequest;r.onreadystatechange=function(){if(4===r.readyState)if(200===r.status){var t=r.response.data;o.append("OSSAccessKeyId",t.ossAccessKeyId),o.append("policy",t.policy),o.append("Signature",t.sign),o.append("key",t.pathPrefix+"/"+a.name),o.append("uid",t.uid),o.append("callback",t.callback),o.append("x:original_name",a.name),o.append("file",a);var i=new XMLHttpRequest;i.onreadystatechange=function(){if(4===i.readyState){var t=i.response;if(200===i.status)if(t&&t.code>0){var a={};e.isShowProgress="none",e.progress=100,a.name=n,a.url=t.data.url,a.fileId=""+t.data.id,a.fileName=n,a.fileUrl=t.data.url,a.type="ATTACHMENT",e.onSuccess(a)}else e.isShowProgress="none",e.progress=100,console.log(t.msg),e.$Notice.error({title:t.msg}),e.onError(t.msg);else 413==i.status?(e.isShowProgress="none",e.progress=100,e.$Notice.error({title:"您上传的文件过大！"}),e.onError("您上传的文件过大！")):(e.isShowProgress="none",e.progress=100,e.$Notice.error({title:"后台报错请联系管理员！"}))}},i.open("POST",t.serverUrl,!0),i.responseType="json",i.send(o)}else e.onTokenError()},r.open("GET","/api/krspace-op-web/sys/upload-policy?isPublic=true&category=op/upload",!0),r.responseType="json",r.send()}},onSuccess:function(t){var e=this;this.$http.post("post-checklist-list",{checklistId:this.$route.params.billId,fileId:t.fileId,fileName:t.fileName}).then(function(t){e.getAttachmentList()}).catch(function(t){e.$Notice.error({title:t.message})})},onError:function(t){t=t||"上传文件失败",this.progress=0,this.isUploading=!1,alert(t)},onTokenError:function(){alert("初始化上传文件失败")},getAttachmentList:function(){var t=this;this.$http.get("get-checklist-list",{checklistId:this.$route.params.billId}).then(function(e){t.attachmentList=e.data.attachments,t.isUploading=!1}).catch(function(e){t.$Notice.error({title:e.message})})},downFile:function(t){var e=this;this.$http.post("get-station-contract-pdf-url",{id:t.fileId},function(t){o.a.downFile(t.data)},function(t){e.$Notice.error({title:t.message})})},downloadContent:function(t){this.$http.post("get-station-contract-pdf-url",{id:t}).then(function(t){o.a.downFile(t.data)}).catch(function(t){that.$Notice.error({title:t.message})})}}}},gnYt:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,'.u-clearfix{zoom:1}.u-clearfix:after{clear:both;content:".";height:0;display:block;visibility:hidden}.left{float:left}.ui-detail-layout{padding:0 24px;font-size:14px;color:#333;line-height:14px}.ui-detail-layout .ui-content-title{margin-bottom:24px}.ui-detail-layout .ui-circle{font-weight:700}.ui-detail-layout .ui-circle:before{content:"";width:7px;height:7px;display:inline-block;border:1px solid #333;border-radius:100% 100%;margin-right:6px;vertical-align:middle;margin-top:-3px}',""])},lNj5:function(t,e,a){var n=a("gnYt");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);a("rjj0")("65d89b4e",n,!0,{sourceMap:!1})},syeK:function(t,e,a){"use strict";function n(t){if(null===t||void 0===t)return 0;if(isNaN(t))return"NaN";var e=t.toString();if(/^-?\d+\.?\d+$/.test(e))if(/^-?\d+$/.test(e))e=e.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");else{var a=e.split("."),n=a[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");e=n+"."+a[1]}return e}e.a=n},yWLh:function(t,e,a){"use strict";function n(t){a("lNj5")}var i=a("4O/J"),o=a("NpwQ"),r=a("VU/8"),s=n,l=r(i.a,o.a,!1,s,null,null);e.a=l.exports}});
//# sourceMappingURL=detail.010d59d5f72a47165008.js.map