webpackJsonp([84],{"4O/J":function(t,e,n){"use strict";e.a={name:"detailStyle",props:["info"]}},"61ld":function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{class:t.getClassName()},[n("div",{staticClass:"ui-label",class:{circle:"circle"==t.type}},[t._v("\n\t\t"+t._s(t.label)+"\n\t")]),n("div",{staticClass:"ui-text"},[t._t("default")],2)])},i=[],o={render:a,staticRenderFns:i};e.a=o},"6Ssy":function(t,e,n){e=t.exports=n("FZ+f")(!1),e.push([t.i,".g-order-detail[data-v-0cf77e00]{margin:-10px;height:100%}.g-order-detail .m-detail-header[data-v-0cf77e00]{height:50px;border-bottom:1px solid #e8e9e9;line-height:50px;font-size:16px;color:#666}.g-order-detail .m-detail-header .u-border-left[data-v-0cf77e00]{width:0;height:24px;border:2px solid #499df1;margin-right:20px}.g-order-detail .m-detail-content[data-v-0cf77e00]{padding:30px 24px}.g-order-detail .m-detail-content .ivu-table-wrapper[data-v-0cf77e00]{margin-bottom:30px}.g-order-detail .m-detail-buttons[data-v-0cf77e00]{margin-left:40px;margin-top:30px;margin-bottom:60px}.g-order-detail .amount-list[data-v-0cf77e00]{font-weight:700;display:block;width:200px;margin-left:auto}.g-order-detail .discount-table-head[data-v-0cf77e00]{background:#f5f6fa;height:50px;line-height:50px;text-align:center;font-weight:500;border:1px solid #e9eaec;border-left:none;border-right:none;border-left:1px solid #e9eaec}.g-order-detail .discount-table-content[data-v-0cf77e00]{background:#fff;padding:0 15px;height:50px;line-height:50px;text-align:center;border-left:1px solid #e9eaec;border-bottom:1px solid #e9eaec}",""])},"9pIO":function(t,e,n){"use strict";function a(t,e){if(t)for(var n=t.querySelectorAll(".ivu-table-sort"),a=0;a<n.length;a++){var o=n[a];o.style.width="auto",o.style.height="40px";var r=o.parentNode,l=r.querySelectorAll("span")[0].innerHTML;i(o,t,l,e)}}function i(t,e,n,a){t.innerHTML="";var i=document.createElement("span");i.className=r("init"),t.appendChild(i),i.onclick=function(t){var i=t.target,s=i.className;l(e),i.className=r(s),a({label:n,order:o(s)})}}function o(t){return"kr-table-sort-icon-asc"===t?"desc":"asc"}function r(t){switch(t){case"kr-table-sort-icon-init":return"kr-table-sort-icon-asc";case"kr-table-sort-icon-asc":return"kr-table-sort-icon-desc";case"kr-table-sort-icon-desc":return"kr-table-sort-icon-asc";default:return"kr-table-sort-icon-init"}}function l(t){for(var e=t.querySelectorAll(".ivu-table-sort span"),n=0;n<e.length;n++){e[n].className=r("init")}}e.a=a},A7Ww:function(t,e,n){e=t.exports=n("FZ+f")(!1),e.push([t.i,'.ui-labeltext{width:45%;height:14px;font-size:14px;color:#333;line-height:14px;padding-left:14px;margin-bottom:24px;display:inline-block}.ui-labeltext .circle:before{content:"";display:inline-block;width:8px;height:8px;border:1px solid #333;border-radius:5px}.ui-labeltext .ui-label{font-weight:700;line-height:20px}.ui-label-text-inline .ui-label,.ui-label-text-inline .ui-text{display:inline-block}.ui-label-text-unline .ui-label{margin-bottom:8px}.ui-label-text-unline .ui-label,.ui-label-text-unline .ui-text{display:block}',""])},Asao:function(t,e,n){"use strict";function a(){switch((0,Object.prototype.toString.call)(0)){case"[object String]":return"string";case"[object Number]":return"number";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Function]":return"function";case"[object Date]":return"date";case"[object Array]":return"array";case"[object RegExp]":return"regExp";case"[object Error]":return"error";case"[object HTMLDocument]":return"node";case"[object global]":return"global"}}e.a=a},Ayfb:function(t,e,n){"use strict";var a=n("mvHQ"),i=n.n(a),o=n("yWLh"),r=n("SP/+");n("bsze");e.a={components:{DetailStyle:o.a,LabelText:r.a},head:function(){return{title:"结算单编辑"}},data:function(){return{basicInfo:{},validatePass:function(t,e,n){},formItem:{details:[]},settlementOption:[],selectAll:!1,errorMessage:"ssssss",error:!1,disabled:!1}},mounted:function(){GLOBALSIDESWITCH("false");var t=this.$route.params,e={checklistId:t.billId},n=this;this.$http.get("get-edit-settlement-detail",e,function(t){n.basicInfo=t.data,n.formItem.details=t.data.details.map(function(t){var e=t;return e.show=!0,e}),n.getAmountName()},function(t){n.$Notice.error({title:t.message})})},methods:{getAmountName:function(){var t=this,e=this;this.$http.get("get-amount-name-data",{}).then(function(t){e.settlementOption=t.data.feeTypes.map(function(t){var e=t;return e.label=t.desc,e})}).catch(function(e){t.$Notice.error({title:e.message}),console.log("err",e)})},handleAdd:function(){this.formItem.details.push({name:"",amount:"",show:!0,edit:!0})},cancel:function(){window.close(),window.opener.location.reload()},deleteDiscount:function(){var t=this.formItem.details,e=[];e=t.map(function(t){return t.select}),console.log("deleteDiscount",e),t=t.map(function(t,e){return t.select&&(t.show=!1),t}),this.formItem.details=t,this.checkList(),this.selectDiscount(!1)},selectDiscount:function(t){console.log(t);var e=this.formItem.details;e=e.map(function(e){var n=e;return e.billId||(n.select=t),n}),this.selectAll=t,this.formItem.details=e},submitForm:function(t){this.checkList(),console.log("submitForm",this.error),this.error?(this.$Notice.error({title:this.errorMessage}),console.log("不能提交")):(this.postChecklist(),console.log("提交"))},changeType:function(t){console.log("value",t)},changeAmount:function(t){console.log("changeAmount",t)},checkList:function(){var t=this,e=this.formItem.details.filter(function(t,e){return!(t.billId||!t.show)});e.length?e.map(function(e){t.error=!1,isNaN(e.payableAmount)&&(t.error=!0,t.errorMessage="金额请填写数字"),e.feeType&&e.payableAmount||(t.error=!0,t.errorMessage="结算表单未填写完整")}):this.error=!1},config:function(){this.$Notice.config({top:80,duration:3})},postChecklist:function(){var t=this;this.config();var e=this.formItem.details.filter(function(t){return!!t.show}),n={checklistId:this.$route.params.billId,detailsStr:i()(e)};this.$http.post("post-edit-settlement-detail",n).then(function(e){t.disabled=!0,setTimeout(function(){window.close(),window.opener.location.reload()})}).catch(function(e){console.log("err",e),t.$Notice.error({title:e.message})})}}}},Eqh0:function(t,e,n){"use strict";function a(t){if(t){return o.a.dateToStr("YYYY/MM/DD HH:mm:SS",new Date(t)).replace(/\//g,"-")}return""}var i=n("g4Hp"),o=n.n(i);e.a=a},IoNu:function(t,e){t.exports=function(t,e,n,a){function i(){function i(){r=Number(new Date),n.apply(s,u)}function l(){o=void 0}var s=this,c=Number(new Date)-r,u=arguments;a&&!o&&i(),o&&clearTimeout(o),void 0===a&&c>t?i():!0!==e&&(o=setTimeout(a?l:i,void 0===a?t-c:t))}var o,r=0;return"boolean"!=typeof e&&(a=n,n=e,e=void 0),i}},Kozl:function(t,e,n){"use strict";e.a={name:"labelText",props:["label","inline","type"],data:function(){return{labeltextClass:"ui-labeltext",inlineClass:"inline",unlineClass:"unline"}},methods:{getClassName:function(){var t="ui-labeltext";return this.inline?t+=" ui-label-text-unline":t+=" ui-label-text-inline",t}}}},NpwQ:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"ui-detail-layout"},[n("div",{staticClass:"ui-content-title"},[n("span",{staticClass:"ui-circle"},[t._v(t._s(t.info))])]),t._t("default")],2)},i=[],o={render:a,staticRenderFns:i};e.a=o},"SP/+":function(t,e,n){"use strict";function a(t){n("dhjp")}var i=n("Kozl"),o=n("61ld"),r=n("VU/8"),l=a,s=r(i.a,o.a,!1,l,null,null);e.a=s.exports},"Ta+G":function(t,e,n){"use strict";function a(t){var e=t.type;return"DOMMouseScroll"!=e&&"mousewheel"!=e||(t.delta=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3),t.srcElement&&!t.target&&(t.target=t.srcElement),t.preventDefault||void 0===t.returnValue||(t.preventDefault=function(){t.returnValue=!1}),t}var i=function(t,e,n,i){console.log("-------"),window.addEventListener?("mousewheel"===e&&void 0!==document.mozFullScreen&&(e="DOMMouseScroll"),t.addEventListener(e,function(t){n(a(t))},i||!1)):window.attachEvent&&t.attachEvent("on"+e,function(t){t=t||window.event,n(a(t))})};e.a=i},bsze:function(t,e,n){"use strict";function a(t){var e=["角","分"],n=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],a=[["元","万","亿"],["","拾","佰","仟"]],i=t<0?"负":"";t=Math.abs(t);var o="",r=(t+"").split(".").length,l="00";r>1&&(l=(t+"").split(".")[1]);for(var s=0;s<e.length;s++)n[l[s]]&&(o+=(n[l[s]]+e[s]).replace(/零./,""));o=o||"整",t=Math.floor(t);for(var s=0;s<a[0].length&&t>0;s++){for(var c="",u=0;u<a[1].length&&t>0;u++)c=n[t%10]+a[1][u]+c,t=Math.floor(t/10);o=c.replace(/(零.)*零$/,"").replace(/^$/,"零")+a[0][s]+o}return i+o.replace(/(零.)*零元/,"元").replace(/(零.)+/g,"零").replace(/^整$/,"零元整")}function i(t){for(var e in t)t[e]=""}function o(t,e){var n=[];for(var a in t)t.hasOwnProperty(a)&&n.push(a+"="+t[a]);var e=e+"?"+n.join("&");window.location.href=e}function r(){var t=location.search,e=new Object;if(-1!=t.indexOf("?"))for(var n=t.substr(1),a=n.split("&"),i=0;i<a.length;i++)e[a[i].split("=")[0]]=unescape(a[i].split("=")[1]);return e}function l(t){var e=window.location.href,n=e.split("?")[0],a=[];for(var i in t)t.hasOwnProperty(i)&&a.push(i+"="+t[i]);n=n+"?"+a.join("&"),location.href=n}function s(t){for(var e,n=0,a={},i=[];e=t[n++];){var o=e.id;a[o]||(a[o]=!0,i.push(e))}return i}function c(t,e,n,a){for(var i=0;i<e.length;i++)for(var o=0;o<t.length;o++){var r=n?t[o][n]:t[o],l=a?e[i][a]:e[i];r==l&&t.splice(o,1)}return t}function u(t,e){var n=document.createElement("a");n.href=t,n.download=e,console.log("a--",n,t,e),n.click()}function d(t,e){var n=document.createElement("a");n.href=t,n.target="_blank",n.download=e,n.click()}function f(t,e){return e=parseInt(e,10),new Date(t,e,0).getDate()}function p(t,e){var n,a,i;return n=t.split("-"),a=new Date(n[1]+"/"+n[2]+"/"+n[0]),n=e.split("-"),i=new Date(n[1]+"/"+n[2]+"/"+n[0]),parseInt(Math.abs(a-i)/1e3/60/60/24)}function h(t,e,n){return void 0===n?_()(t,e,!1):_()(t,n,!1!==e)}function m(t,e){var n=new Date(t),a=new Date(n.getFullYear(),n.getMonth(),n.getDate()+e);n.getFullYear(),n.getMonth(),n.getDate();return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()}function b(){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var e=document.createElement("div"),n=e.style;n.position="absolute",n.top=0,n.left=0,n.pointerEvents="none",n.visibility="hidden",n.width="200px",n.height="150px",n.overflow="hidden",e.appendChild(t),document.body.appendChild(e);var a=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;return a===i&&(i=e.clientWidth),document.body.removeChild(e),a-i}function g(t,e){var n,a,i;return n=t.split("-"),a=new Date(n[1]+"/"+n[2]+"/"+n[0]),n=e.split("-"),i=new Date(n[1]+"/"+n[2]+"/"+n[0]),parseInt(Math.abs(a-i)/1e3/60/60/24)}var v=n("syeK"),x=n("Ta+G"),y=n("Asao"),w=n("IoNu"),_=n.n(w),I=n("Eqh0"),k=n("9pIO");e.a={smalltoBIG:a,clearForm:i,commonExport:o,getRequest:r,addParams:l,arrayNoRepeat:s,arrayCompare:c,thousand:v.a,downFile:u,addEvent:x.a,dataType:y.a,getDaysInOneMonth:f,dateDiff:p,debounce:h,getScrollBarSize:b,dateCompatible:I.a,tableSort:k.a,dateRange:m,downImg:d,timeRange:g}},cIPf:function(t,e,n){"use strict";function a(t){n("n2jM")}Object.defineProperty(e,"__esModule",{value:!0});var i=n("Ayfb"),o=n("sSpN"),r=n("VU/8"),l=a,s=r(i.a,o.a,!1,l,"data-v-0cf77e00",null);e.default=s.exports},dhjp:function(t,e,n){var a=n("A7Ww");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("6397b5a0",a,!0,{sourceMap:!1})},gnYt:function(t,e,n){e=t.exports=n("FZ+f")(!1),e.push([t.i,'.u-clearfix{zoom:1}.u-clearfix:after{clear:both;content:".";height:0;display:block;visibility:hidden}.left{float:left}.ui-detail-layout{padding:0 24px;font-size:14px;color:#333;line-height:14px}.ui-detail-layout .ui-content-title{margin-bottom:24px}.ui-detail-layout .ui-circle{font-weight:700}.ui-detail-layout .ui-circle:before{content:"";width:7px;height:7px;display:inline-block;border:1px solid #333;border-radius:100% 100%;margin-right:6px;vertical-align:middle;margin-top:-3px}',""])},lNj5:function(t,e,n){var a=n("gnYt");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("65d89b4e",a,!0,{sourceMap:!1})},n2jM:function(t,e,n){var a=n("6Ssy");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);n("rjj0")("16c48539",a,!0,{sourceMap:!1})},sSpN:function(t,e,n){"use strict";var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"g-order-detail"},[t._m(0),n("div",{staticClass:"m-detail-content"},[n("DetailStyle",{attrs:{info:"基本信息"}},[n("LabelText",{attrs:{label:"结算单编号："}},[t._v("\n\t\t\t    "+t._s(t.basicInfo.checklistNum)+"\n\t\t\t")]),n("LabelText",{attrs:{label:"服务尾期："}},[t._v("\n\t\t\t\t"+t._s(t._f("dateFormat")(t.basicInfo.lastServiceDate,"YYYY-MM-dd"))+"\n\t\t\t")]),n("LabelText",{attrs:{label:"客户名称："}},[t._v("\n\t\t\t\t"+t._s(t.basicInfo.csrName)+"\n\t\t\t")]),n("LabelText",{attrs:{label:"社区名称："}},[t._v("\n\t\t\t\t"+t._s(t.basicInfo.cmtName)+"\n\t\t\t")])],1),n("DetailStyle",{attrs:{info:"结算信息"}},[n("Form",{ref:"formItem",attrs:{model:t.formItem}},[n("Row",{staticStyle:{"margin-bottom":"10px"}},[n("Col",{staticClass:"col"},[n("Button",{staticStyle:{"margin-right":"20px","font-size":"14px"},attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("添加")]),n("Button",{staticStyle:{"font-size":"14px"},attrs:{type:"ghost"},on:{click:t.deleteDiscount}},[t._v("删除")]),t.error?n("span",{staticStyle:{display:"inline-block",color:"red","margin-left":"20px"}},[t._v(t._s(t.errorMessage))]):t._e()],1)],1),n("Row",{staticStyle:{"margin-top":"30px"}},[n("Col",{staticClass:"discount-table-head",attrs:{span:"3"}},[n("Checkbox",{on:{"on-change":t.selectDiscount},model:{value:t.selectAll,callback:function(e){t.selectAll=e},expression:"selectAll"}})],1),n("Col",{staticClass:"discount-table-head",attrs:{span:"11"}},[n("span",[t._v(" 费用名称")])]),n("Col",{staticClass:"discount-table-head",attrs:{span:"10"}},[n("span",[t._v("费用金额")])])],1),t._l(t.formItem.details,function(e,a){return n("FormItem",{key:a,staticStyle:{margin:"0",border:"1px solid e9eaec","border-top":"none","border-bottom":"none"}},[n("Row",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"item.show"}]},[n("Col",{staticClass:"discount-table-content",staticStyle:{padding:"0"},attrs:{span:"3"}},[n("Checkbox",{attrs:{disabled:!!e.billId},model:{value:e.select,callback:function(n){t.$set(e,"select",n)},expression:"item.select"}})],1),n("Col",{staticClass:"discount-table-content",attrs:{span:"11"}},[e.billId?n("span",[t._v(" "+t._s(e.billName))]):t._e(),e.billId?t._e():n("Select",{staticStyle:{width:"200px"},attrs:{"label-in-value":""},on:{"on-change":t.changeType},model:{value:e.feeType,callback:function(n){t.$set(e,"feeType",n)},expression:"item.feeType"}},t._l(t.settlementOption,function(e,a){return n("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1),n("Col",{staticClass:"discount-table-content",attrs:{span:"10"}},[e.billId?n("span",[t._v(t._s(e.payableAmount))]):t._e(),e.billId?t._e():n("Input",{staticStyle:{width:"200px"},attrs:{placeholder:"金额",number:""},on:{"on-blur":t.changeAmount},model:{value:e.payableAmount,callback:function(n){t.$set(e,"payableAmount",n)},expression:"item.payableAmount"}})],1)],1)],1)})],2)],1)],1),n("div",{staticClass:"m-detail-buttons"},[n("Button",{attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){t.submitForm("formItem")}}},[t._v("确定")]),n("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.cancel}},[t._v("取消")])],1)])},i=[function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"m-detail-header"},[n("span",{staticClass:"u-border-left"}),t._v("\n\t\t客户撤场结算单\n\t")])}],o={render:a,staticRenderFns:i};e.a=o},syeK:function(t,e,n){"use strict";function a(t){if(null===t||void 0===t)return 0;if(isNaN(t))return"NaN";var e=t.toString();if(/^-?\d+\.?\d+$/.test(e))if(/^-?\d+$/.test(e))e=e.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");else{var n=e.split("."),a=n[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");e=a+"."+n[1]}return e}e.a=a},yWLh:function(t,e,n){"use strict";function a(t){n("lNj5")}var i=n("4O/J"),o=n("NpwQ"),r=n("VU/8"),l=a,s=r(i.a,o.a,!1,l,null,null);e.a=s.exports}});
//# sourceMappingURL=edit.91ef05bada72df98073b.js.map