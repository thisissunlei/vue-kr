webpackJsonp([24],{"+H/r":function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"com-select-customers"},[o("Select",{attrs:{"v-model":t.customer,filterable:"",remote:"",placeholder:t.value,"remote-method":t.remoteCustomer,loading:t.loading1,disabled:t.disabled,"label-in-value":t.labelInValue},on:{"on-change":t.changeContent}},t._l(t.customerOptions,function(e,a){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)},n=[],i={render:a,staticRenderFns:n};e.a=i},"+nse":function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".com-select-community ::-webkit-input-placeholder{color:#666}.com-select-community ::-moz-placeholder{color:#666}.com-select-community :-ms-input-placeholder{color:#666}.com-select-community input:-moz-placeholder{color:#666}",""])},"4O/J":function(t,e,o){"use strict";e.a={name:"detailStyle",props:["info"]}},"4XX8":function(t,e,o){"use strict";var a=o("woOf"),n=o.n(a),i=o("Rrep"),r=o("9Jg8");e.a={props:{params:Object,floors:Array,stationData:Object,originStationList:Array},data:function(){return console.log("this.stationData.submitData",this.stationData.submitData),{data:"",selectedObjs:this.stationData.submitData,deleteArr:[],newfloor:"3",submitData:[],scaleNumber:60,Map:"",inputEnd:"",inputStart:"",originData:[],floor:"",startToEnd:[],origin:this.originStationList,showSlider:!0,stationArr:this.stationData,page:{},stylePlan:{}}},destroyed:function(){},mounted:function(){this.getData(),this.getPageWidthOrHeight()},updated:function(){},beforeUpdate:function(){},watch:{stationData:function(t){this.selectedObjs=this.stationData.submitData},originStationList:function(t){this.origin=t},stationArr:function(t){this.$emit("on-result-change",t),this.inputStart="",this.inputEnd=""},startToEnd:function(t){var e=this.stationArr,o=e.submitData,a=e.deleteData;o=o.concat(t),this.stationArr={deleteData:a,submitData:o}}},methods:{getPageWidthOrHeight:function(){var t={};t.width=window.innerWidth,t.height=window.innerHeight,"CSS1Compat"==document.compatMode?(t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight):(t.width=document.body.clientWidth,t.height=document.body.clientHeight),this.page=n()({},t),this.stylePlan={width:"100%",height:t.height-200+"px",border:"1px solid #000"}},getData:function(){var t=this,e=this.params,o=[],a=this;r.a.get("getplanmap",e,function(e){var n=e.data,i=[],r={},s=[];n.map(function(t,e){var a=[];i.push({value:""+t.floor,label:""+t.floor}),t.figures.map(function(t,e){for(var n=0;n<o.length;n++){var i="STATION";if(2==o[n].belongType&&(i="SPACE"),t.belongId==o[n].id&&t.belongType==i){var r={};r.name=t.cellName,r.whereFloor=t.floor,r.belongType=t.belongType,r.belongId=Number(t.belongId),a.push(r)}}if(0==o.length&&t.status&&3==t.status){var r={};r.name=t.cellName,r.whereFloor=t.floor,r.belongType=t.belongType,r.belongId=Number(t.belongId),s.push(r),a.push(r)}}),r["a"+t.floor]=[].concat(a)},function(t){a.$Notice.error({title:t.message})}),t.data=n,t.newfloor=i[0].value,t.canvasEles()})},canvasEles:function(){var t=this,e={},o=Number(this.inputStart),a=Number(this.inputEnd),n=this.data,r=this.newfloor,s=this.selectedObjs;console.log("渲染",s);for(var l=[],c=this.origin||[],u=0;u<n.length;u++)if(n[u].floor==r){var p=[];p=n[u].figures.map(function(t,e){var n={},i=Number(t.cellName);t.cellCoordX,t.cellCoordY;n.x=Number(t.cellCoordX),n.y=Number(t.cellCoordY),n.width=Number(t.cellWidth),n.height=Number(t.cellHeight),n.name=t.cellName,n.whereFloor=t.floor,n.belongType=t.belongType,n.belongId=Number(t.belongId),n.id=Number(t.id),n.canFigureId=t.canFigureId,n.capacity=t.capacity,n.type=n.belongType,n.seatPrice=t.seatPrice,n.checked=!1,n.status=t.status||4;for(var r=0;r<c.length;r++){var u="STATION";2!=c[r].belongType&&"SPACE"!=c[r].belongType||(u="SPACE"),t.belongId==c[r].id&&t.belongType==u&&2!=t.status&&(n.checked=!1,n.status=3)}for(var p=0;p<s.length;p++){var d="STATION";2!=s[p].belongType&&"SPACE"!=s[p].belongType||(d="SPACE"),t.belongId==s[p].id&&t.belongType==d&&(n.checked=!0,n.status=3)}if(i>=o&&i<=a&&1!=t.status){n.checked=!0;var h={};h.name=t.cellName,h.whereFloor=t.floor,h.belongType=t.belongType,h.belongId=Number(t.belongId),h.id=Number(t.belongId),h.canFigureId=t.canFigureId,h.type=n.belongType,h.capacity=t.capacity,h.seatType="STATION"==n.belongType?"OPEN":"SPACE",h.seatPrice=t.seatPrice,l.push(h)}return n}),e={stations:p||[],isMode:"select",plugin:{onCheckedStationCallback:t.dataChange},map:{translateX:0,translateY:0,scaleEnable:!1,scale:this.scaleNumber/100,contextMenuEnable:!0},backgroundImageUrl:"http://"+window.location.host+n[u].graphFilePath}}this.Map=Object(i.a)("plan-map-content",e),l.length&&(this.startToEnd=l)},rangeSelect:function(t){var e=parseInt(t);this.scaleNumber=e,this.Map.setScale(e/100)},floorsChange:function(t){this.Map&&(this.Map.destory(),this.canvasEles())},submitStation:function(){this.Map.destory(),this.canvasEles()},dataChange:function(t,e){var o=this.selectedObjs,a=this.newfloor,i=this.submitData,r=this.deleteArr,s=[],l={};o.length&&(o.map(function(t){var e=t.floor||t.whereFloor;-1==s.indexOf(e)&&(s.push(e),l["a"+e]=[])}),o.map(function(t,e){var o=t.floor||t.whereFloor;l["a"+o].push(t)}));var c=[].concat(o),u=n()({},r),p=n()({},i);e=[].concat(e);for(var d=0;d<e.length;d++)for(var h=0;h<c.length;h++){var m="STATION";2==c[h].belongType&&(m="SPACE"),e[d].belongId==c[h].id&&e[d].belongType==m&&c.splice(h,1)}p["a"+a]=[].concat(e),u["a"+a]=[].concat(c),this.submitData=p,this.deleteArr=u;var f=[],g=[];for(var v in p)l[v]&&(l[v]=[]),f=f.concat(p[v]);for(var y in o)for(var b in f)o[y].name==f[b].name&&(f[b].originalPrice=o[y].originalPrice);for(var S in u)g=g.concat(u[S]);f=f.map(function(t,e){var o={},a=1,n="OPEN";return"SPACE"!=t.belongType&&2!=t.belongType||(a=2,n="SPACE"),o.id=t.belongId||t.id,o.type=a,o.seatType=n,o.belongType=a,o.whereFloor=t.whereFloor||t.floor,o.name=t.name,o.seatPrice=t.seatPrice,o.capacity=t.capacity,o.originalPrice=t.originalPrice||o.seatPrice||"",o});var x={submitData:f,deleteData:g};this.stationArr=x}}}},"51Ub":function(t,e,o){var a=o("oNwR");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("65342f3c",a,!0,{sourceMap:!1})},"77Yh":function(t,e,o){"use strict";function a(t){o("ev4r")}var n=o("e4V2"),i=o("OVYt"),r=o("VU/8"),s=a,l=r(n.a,i.a,!1,s,null,null);e.a=l.exports},"9pIO":function(t,e,o){"use strict";function a(t,e){if(t)for(var o=t.querySelectorAll(".ivu-table-sort"),a=0;a<o.length;a++){var i=o[a];i.style.width="auto",i.style.height="40px";var r=i.parentNode,s=r.querySelectorAll("span")[0].innerHTML;n(i,t,s,e)}}function n(t,e,o,a){t.innerHTML="";var n=document.createElement("span");n.className=r("init"),t.appendChild(n),n.onclick=function(t){var n=t.target,l=n.className;s(e),n.className=r(l),a({label:o,order:i(l)})}}function i(t){return"kr-table-sort-icon-asc"===t?"desc":"asc"}function r(t){switch(t){case"kr-table-sort-icon-init":return"kr-table-sort-icon-asc";case"kr-table-sort-icon-asc":return"kr-table-sort-icon-desc";case"kr-table-sort-icon-desc":return"kr-table-sort-icon-asc";default:return"kr-table-sort-icon-init"}}function s(t){for(var e=t.querySelectorAll(".ivu-table-sort span"),o=0;o<e.length;o++){e[o].className=r("init")}}e.a=a},Asao:function(t,e,o){"use strict";function a(){switch((0,Object.prototype.toString.call)(0)){case"[object String]":return"string";case"[object Number]":return"number";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Function]":return"function";case"[object Date]":return"date";case"[object Array]":return"array";case"[object RegExp]":return"regExp";case"[object Error]":return"error";case"[object HTMLDocument]":return"node";case"[object global]":return"global"}}e.a=a},Ds1f:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"plan-map-content",style:{height:t.page.height}},[o("div",{staticClass:"num-type",staticStyle:{"margin-bottom":"15px"}},[o("Select",{staticStyle:{width:"100px","margin-right":"15px"},attrs:{placeholder:"floor"},on:{"on-change":t.floorsChange},model:{value:t.newfloor,callback:function(e){t.newfloor=e},expression:"newfloor"}},t._l(t.floors,function(e){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),o("Input",{staticStyle:{width:"80px","margin-right":"5px"},attrs:{placeholder:"开始工位"},model:{value:t.inputStart,callback:function(e){t.inputStart=e},expression:"inputStart"}}),t._v("至\n\t\t    "),o("Input",{staticStyle:{width:"80px","margin-right":"5px"},attrs:{placeholder:"结束工位"},model:{value:t.inputEnd,callback:function(e){t.inputEnd=e},expression:"inputEnd"}}),o("Button",{staticStyle:{"margin-right":"15px"},attrs:{type:"primary"},on:{click:t.submitStation}},[t._v("选择")]),o("span",{staticClass:"til"},[t._v("当前比例：")]),o("Slider",{staticStyle:{width:"150px",display:"inline-block","vertical-align":"middle"},attrs:{"v-model":t.scaleNumber,min:50,max:200,step:10},on:{"on-change":t.rangeSelect}}),o("output",{staticStyle:{"margin-left":"15px"}},[t._v(t._s(t.scaleNumber))]),t._v("%\n\t\t")],1),o("div",{style:t.stylePlan,attrs:{id:"plan-map-content"}})])},n=[],i={render:a,staticRenderFns:n};e.a=i},Eqh0:function(t,e,o){"use strict";function a(t){if(t){return i.a.dateToStr("YYYY/MM/DD HH:mm:SS",new Date(t)).replace(/\//g,"-")}return""}var n=o("g4Hp"),i=o.n(n);e.a=a},IoNu:function(t,e){t.exports=function(t,e,o,a){function n(){function n(){r=Number(new Date),o.apply(l,u)}function s(){i=void 0}var l=this,c=Number(new Date)-r,u=arguments;a&&!i&&n(),i&&clearTimeout(i),void 0===a&&c>t?n():!0!==e&&(i=setTimeout(a?s:n,void 0===a?t-c:t))}var i,r=0;return"boolean"!=typeof e&&(a=o,o=e,e=void 0),n}},J0i4:function(t,e,o){"use strict";function a(t){o("pY0k")}var n=o("tBD1"),i=o("P67S"),r=o("VU/8"),s=a,l=r(n.a,i.a,!1,s,"data-v-872aada8",null);e.a=l.exports},JnUb:function(t,e,o){var a=o("XvJJ");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("428044bc",a,!0,{sourceMap:!1})},"K+LH":function(t,e,o){"use strict";function a(t){o("MyuT")}var n=o("LfLl"),i=o("K6ky"),r=o("VU/8"),s=a,l=r(n.a,i.a,!1,s,null,null);e.a=l.exports},K6ky:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"com-select-saler"},[o("Select",{attrs:{"v-model":t.saler,filterable:"",remote:"",clearable:t.clearable,placeholder:t.value,"remote-method":t.remoteSaler,loading:t.loading1,disabled:t.disabled},on:{"on-change":t.changeContent}},t._l(t.salerOptions,function(e,a){return o("Option",{key:e.label,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)},n=[],i={render:a,staticRenderFns:n};e.a=i},LfLl:function(t,e,o){"use strict";var a=o("9Jg8");e.a={props:{onchange:Function,value:String,disabled:Boolean,clearable:{type:Boolean,default:!1}},data:function(){return{saler:"",loading1:!1,salerOptions:[]}},methods:{changeContent:function(t){this.onchange(t)},remoteSaler:function(t){var e=this;""!==t&&(this.loading1=!0,setTimeout(function(){e.getSalerList(t)},200))},getSalerList:function(t){var e={phoneOrEmail:t},o=[],n=this;a.a.get("get-saler",e,function(t){o=t.data.slice(0,10),o.map(function(t){var e=t;return e.label=t.lastname,e.value=t.id+"",e}),n.loading1=!1,n.salerOptions=o},function(t){console.log("error",t)})}}}},MyuT:function(t,e,o){var a=o("P75S");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("041bc169",a,!0,{sourceMap:!1})},NVoV:function(t,e,o){var a=o("Nknv");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("35938d8c",a,!0,{sourceMap:!1})},Nknv:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".create-new-order{padding-bottom:60px}.create-new-order .creat-order-form{max-width:1140px;padding:30px 0}.create-new-order .creat-order-form .col{display:inline-block;width:50%;max-width:450px;padding-right:10px;vertical-align:top}.create-new-order .creat-order-form .total-money{border:1px solid #e9eaec;border-top:0;height:48px;line-height:48px;text-align:right;padding-right:28px;margin-bottom:20px}.create-new-order .creat-order-form .total-money span+span{margin-left:20px}.create-new-order .creat-order-form .total-money .money{color:#ff6868}.create-new-order .creat-order-form .button-list{font-size:14px;color:#499df1;display:inline-block;border:1px solid #499df1;border-radius:4px;margin-right:5px;height:32px;line-height:32px;padding:0 14px;cursor:pointer;margin-bottom:10px}.create-new-order .creat-order-form .active{background-color:#499df1;color:#fff}.create-new-order .creat-order-form .discount-table-head{background:#f5f6fa;height:50px;line-height:50px;text-align:center;font-weight:500;border:1px solid #e9eaec;border-left:none;border-right:none;border-left:1px solid #e9eaec}.create-new-order .creat-order-form .discount-table-content{background:#fff;padding:0 15px;height:50px;line-height:50px;text-align:center;border-left:1px solid #e9eaec;border-bottom:1px solid #e9eaec}.create-new-order .creat-order-form .lastRow{border-bottom:1px solid #e9eaec;margin-bottom:20px}",""])},NpwQ:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"ui-detail-layout"},[o("div",{staticClass:"ui-content-title"},[o("span",{staticClass:"ui-circle"},[t._v(t._s(t.info))])]),t._t("default")],2)},n=[],i={render:a,staticRenderFns:n};e.a=i},OTiz:function(t,e,o){var a=o("YxGB");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("1fd6b0c9",a,!0,{sourceMap:!1})},OVYt:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"com-select-community"},[o("Select",{attrs:{"v-model":t.test.communityId,filterable:"",placeholder:t.value,disabled:t.disabled},on:{"on-change":t.changeContent}},t._l(t.options1,function(e,a){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)},n=[],i={render:a,staticRenderFns:n};e.a=i},P03E:function(t,e,o){"use strict";function a(t){o("OTiz")}Object.defineProperty(e,"__esModule",{value:!0});var n=o("u9UO"),i=o("bwlM"),r=o("VU/8"),s=a,l=r(n.a,i.a,!1,s,null,null);e.default=l.exports},P67S:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{class:t.classType[t.type]},[t._v("\n    "+t._s(t.title)+"\n")])},n=[],i={render:a,staticRenderFns:n};e.a=i},P75S:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".com-select-saler ::-webkit-input-placeholder{color:#666}.com-select-saler ::-moz-placeholder{color:#666}.com-select-saler :-ms-input-placeholder{color:#666}.com-select-saler input:-moz-placeholder{color:#666}",""])},Rrep:function(t,e,o){"use strict";var a=o("pFYg"),n=o.n(a),i=o("woOf"),r=o.n(i),s=function(t,e){var o,a,i,s,l,c,u,p=[],d=1,h=null,m=[],f=[],g={z:1,isMode:"select",modes:["edit","view","select"],stations:[],rulers:[],backgroundImageUrl:""};g.db={reset:function(){g.stations=[]},getAllStation:function(){return[].concat(g.stations)},setAllStation:function(t){g.stations=[].concat(t)},findStationIndex:function(t){var e;return this.getAllStation().map(function(o,a){o.key==t&&(e=a)}),e},newStation:function(t){return t=r()({},t),void 0===this.findStationIndex(t.key)&&g.stations.push(t),this},removeStation:function(t){var e,o=this.getAllStation();if(o.map(function(o,a){t==o.key&&(e=a)}),void 0!==e){o.splice(e,1),this.setAllStation(o);var e;m.map(function(o,a){o.getProps().key==t&&(e=a)}),void 0!==e&&m.splice(e,1)}},getStation:function(t){var e=this.findStationIndex(t),o=this.getAllStation(),a=o[e];return r()({},a)},setStation:function(t,e){var o=this.getStation(t),a=this.findStationIndex(t);if(void 0!==a)return o=r()({},o,e),g.stations.splice(a,1,o),this},getImageUrl:function(){return g.backgroundImageUrl},setImageUrl:function(t){g.backgroundImageUrl=t}},g.utils={isEditMode:function(){return"edit"===g.isMode},isViewMode:function(){return"view"===g.isMode},isSelectMode:function(){return"select"===g.isMode}},g.stationStatus={1:{status:"join",mark:"已入住",textColor:"#fff",backgroundColor:"#499df1"},2:{status:"admit",mark:"不可选工位",textColor:"#fff",backgroundColor:"#499df1"},3:{status:"default",mark:"默认",textColor:"#499df1",backgroundColor:"#ffffff"},4:{status:"notChecked",mark:"未选择",textColor:"#499df1",backgroundColor:"#ffffff"},5:{status:"checked",mark:"已选中",textColor:"#fff",backgroundColor:"#28c288"}},g.station={width:30,height:30,minWidth:30,minHeight:30,maxWidth:200,maxHeight:200,scaleSpeed:20,isToSameSize:!0},g.operationTypeConfigs={canvasTopLineHover:{style:"pointer"},canvasLeftLineHover:{style:"pointer"},rulerHover:{style:"pointer"},mapHover:{style:"move"},stationMove:{style:"move"},stationHover:{style:"pointer"},stationLeftTopScale:{style:"nw-resize"},stationLeftCenterScale:{style:"w-resize"},stationLeftBottomScale:{style:"sw-resize"},stationTopCenterScale:{style:"n-resize"},stationRightTopScale:{style:"ne-resize"},stationRightCenterScale:{style:"e-resize"},stationRightBottomScale:{style:"se-resize"},stationBottomCenterScale:{style:"s-resize"}},g.plugin={onRemoveCallback:null,onScaleMapCallback:null,onCheckedStationCallback:null,onHoverInStationCallback:null,onHoverOutStationCallback:null,onErrorCallback:null,onReadyCallback:null,onRenderMapCallback:null},g.map={contextMenuEnable:!1,menuEnable:!1,mouseEnable:!1,deleteEnable:!0,scaleEnable:!0,rulerEnable:!0,stationClick:!0,scale:1,scaleMax:2,scaleMin:.1,scaleSpeed:.1,translateX:0,translateY:0,isLoadImageError:!1};var v,y,b={down:{},up:{},move:{}},S=function(t){var e=function t(e){e=r()({},t.defaultPropTypes,e),this.setProps(e)};return e.defaultPropTypes={type:"horizontal",x:0,y:0,checked:!1},e.prototype.isHorizontalLine=function(){var t=this.getProps();t.x,t.y;return"horizontal"===t.type},e.prototype.isVerticalLine=function(){var t=this.getProps();t.x,t.y;return"vertical"===t.type},e.prototype.componentWillReceiveProps=function(){this.render()},e.prototype.hasPosition=function(t,e){var o=this.getProps(),a=o.x,n=o.y,i=o.type,r=a-2,s=a+2,l=n-2,c=n+2;return"horizontal"==i?e>=l&&e<=c:"vertical"==i&&t>=r&&t<=s},e.prototype.drawHorizontalLine=function(){var t=this.getProps(),e=t.x,a=t.y,n=t.checked,i=w.transformPositionToView(e,a);o.beginPath(),o.moveTo(0,i.y),o.strokeStyle="red",n&&(o.strokeStyle="green"),o.lineTo(s,i.y),o.closePath(),o.stroke()},e.prototype.drawVerticalLine=function(){var t=this.getProps(),e=t.x,a=t.y,n=t.checked,i=w.transformPositionToView(e,a);o.beginPath(),o.moveTo(i.x,0),o.strokeStyle="red",n&&(o.strokeStyle="green"),o.lineTo(i.x,l),o.closePath(),o.stroke()},e.prototype.move=function(t,e){this.setProps({x:t,y:e})},e.prototype.setProps=function(t){this.props=r()({},this.props,t),this.componentWillReceiveProps()},e.prototype.getProps=function(){return r()({},this.props)},e.prototype.toChecked=function(){var t=this.getProps(),e=t.checked;e=!e,this.setProps({checked:e})},e.prototype.render=function(){"horizontal"==this.getProps().type?this.drawHorizontalLine():this.drawVerticalLine()},new e(t)},x=function t(e){e=e||{},d++,g.z++;var a=function t(e){var e=r()({},t.defaultPropTypes,e);this.stashProps=r()({},t.defaultPropTypes,e),this.componentWillReceiveProps(e)};return a.defaultPropTypes={x:0,y:0,z:g.z,width:g.station.width,height:g.station.height,name:"demo",type:"station",drag:!1,checked:!1,removed:!1,key:d,status:3,switchHoverIn:!1},a.prototype.onHoverIn=function(){var t=g.plugin.onHoverInStationCallback,e=this.getProps();if(!e.switchHoverIn){var o=i.getBoundingClientRect(),a=w.canvasToWindow(e.x,e.y);e.clientX=a.x+o.left,e.clientY=a.y+o.top,this.setProps({switchHoverIn:!0}),t&&t(e)}},a.prototype.onHoverOut=function(){var t=g.plugin.onHoverOutStationCallback,e=this.getProps();if(e.switchHoverIn){this.setProps({switchHoverIn:!1});var o=i.getBoundingClientRect(),a=w.canvasToWindow(e.x,e.y);e.clientX=a.x+o.left,e.clientY=a.y+o.top,t&&t(e)}},a.prototype.getProps=function(){return r()({},this.props)},a.prototype.setProps=function(t){var e=g.station,o=e.minWidth,a=e.minHeight,n=r()({},this.props);n=r()({},this.props,t),n.width<=o&&(n.width=o),n.height<=a&&(n.height=a),this.props=r()({},n),void 0===g.db.findStationIndex(n.key)&&g.db.newStation(n),g.db.setStation(n.key,n)},a.prototype.move=function(t,e){var o=this.stashProps.key,a=(g.db.findStationIndex(o),r()({},{key:o,x:t,y:e,drag:!0}));this.componentWillReceiveProps(a)},a.prototype.remove=function(){var t=this.props.key;this.setProps({removed:!0});g.db.getAllStation();g.db.removeStation(t),g.db.getAllStation()},a.prototype.componentWillReceiveProps=function(t){this.setProps(t),this.render()},a.prototype.saveProps=function(){this.stashProps=r()({},this.props)},a.prototype.getStashProps=function(){return r()({},this.stashProps)},a.prototype.render=function(){var t=this.props,e=t.drag,a=t.checked,i=t.removed,r=t.status;if(!i&&this.props.name){var s=this.props,l=g.stationStatus[r];a&&(l=g.stationStatus[5]);var c=w.transformWidthOrHeightToView(s.width,s.height),u=c.width,p=c.height,d=this.getLeftTopPosition();d=w.transformPositionToView(d.x,d.y),o.moveTo(d.x,d.y),o.beginPath(),o.fillStyle="#fff","object"===(void 0===l?"undefined":n()(l))&&l.hasOwnProperty("backgroundColor")&&(o.fillStyle=l.backgroundColor),o.fillRect(d.x,d.y,u,p),o.closePath(),o.beginPath(),o.font=12*g.map.scale+"px",o.fillStyle="#fff","object"===(void 0===l?"undefined":n()(l))&&l.hasOwnProperty("textColor")&&(o.fillStyle=l.textColor),o.textAlign="center",o.fillText(this.props.name,d.x+u/2,d.y+p/2+5),o.closePath(),e&&this.drawDragStyle()}},a.prototype.isSpace=function(){var t=this.props.type,e=!1;return"SPACE"===t&&(e=!0),e},a.prototype.toChecked=function(){var t=this.props,e=t.checked,o=(t.type,t.status),a=t.z;1!=o&&2!=o&&(a=g.z,g.z++,e=!e,this.componentWillReceiveProps({checked:e,z:a}))},a.prototype.isRemove=function(){return this.props.removed},a.prototype.isStation=function(){var t=this.props.type,e=!1;return"STATION"===t&&(e=!0),e},a.prototype.drawDragStyle=function(){var t=this.props,e=(t.x,t.y,this.props),a=w.transformWidthOrHeightToView(e.width,e.height),n=a.width,i=a.height,r=this.getLeftTopPosition();r=w.transformPositionToView(r.x,r.y),o.beginPath(),o.arc(r.x,r.y,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x,r.y,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.moveTo(r.x+4,r.y),o.lineTo(r.x+n/2,r.y),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x+n/2,r.y),o.lineTo(r.x+n,r.y),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x+4,r.y+i),o.lineTo(r.x+n/2,r.y+i),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x+n/2,r.y+i),o.lineTo(r.x+n,r.y+i),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x,r.y+4),o.lineTo(r.x,r.y+i/2),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x,r.y+i/2),o.lineTo(r.x,r.y+i),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x+n,r.y+4),o.lineTo(r.x+n,r.y+i/2),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x+n,r.y+i/2),o.lineTo(r.x+n,r.y+i),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+n,r.y,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+n,r.y,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x+n,r.y+i,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+n,r.y+i,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x,r.y+i,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x,r.y+i,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x+n/2,r.y,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+n/2,r.y,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x+n/2,r.y+i,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+n/2,r.y+i,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x,r.y+i/2,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x,r.y+i/2,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x+n,r.y+i/2,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+n,r.y+i/2,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath()},a.prototype.getCenterPosition=function(){var t=this.props;return{x:t.x,y:t.y}},a.prototype.getLeftTopPosition=function(){var t=this.props,e=t.x,o=t.y,a=t.width,n=t.height;return e-=a/2,o-=n/2,{x:e,y:o}},a.prototype.getTopCenterPosition=function(){var t=this.props,e=t.x,o=t.y;t.width;return o-=t.height/2,{x:e,y:o}},a.prototype.getLeftCenterPosition=function(){var t=this.props,e=t.x,o=t.y,a=t.width;t.height;return e-=a/2,{x:e,y:o}},a.prototype.getLeftBottomPosition=function(){var t=this.props,e=t.x,o=t.y,a=t.width,n=t.height;return e-=a/2,o+=n/2,{x:e,y:o}},a.prototype.getBottomCenterPosition=function(){var t=this.props,e=t.x,o=t.y;t.width;return o+=t.height/2,{x:e,y:o}},a.prototype.getRightTopPosition=function(){var t=this.props,e=t.x,o=t.y,a=t.width,n=t.height;return e+=a/2,o-=n/2,{x:e,y:o}},a.prototype.getRightBottomPosition=function(){var t=this.props,e=t.x,o=t.y,a=t.width,n=t.height;return e+=a/2,o+=n/2,{x:e,y:o}},a.prototype.getRightCenterPosition=function(){var t=this.props,e=t.x,o=t.y,a=t.width;t.height;return e+=a/2,{x:e,y:o}},a.prototype.inScalePosition=function(e,o){if(!this.hasPosition(e,o))return!1;var a=this.getLeftTopPosition(),n=this.getTopCenterPosition(),i=this.getLeftCenterPosition(),r=this.getLeftBottomPosition(),s=this.getBottomCenterPosition(),l=this.getRightTopPosition(),c=this.getRightCenterPosition(),p=this.getRightBottomPosition();return t.inRange(e,a.x,6)&&t.inRange(o,a.y,6)?(v="leftTop",u="stationLeftTopScale",!0):t.inRange(e,i.x,6)&&t.inRange(o,i.y,6)?(v="leftCenter",u="stationLeftCenterScale",!0):t.inRange(e,r.x,6)&&t.inRange(o,r.y,6)?(v="leftBottom",u="stationLeftBottomScale",!0):t.inRange(e,n.x,6)&&t.inRange(o,n.y,6)?(v="topCenter",u="stationTopCenterScale",!0):t.inRange(e,s.x,6)&&t.inRange(o,s.y,6)?(v="bottomCenter",u="stationBottomCenterScale",!0):t.inRange(e,l.x,6)&&t.inRange(o,l.y,6)?(v="rightTop",u="stationRightTopScale",!0):t.inRange(e,c.x,6)&&t.inRange(o,c.y,6)?(v="rightCenter",u="stationRightCenterScale",!0):!(!t.inRange(e,p.x,6)||!t.inRange(o,p.y,6))&&(v="rightBottom",u="stationRightBottomScale",!0)},a.prototype.opration=function(){var t=r()({},b.move),e=r()({},b.down);switch(v){case"leftTop":var o=this.getStashProps(),a=Math.sqrt(Math.pow(t.x-e.x,2),Math.pow(t.y-e.y,2));a=t.y-e.y>0?-a:a;var n=this.getProps();n.width=o.width+a,n.height=o.height+a,n.drag=!0,this.componentWillReceiveProps(n);break;case"leftCenter":var o=this.getStashProps(),a=-(t.x-e.x),n=this.getProps();n.width=o.width+a,n.height=o.height,n.width>g.station.minWidth&&(n.x=o.x-a/2),n.drag=!0,this.componentWillReceiveProps(n);break;case"leftBottom":var o=this.getStashProps(),a=Math.sqrt(Math.pow(t.x-e.x,2),Math.pow(t.y-e.y,2));a=t.y-e.y>0?a:-a;var n=this.getProps();n.width=o.width+a,n.height=o.height+a,n.drag=!0,this.componentWillReceiveProps(n);break;case"rightTop":var o=this.getStashProps(),a=Math.sqrt(Math.pow(t.x-e.x,2),Math.pow(t.y-e.y,2));a=t.y-e.y>0?-a:a;var n=this.getProps();n.width=o.width+a,n.height=o.height+a,n.drag=!0,this.componentWillReceiveProps(n);break;case"rightCenter":var o=this.getStashProps(),a=t.x-e.x,n=this.getProps();n.width=o.width+a,n.height=o.height,n.width>=g.station.minWidth&&(n.x=o.x+a/2),n.drag=!0,this.componentWillReceiveProps(n);break;case"rightBottom":var o=this.getStashProps(),a=Math.sqrt(Math.pow(t.x-e.x,2),Math.pow(t.x-e.x,2));a=t.y-e.y>0?a:-a;var n=this.getProps();n.width=o.width+a,n.height=o.height+a,n.drag=!0,this.componentWillReceiveProps(n);break;case"topCenter":var o=this.getStashProps(),a=-(t.y-e.y),n=this.getProps();n.width=n.width,n.height=o.height+a,n.height>=g.station.minHeight&&(n.y=o.y-a/2),n.drag=!0,this.componentWillReceiveProps(n);break;case"bottomCenter":var o=this.getStashProps(),a=t.y-e.y,n=this.getProps();n.width=n.width,n.height=o.height+a,n.height>=g.station.minHeight&&(n.y=o.y+a/2),n.drag=!0,this.componentWillReceiveProps(n)}},a.prototype.hasPosition=function(t,e){var o=this.props,a=o.width,n=o.height,i=this.getLeftTopPosition(),r=i.x,s=r+a,l=i.y,c=l+n;return t>=r&&t<=s&&e>=l&&e<=c},new a(e)};x.inRange=function(t,e,o){e=Math.ceil(Number(e)),o=Math.ceil(Number(o));var a=Math.min(e-o,e+o),n=Math.max(e-o,e+o);return t>=a&&t<=n};var w=function t(e,n){var d=function(t,e){g.db.reset(),m=[],this.isComponentDidMout=!1,this.readyCallback=function(){},a=document.getElementById(t),s=a.clientWidth,l=a.clientHeight,e.hasOwnProperty("stationToSame")&&(g.station.isToSameSize=e.stationToSame),e.hasOwnProperty("backgroundImageUrl")&&g.db.setImageUrl(e.backgroundImageUrl),e.hasOwnProperty("isMode")&&(g.isMode=e.isMode),this.initializeModeConfigs(),e.hasOwnProperty("station")&&(g.station=r()({},g.station,e.station)),e.hasOwnProperty("translateX")&&(g.map.translateX=e.translateX),e.hasOwnProperty("translateY")&&(g.map.translateY=e.translateY),e.hasOwnProperty("map")&&(g.map=r()({},g.map,e.map)),e.hasOwnProperty("stationStatus")&&(g.stationStatus=r()({},g.stationStatus,e.stationStatus)),e.hasOwnProperty("plugin")&&(g.plugin=r()({},g.plugin,e.plugin)),i=document.createElement("canvas"),i.width=s,i.height=l,a.appendChild(i),o=i.getContext("2d"),e.stations.map(function(t,e){var o=r()({},t);o.x=Number(o.x),o.y=Number(o.y),o.width=Number(o.width),o.height=Number(o.height),m.push(x(o))}),g.rulers.map(function(t,e){var o=r()({},t);o.x=Number(o.x),o.y=Number(o.y),f.push(S(o))}),this.loadImage()};return d.prototype.initializeModeConfigs=function(){var t=g.operationTypeConfigs,e=g.utils;e.isViewMode()&&(g.map.deleteEnable=!1,g.map.scaleEnable=!0,g.map.mouseEnable=!1,g.map.rulerEnable=!1,g.map.stationClick=!1,t.stationHover.style="auto"),e.isSelectMode()&&(g.map.deleteEnable=!1,g.map.scaleEnable=!0,g.map.mouseEnable=!1,g.map.rulerEnable=!1),g.operationTypeConfigs=r()({},t)},d.prototype.mapMenu={element:null,create:function(t){if(void 0===c){c=document.createElement("div");document.querySelectorAll('[data-type="left"]');c.style.position="absolute",c.style.width="100px",c.style.height="100px",c.style.right="10px",c.style.top="10px",c.style.border="1px solid red",c.style.zIndex=8,c.innerHTML='<div>\n                        <span data-type="left">左</span>\n                        <span data-type="up">上</span>\n                        <span data-type="right">右</span>\n                        <span data-type="down">下</span>\n                    </div>';var e=null;c.addEventListener("mousedown",function(o){var a=o.target,n=a.getAttribute("data-type");e=window.setInterval(function(){switch(n){case"up":t.operationToTranslateUp();break;case"right":t.operationToTranslateRight();break;case"down":t.operationToTranslateDown();break;case"left":t.operationToTranslateLeft()}},200)}),c.addEventListener("mouseup",function(t){window.clearInterval(e)}),a.appendChild(c)}c.style.display="block"}},d.prototype.loadImage=function(t){var e=this;t=t||g.db.getImageUrl(),t||(g.map.isLoadImageError=!0),g.map.isLoadImageError=!1,h=new Image,h.src=t,h.onerror=function(){g.plugin.onErrorCallback&&g.plugin.onErrorCallback("图片加载错误"),g.map.isLoadImageError=!0,e.render()},h.onload=function(){e.render()}},d.prototype.componentDidMount=function(){var t=g.plugin.readyCallback;this.isComponentDidMout=!0,this.registerEvents(),t&&t()},d.prototype.setMouseStyle=function(){if(void 0!==u){var t=g.operationTypeConfigs,e=t[u];a.style.cursor=e.style}},d.prototype.clear=function(){i.width=s},d.prototype.drawMouserPosition=function(){if(g.map.mouseEnable){var e=b.move,a=t.transformPositionToView(e.x,e.y),n=a.x,i=a.y;o.beginPath(),o.moveTo(n,0),o.strokeStyle="red",o.lineTo(n,l),o.closePath(),o.stroke(),o.beginPath(),o.moveTo(0,i),o.strokeStyle="red",o.lineTo(s,i),o.closePath(),o.stroke()}},d.prototype.operationToTranslateLeft=function(){g.map.translateX-=50,this.render()},d.prototype.operationToTranslateRight=function(){g.map.translateX+=50,this.render()},d.prototype.operationToTranslateUp=function(){g.map.translateY-=50,this.render()},d.prototype.operationToTranslateDown=function(){g.map.translateY+=50,this.render()},d.prototype.render=function(){var t=g.map.menuEnable;if(this.clear(),this.calcMaxMin(),this.drawImage(),this.drawStations(),this.drawRulers(),this.setMouseStyle(),this.drawMouserPosition(),t&&this.mapMenu.create(this),!this.isComponentDidMout)return void this.componentDidMount();var e=g.plugin.onRenderMapCallback;e&&e(i.toDataURL("image/jpeg"))},d.prototype.onRenderMap=function(t){g.plugin.onRenderMapCallback=t},d.prototype.onScaleMap=function(t){g.plugin.onScaleMapCallback=t},d.prototype.onCheckedStation=function(t){g.plugin.onCheckedStationCallback=t},d.prototype.onHoverInStation=function(t){g.plugin.onHoverInStationCallback=t},d.prototype.onHoverOutStation=function(t){g.plugin.onHoverOutStationCallback=t},d.prototype.onError=function(t){g.plugin.onErrorCallback=t},d.prototype.drawRulers=function(){if(f.length)return void f.map(function(t){t.render()})},d.prototype.drawStations=function(){if(m.length)return this.sortStation(),void m.map(function(t){t.isRemove()||t.render()})},d.prototype.cleanStationDragStyle=function(){this.getDragStations().map(function(t){t.setProps({drag:!1})}),this.render()},d.prototype.savePropsToStash=function(){var t=g.map,e=t.translateX,o=t.translateY,a=t.scale;this.stashProps={translateX:e,translateY:o,scale:a}},d.prototype.getStashProps=function(){return r()({},this.stashProps)},d.prototype.scaleMap=function(t){this.savePropsToStash();var e=g.map,o=e.scaleSpeed,a=e.scaleMax,n=e.scaleMin,i=g.plugin.onScaleMapCallback;t>0?g.map.scale+=o:g.map.scale-=o,g.map.scale>a&&(g.map.scale=a,g.map.scale=a),g.map.scale<=n&&(g.map.scale=n);this.getStashProps();i&&i(Math.abs(g.map.scale)),this.render()},d.prototype.registerEvents=function(){var e=this,o=g.map.scaleEnable,a=function(o){t.setMovePosition(o),e.drawRulerMove()},n=function(o){t.setMovePosition(o),e.drawRulerMove()},r=function(t){t.preventDefault();var o=t.deltaY;return e.scaleMap(o),!1},s=function(o){t.setMovePosition(o),e.drawScaleStationMove(),i.addEventListener("mouseup",l,!1)},l=function(e){t.setUpPosition(e),i.removeEventListener("mousemove",s,!1)},c=function(o){t.setMovePosition(o),e.drawDragStationMove(),i.addEventListener("mouseup",h,!1)},h=function o(a){t.setUpPosition(a),e.endDragStation(),i.removeEventListener("mouseup",o,!1),i.removeEventListener("mousemove",c,!1)},m=function(o){t.setMovePosition(o),p.push(b.move);var a=p[0],n=p[p.length-1];(Math.abs(a.x-n.x)>=1||Math.abs(a.y-n.y)>=1)&&e.dragMap(),i.addEventListener("mouseup",f,!1)},f=function e(o){t.setUpPosition(o),i.removeEventListener("mouseup",e,!1),i.removeEventListener("mousemove",m,!1),p=[]},v=function(e){t.setDownPosition(e),g.map.contextMenuEnable&&(d.contextMenu.create(),e.preventDefault())},y=function(o){if(t.setDownPosition(o),!g.map.stationClick)return void i.addEventListener("mousemove",m,!1);var r=b.down;if(2===o.button)return document.addEventListener("contextmenu",v,!1),!1;if(e.isInStation(r.x,r.y)){if(g.utils.isSelectMode())return void e.setCheckedStationStyle(r.x,r.y);e.setDragStationStyle(r.x,r.y),e.startDragStation(),e.isInStationDragPosition(r.x,r.y)?i.addEventListener("mousemove",s,!1):i.addEventListener("mousemove",c,!1)}else e.isInRuler(r.x,r.y)?(e.setCheckedRulerStyle(r.x,r.y),i.addEventListener("mousemove",n,!1)):e.isInCanvasTopLine(r.x,r.y)?(e.newRulerInCanvasTop(r.x,r.y),i.addEventListener("mousemove",a,!1)):e.isInCanvasLeftLine(r.x,r.y)?(e.newRulerInCanvasLeft(r.x,r.y),i.addEventListener("mousemove",a,!1)):(e.cleanStationDragStyle(),i.removeEventListener("mousemove",s,!1),i.removeEventListener("mousemove",c,!1),i.addEventListener("mousemove",m,!1));i.addEventListener("mouseup",S,!1),i.removeEventListener("mousemove",x,!1)},S=function t(e){i.removeEventListener("mousemove",n,!1),i.removeEventListener("mousemove",a,!1),i.removeEventListener("mousemove",s,!1),i.removeEventListener("mousemove",l,!1),i.removeEventListener("mousemove",c,!1),i.removeEventListener("mousemove",h,!1),i.removeEventListener("mousemove",m,!1),i.removeEventListener("mousemove",f,!1),i.removeEventListener("mouseup",t,!1),i.addEventListener("mousemove",x,!1),d.contextMenu.close()},x=function(o){t.setMovePosition(o);var a=b.move;e.judgeHoverInStation(a.x,a.y),e.isInStation(a.x,a.y)?e.isInStationDragPosition(a.x,a.y)||(u="stationHover"):u=e.isInRuler(a.x,a.y)?"rulerHover":e.isInCanvasTopLine(a.x,a.y)?"canvasTopLineHover":e.isInCanvasLeftLine(a.x,a.y)?"canvasLeftLineHover":"mapHover",e.render()},w=function(t){switch(t.keyCode){case 8:case 46:e.removeCheckedStation()}},I=function(t){i.addEventListener("mousemove",x,!1),document.addEventListener("keyup",w,!1),i.addEventListener("mouseleave",P,!1),o&&i.addEventListener("mousewheel",r,!1)},P=function(e){t.setDownPosition(e),i.removeEventListener("mousemove",c,!1),i.removeEventListener("mousemove",m,!1),i.removeEventListener("mousemove",s,!1),i.removeEventListener("mouseup",S,!1),document.removeEventListener("keyup",w,!1),document.removeEventListener("contextmenu",v,!1),i.removeEventListener("mousewheel",r,!1)};i.addEventListener("mousedown",y,!1),i.addEventListener("mouseover",I,!1),document.addEventListener("keyup",w,!1),o&&i.addEventListener("mousewheel",r,!1)},d.prototype.calcMaxMin=function(){g.map.scale>g.map.scaleMax&&(g.map.scale=g.map.scaleMax,g.map.scale=g.map.scaleMax),g.map.scale<=g.map.scaleMin&&(g.map.scale=g.map.scaleMin)},d.prototype.drawImage=function(){if(!g.map.isLoadImageError){var t=h;o.beginPath(),o.drawImage(t,g.map.translateX*g.map.scale,g.map.translateY*g.map.scale,t.width*g.map.scale,t.height*g.map.scale),o.closePath()}},d.prototype.isInStationDragPosition=function(t,e){var o=this.getDragStations(),a=!1;return o.map(function(o){o.inScalePosition(t,e)&&(a=!0)}),a},d.prototype.getDragStations=function(){var t=[],e=null;return m.map(function(o){e=o.getProps(),e.drag&&t.push(o)}),t},d.prototype.sortDescStationObjectArray=function(){m.sort(function(t,e){var o=t.getProps(),a=e.getProps();return parseInt(a.z)-parseInt(o.z)})},d.prototype.sortAscStationObjectArray=function(){m.sort(function(t,e){var o=t.getProps(),a=e.getProps();return parseInt(o.z)-parseInt(a.z)})},d.prototype.setCheckedRulerStyle=function(t,e){for(var o=null,a=0,n=f.length;a<n;a++)o=f[a],o.hasPosition(t,e)?(o.getProps(),o.toChecked()):o.setProps({checked:!1})},d.prototype.setCheckedStationStyle=function(t,e){if(!g.utils.isEditMode()){this.sortDescStationObjectArray();for(var o=null,a={},n=0,i=m.length;n<i;n++)if(o=m[n],o.hasPosition(t,e)){o.toChecked(),a=o.getProps();break}var r=g.plugin.onCheckedStationCallback,s=this.getCheckedAll();r&&r(a,s)}},d.prototype.setDragStationStyle=function(t,e){if(g.utils.isEditMode()){this.cleanDragStations(),this.sortDescStationObjectArray();for(var o=null,a=null,n=0,i=m.length;n<i;n++)if(o=m[n],o.hasPosition(t,e)){a=o.getProps(),a.drag||(a.drag=!0),a.z=g.z,o.componentWillReceiveProps(a);break}g.z++}},d.prototype.sortStation=function(){m.sort(function(t,e){var o=t.getProps(),a=e.getProps();return o.z-a.z})},d.prototype.isInCanvasLeftLine=function(e,o){return t.canvasToWindow(e,o).x<5},d.prototype.newRulerInCanvasTop=function(t,e){if(g.map.rulerEnable){f.map(function(t){t.setProps({checked:!1})});var o=r()({},{x:t,y:e,type:"horizontal",checked:!0});f.push(S(o))}},d.prototype.newRulerInCanvasLeft=function(t,e){if(g.map.rulerEnable){f.map(function(t){t.setProps({checked:!1})});var o=r()({},{x:t,y:e,type:"vertical",checked:!0});f.push(S(o))}},d.prototype.isInCanvasTopLine=function(e,o){return t.canvasToWindow(e,o).y<=8},d.prototype.isInCanvasTopLeft=function(e,o){return t.canvasToWindow(e,o).x<=8},d.prototype.isInRuler=function(t,e){for(var o=null,a=!1,n=0,i=f.length;n<i;n++)if(o=f[n],o.hasPosition(t,e)){a=!0;break}return a},d.prototype.isInStation=function(t,e){for(var o=null,a=!1,n=0,i=m.length;n<i;n++)if(o=m[n],o.hasPosition(t,e)){a=!0;break}return a},d.prototype.stationOtherHoverOut=function(t){for(var e=null,o=null,a=0,n=m.length;a<n;a++)o=m[a],e=o.getProps(),e.key!==t&&o.onHoverOut()},d.prototype.judgeHoverInStation=function(t,e){var o=(g.plugin.onHoverInStationCallback,this),a=null,n=null;this.sortDescStationObjectArray();for(var i=0,r=m.length;i<r;i++){if(a=m[i],n=a.getProps(),a.hasPosition(t,e)){o.stationOtherHoverOut(n.key),a.onHoverIn();break}a.onHoverOut()}},d.prototype.dragMap=function(){var t=p[0],e=p[p.length-1],o=e.x-t.x,a=e.y-t.y,n=Math.abs(o),i=Math.abs(a);Math.max(n,i)<10||(g.map.translateX+=3*(e.x-t.x),g.map.translateY+=3*(e.y-t.y),this.render(),p=[])},d.prototype.startDragStation=function(){this.getDragStations().map(function(t){t.saveProps()})},d.prototype.moveDragStation=function(){},d.prototype.endDragStation=function(){},d.prototype.removeStation=function(){},d.prototype.removeCheckedStation=function(){if(g.map.deleteEnable){var t=this.getDragStations();if(t.length){var e,o=[];t.map(function(t){e=t.getProps(),t.remove(),o.push(e)});var a=[];m=m.filter(function(t){var e=!t.isRemove();return e&&a.push(t.getProps()),e}),this.render(),g.plugin.onRemoveCallback&&g.plugin.onRemoveCallback(o,a)}}},d.prototype.cleanDragStations=function(){var t=this.getDragStations();t=t.filter(function(t){return!t.removed}),this.render()},d.prototype.drawDragStationMove=function(){var t=g.utils,e=this;if(t.isEditMode()){var o=this.getDragStations();m.map(function(t){t.setProps({drag:!1})});var a=b.move.x-b.down.x,n=b.move.y-b.down.y,i={},r=null,s=!1,l={};o.map(function(t,o){r=t.getStashProps(),i.x=r.x+a,i.y=r.y+n;var c=e.getAdsorbPosition(i.x-r.width/2,i.y-r.height/2);if(l.x=c.x+r.width/2,l.y=c.y+r.height/2,i.x===l.x&&i.y===l.y||(s=!0),i.x=l.x,i.y=l.y,t.move(i.x,i.y),c=e.getAdsorbPosition(i.x+r.width/2,i.y+r.height/2),l.x=c.x-r.width/2,l.y=c.y-r.height/2,!s)return i.x=l.x,i.y=l.y,void t.move(i.x,i.y);var u={},p=l.x-i.x,d=l.y-i.y;u.x=i.x+p/2,u.y=i.y+d/2,u.width=r.width+p/2,u.height=r.height+d/2,t.setProps(u)}),this.render()}},d.prototype.getDragRuler=function(){var t=[];return f.map(function(e){e.getProps().checked&&t.push(e)}),t},d.prototype.drawRulerMove=function(){var t=b.move;this.getDragRuler().map(function(e){e.move(t.x,t.y)}),this.render()},d.prototype.drawScaleStationMove=function(){if(g.utils.isEditMode()){var t=(b.move,this.getDragStations());t.map(function(t,e){t.opration(v)});var e=t[0],o=e.getProps();e.isStation()&&(g.station.width=o.width,g.station.height=o.height),this.stationToSameAction(),this.render()}},d.prototype.ready=function(t){g.plugin.readyCallback=t},d.prototype.getCanvasElement=function(){return i},d.prototype.save=function(t){var e={};e.translateX=g.map.translateX,e.translateY=g.map.translateY,e.scale=g.map.scale,e.stations=g.db.getAllStation(),t&&t(e)},d.prototype.destory=function(){m=[],h=null,g.map.scale=1,g.map.translateX=0,g.map.translateY=0,g.db.reset(),a.removeChild(i)},d.prototype.getAdsorbPosition=function(t,e){return f.map(function(o){var a=o.getProps();o.isHorizontalLine()?a.y-20<e&&e<a.y+20&&(e=a.y):o.isVerticalLine()&&a.x-20<t&&t<a.x+20&&(t=a.x)}),{x:t,y:e}},d.prototype.getStationLeftTopPosition=function(){},d.prototype.createStation=function(t){var e=(this.getDragStations(),g.station),o=e.width,a=e.height,n=e.isToSameSize;if(t){g.z++,n&&"STATION"===t.type&&(t.width=o,t.height=a),t.z=g.z;var i=this.getAdsorbPosition(t.x-t.width/2,t.y-t.height/2);t.x=i.x+t.width/2,t.y=i.y+t.height/2;var r=x(t);m.push(r)}},d.prototype.getCheckedAll=function(){var t=[],e={};return m.map(function(o){e=o.getProps(),e.checked&&t.push(e)}),t},d.prototype.setBackgroundImage=function(t){var e=this;g.map.scale=1,g.map.translateX=0,g.map.translateY=0;var o=new FileReader;o.onloadend=function(){e.loadImage(o.result)},o.readAsDataURL(t)},d.prototype.stationToSameAction=function(){this.getDragStations();if(g.station.isToSameSize){var t=g.station,e=t.width,o=t.height;m.map(function(t){t.getProps();t.isStation()&&t.setProps({width:e,height:o})})}},d.prototype.onRemove=function(t){g.plugin.onRemoveCallback=t},d.prototype.setStationToSame=function(t,e){g.station.isToSameSize=t,this.stationToSameAction(),this.render()},d.prototype.setScale=function(t){g.map.scale=t,this.render()},d.contextMenu={create:function(){var e=b.down,o=t.canvasToWindow(e.x,e.y),n=o.x,i=o.y;void 0===y&&(y=document.createElement("div"),y.id="contextMenu",y.className="m-context-menu",y.innerHTML='<ul class="right-menu"><li>加载</li><li>关闭</li></ul>',a.appendChild(y)),y.style.left=n+"px",y.style.top=i+"px",y.style.display="block"},close:function(){void 0!==y&&(y.style.display="none")}},new d(e,n)};w.setUpPosition=function(t){b.up=w.windowToCanvas(t)},w.setDownPosition=function(t){b.down=w.windowToCanvas(t)},w.setMovePosition=function(t){b.move=w.windowToCanvas(t)},w.windowToCanvas=function(t){var e={x:0,y:0},o={};o=i.getBoundingClientRect();var a=t.clientX,n=t.clientY;return e.x=a-o.left*(s/o.width),e.y=n-o.top*(l/o.height),e.x=e.x<0?Math.ceil(e.x):Math.floor(e.x),e.y=e.y<0?Math.ceil(e.y):Math.floor(e.y),w.transformPositionToOrigin(e.x,e.y)},w.canvasToWindow=function(t,e){var o={x:0,y:0},a={};a=i.getBoundingClientRect();var n=t,r=e;return o.x=n+a.left/(s*a.width),o.y=r+a.top/(l*a.height),o.x=o.x<0?Math.ceil(o.x):Math.floor(o.x),o.y=o.y<0?Math.ceil(o.y):Math.floor(o.y),w.transformPositionToView(o.x,o.y)},w.transformWidthOrHeightToView=function(t,e){var o=g.map.scale;return{width:Number(t)*o,height:Number(e)*o}},w.transformWidthOrHeightToOrigin=function(t,e){var o=g.map.scale;return{width:Number(t)/o,height:Number(e)/o}},w.transformPositionToView=function(t,e){var o=g.map,a=o.translateX,n=o.translateY,i=o.scale;return{x:(Number(t)+Number(a))*i,y:(Number(e)+Number(n))*i}},w.transformPositionToOrigin=function(t,e){var o=g.map,a=o.translateX,n=o.translateY,i=o.scale;return{x:Number(t)/i-Number(a),y:Number(e)/i-Number(n)}};var I=w(t,e);return{ready:function(){I.ready.apply(I,arguments)},change:function(){},setScale:function(){I.setScale.apply(I,arguments)},onError:function(){I.onError.apply(I,arguments)},setStationToSame:function(){I.setStationToSame.apply(I,arguments)},save:function(){I.save.apply(I,arguments)},destory:function(){I.destory.apply(I,arguments)},setBackgroundImage:function(){I.setBackgroundImage.apply(I,arguments)},getCheckedAll:function(){I.getCheckedAll.apply(I,arguments)},onRemove:function(){I.onRemove.apply(I,arguments)},onScaleMap:function(){I.onScaleMap.apply(I,arguments)},onCheckedStation:function(){I.onCheckedStation.apply(I,arguments)},onHoverInStation:function(){I.onHoverInStation.apply(I,arguments)},onHoverOutStation:function(){I.onHoverOutStation.apply(I,arguments)},onRenderMap:function(){I.onRenderMap.apply(I,arguments)},createStation:function(){var t=I.getCanvasElement(),e=t.getBoundingClientRect(),o=r()({},arguments[0]);o.x=Number(o.x)-Number(e.left),o.y=Number(o.y)-Number(e.top);var a=w.transformPositionToOrigin(o.x,o.y);o.x=a.x,o.y=a.y,I.createStation(o)}}};e.a=s},"Ta+G":function(t,e,o){"use strict";function a(t){var e=t.type;return"DOMMouseScroll"!=e&&"mousewheel"!=e||(t.delta=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3),t.srcElement&&!t.target&&(t.target=t.srcElement),t.preventDefault||void 0===t.returnValue||(t.preventDefault=function(){t.returnValue=!1}),t}var n=function(t,e,o,n){console.log("-------"),window.addEventListener?("mousewheel"===e&&void 0!==document.mozFullScreen&&(e="DOMMouseScroll"),t.addEventListener(e,function(t){o(a(t))},n||!1)):window.attachEvent&&t.attachEvent("on"+e,function(t){t=t||window.event,o(a(t))})};e.a=n},Ucgj:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,'.section-title[data-v-872aada8]{border-bottom:1px solid #e8e9e9;height:50px;font-size:16px;color:#666;line-height:50px;padding-left:25px;position:relative}.section-title[data-v-872aada8]:before{height:24px;border:2px solid #499df1;position:absolute;width:0;content:"";display:inline-block;top:12px;left:0}.section-detail-title[data-v-872aada8]{border-bottom:1px solid #e8e9e9;height:50px;font-size:16px;color:#666;line-height:50px;padding-left:15px;position:relative}',""])},VSp2:function(t,e,o){"use strict";function a(t){o("nnyj")}var n=o("o/MA"),i=o("gJbB"),r=o("VU/8"),s=a,l=r(n.a,i.a,!1,s,null,null);e.a=l.exports},XvJJ:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".com-select-customers ::-webkit-input-placeholder{color:#666}.com-select-customers ::-moz-placeholder{color:#666}.com-select-customers :-ms-input-placeholder{color:#666}.com-select-customers input:-moz-placeholder{color:#666}",""])},YxGB:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,'.required-label{font-size:14px;position:relative;margin-left:5px}.required-label.required-label:before{content:"*";color:red;position:absolute;font-size:18px;left:-7px;top:14px}.pay-error{color:#ed3f14}.vertical-center-modal{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.vertical-center-modal .ivu-modal{top:0}#chancemsg{position:absolute;bottom:2px;display:block}.OpportunityRequired{color:#ed3f14}.requiremark .ivu-form-item-label:before{content:""}',""])},bsze:function(t,e,o){"use strict";function a(t){var e=["角","分"],o=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],a=[["元","万","亿"],["","拾","佰","仟"]],n=t<0?"负":"";t=Math.abs(t);var i="",r=(t+"").split(".").length,s="00";r>1&&(s=(t+"").split(".")[1]);for(var l=0;l<e.length;l++)o[s[l]]&&(i+=(o[s[l]]+e[l]).replace(/零./,""));i=i||"整",t=Math.floor(t);for(var l=0;l<a[0].length&&t>0;l++){for(var c="",u=0;u<a[1].length&&t>0;u++)c=o[t%10]+a[1][u]+c,t=Math.floor(t/10);i=c.replace(/(零.)*零$/,"").replace(/^$/,"零")+a[0][l]+i}return n+i.replace(/(零.)*零元/,"元").replace(/(零.)+/g,"零").replace(/^整$/,"零元整")}function n(t){for(var e in t)t[e]=""}function i(t,e){var o=[];for(var a in t)t.hasOwnProperty(a)&&o.push(a+"="+t[a]);var e=e+"?"+o.join("&");window.location.href=e}function r(){var t=location.search,e=new Object;if(-1!=t.indexOf("?"))for(var o=t.substr(1),a=o.split("&"),n=0;n<a.length;n++)e[a[n].split("=")[0]]=unescape(a[n].split("=")[1]);return e}function s(t){var e=window.location.href,o=e.split("?")[0],a=[];for(var n in t)t.hasOwnProperty(n)&&a.push(n+"="+t[n]);o=o+"?"+a.join("&"),location.href=o}function l(t){for(var e,o=0,a={},n=[];e=t[o++];){var i=e.id;a[i]||(a[i]=!0,n.push(e))}return n}function c(t,e,o,a){for(var n=0;n<e.length;n++)for(var i=0;i<t.length;i++){var r=o?t[i][o]:t[i],s=a?e[n][a]:e[n];r==s&&t.splice(i,1)}return t}function u(t,e){var o=document.createElement("a");o.href=t,o.download=e,console.log("a--",o,t,e),o.click()}function p(t,e){var o=document.createElement("a");o.href=t,o.target="_blank",o.download=e,o.click()}function d(t,e){return e=parseInt(e,10),new Date(t,e,0).getDate()}function h(t,e){var o,a,n;return o=t.split("-"),a=new Date(o[1]+"/"+o[2]+"/"+o[0]),o=e.split("-"),n=new Date(o[1]+"/"+o[2]+"/"+o[0]),parseInt(Math.abs(a-n)/1e3/60/60/24)}function m(t,e,o){return void 0===o?w()(t,e,!1):w()(t,o,!1!==e)}function f(t,e){var o=new Date(t),a=new Date(o.getFullYear(),o.getMonth(),o.getDate()+e);o.getFullYear(),o.getMonth(),o.getDate();return a.getFullYear()+"-"+(a.getMonth()+1)+"-"+a.getDate()}function g(){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var e=document.createElement("div"),o=e.style;o.position="absolute",o.top=0,o.left=0,o.pointerEvents="none",o.visibility="hidden",o.width="200px",o.height="150px",o.overflow="hidden",e.appendChild(t),document.body.appendChild(e);var a=t.offsetWidth;e.style.overflow="scroll";var n=t.offsetWidth;return a===n&&(n=e.clientWidth),document.body.removeChild(e),a-n}function v(t,e){var o,a,n;return o=t.split("-"),a=new Date(o[1]+"/"+o[2]+"/"+o[0]),o=e.split("-"),n=new Date(o[1]+"/"+o[2]+"/"+o[0]),parseInt(Math.abs(a-n)/1e3/60/60/24)}var y=o("syeK"),b=o("Ta+G"),S=o("Asao"),x=o("IoNu"),w=o.n(x),I=o("Eqh0"),P=o("9pIO");e.a={smalltoBIG:a,clearForm:n,commonExport:i,getRequest:r,addParams:s,arrayNoRepeat:l,arrayCompare:c,thousand:y.a,downFile:u,addEvent:b.a,dataType:S.a,getDaysInOneMonth:d,dateDiff:h,debounce:m,getScrollBarSize:g,dateCompatible:I.a,tableSort:P.a,dateRange:f,downImg:p,timeRange:v}},bwlM:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"create-new-order"},[o("SectionTitle",{attrs:{title:"新建入驻服务订单管理"}}),o("Form",{ref:"formItem",staticClass:"creat-order-form",attrs:{model:t.formItem,rules:t.ruleCustom}},[o("DetailStyle",{attrs:{info:"基本信息"}},[o("Row",{staticStyle:{"margin-bottom":"30px"}},[o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"客户名称",prop:"customerId"}},[o("selectCustomers",{attrs:{name:"formItem.customerId",onchange:t.changeCustomer}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"所属社区",prop:"communityId"}},[o("selectCommunities",{attrs:{test:"formItem",onchange:t.changeCommunity}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"销售员",prop:"salerId"}},[o("SelectSaler",{attrs:{name:"formItem.salerId",onchange:t.changeSaler,value:t.salerName}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{directives:[{name:"show",rawName:"v-show",value:t.showSaleChance,expression:"showSaleChance"}],class:{requiremark:!t.OpportunityRequired},staticStyle:{width:"252px"},attrs:{label:"机会",prop:"salerId"}},[o("SelectChance",{directives:[{name:"show",rawName:"v-show",value:t.showChanceSelector,expression:"showChanceSelector"}],attrs:{name:"formItem.salerId",orderitems:t.orderitems,defaultValue:t.defaultChanceID},on:{onChange:t.changeChance,gotChanceList:t.handleGotChancelist}})],1),o("p",{directives:[{name:"show",rawName:"v-show",value:!t.showChanceSelector,expression:"!showChanceSelector"}],class:{OpportunityRequired:t.OpportunityRequired},attrs:{id:"chancemsg"}},[t._v(t._s(t.opportunityTipStr))])],1)],1)],1),o("DetailStyle",{attrs:{info:"租赁信息"}},[o("Row",{staticStyle:{"margin-bottom":"30px"}},[o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"租赁开始日期",prop:"startDate"}},[o("DatePicker",{staticStyle:{display:"block"},attrs:{type:"date",placeholder:"租赁开始时间"},on:{"on-change":t.changeBeginTime},model:{value:t.formItem.startDate,callback:function(e){t.$set(t.formItem,"startDate",e)},expression:"formItem.startDate"}}),t.timeError?o("div",{staticClass:"pay-error"},[t._v("租赁开始时间不得大于结束时间")]):t._e()],1)],1),t._e(),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"租赁结束日期",prop:"endDate"}},[o("DatePicker",{staticStyle:{display:"block"},attrs:{type:"date",placeholder:"租赁结束日期",format:"yyyy-MM-dd"},on:{"on-change":t.changeEndDateStatus},model:{value:t.formItem.endDate,callback:function(e){t.$set(t.formItem,"endDate",e)},expression:"formItem.endDate"}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"租赁时长"}},[o("Input",{attrs:{placeholder:"租赁时长",disabled:""},model:{value:t.formItem.timeRange,callback:function(e){t.$set(t.formItem,"timeRange",e)},expression:"formItem.timeRange"}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"签署日期",prop:"signDate"}},[o("DatePicker",{staticStyle:{display:"block"},attrs:{type:"date",placeholder:"签署日期",format:"yyyy-MM-dd"},model:{value:t.formItem.signDate,callback:function(e){t.$set(t.formItem,"signDate",e)},expression:"formItem.signDate"}})],1)],1)],1)],1),o("DetailStyle",{attrs:{info:"金额信息"}},[o("Row",{staticStyle:{"margin-bottom":"10px"}},[o("Col",{staticClass:"col"},[o("Button",{staticStyle:{"margin-right":"20px","font-size":"14px"},attrs:{type:"primary"},on:{click:t.showStation}},[t._v("选择工位")]),o("Button",{staticStyle:{"margin-right":"20px","font-size":"14px"},attrs:{type:"ghost"},on:{click:t.deleteStation}},[t._v("删除")]),o("Button",{staticStyle:{"font-size":"14px"},attrs:{type:"primary"},on:{click:t.openPriceButton}},[t._v("录入单价")])],1)],1),o("Row",{staticStyle:{"margin-bottom":"10px"}},[o("Col",{attrs:{sapn:"24"}},[o("Table",{ref:"selection",attrs:{border:"",columns:t.columns4,data:t.stationList},on:{"update:data":function(e){t.stationList=e},"on-selection-change":t.selectRow}}),t.stationList.length?o("div",{staticClass:"total-money"},[o("span",[t._v("服务费总计")]),o("span",{staticClass:"money"},[t._v(t._s(t._f("thousand")(t.formItem.stationAmount))+" ")]),o("span",{staticClass:"money"},[t._v(t._s(t.stationAmount))])]):t._e()],1)],1)],1),o("DetailStyle",{directives:[{name:"show",rawName:"v-show",value:t.youhui.length,expression:"youhui.length"}],staticStyle:{"margin-top":"40px"},attrs:{info:"优惠信息"}},[o("Row",{staticStyle:{"margin-bottom":"10px"}},[o("Col",{staticClass:"col"},[o("Button",{staticStyle:{"margin-right":"20px","font-size":"14px"},attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("添加")]),o("Button",{staticStyle:{"font-size":"14px"},attrs:{type:"ghost"},on:{click:t.deleteDiscount}},[t._v("删除")]),o("span",{directives:[{name:"show",rawName:"v-show",value:t.discountError,expression:"discountError"}],staticClass:"pay-error"},[t._v(t._s(t.discountError))])],1)],1),o("Row",[o("Col",{staticClass:"discount-table-head",attrs:{span:"3"}},[o("Checkbox",{on:{"on-change":t.selectDiscount},model:{value:t.selectAll,callback:function(e){t.selectAll=e},expression:"selectAll"}})],1),o("Col",{staticClass:"discount-table-head",attrs:{span:"6"}},[o("span",[t._v(" 优惠类型")])]),o("Col",{staticClass:"discount-table-head",attrs:{span:"5"}},[o("span",[t._v("开始时间")])]),o("Col",{staticClass:"discount-table-head",attrs:{span:"5"}},[o("span",[t._v("结束时间")])]),o("Col",{staticClass:"discount-table-head",attrs:{span:"5"}},[o("span",[t._v("折扣")])])],1),t._l(t.formItem.items,function(e,a){return o("FormItem",{key:a,staticStyle:{margin:"0",border:"1px solid e9eaec","border-top":"none","border-bottom":"none"}},[o("Row",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"item.show"}]},[o("Col",{staticClass:"discount-table-content",staticStyle:{padding:"0"},attrs:{span:"3"}},[o("Checkbox",{model:{value:e.select,callback:function(o){t.$set(e,"select",o)},expression:"item.select"}})],1),o("Col",{staticClass:"discount-table-content",attrs:{span:"6"}},[o("Select",{attrs:{"label-in-value":""},on:{"on-change":t.changeType},model:{value:e.type,callback:function(o){t.$set(e,"type",o)},expression:"item.type"}},t._l(t.youhui,function(e,n){return o("Option",{key:e.value+a+e.name+e.id,attrs:{value:e.value+"/"+a+"/"+e.name+"/"+e.id}},[t._v(t._s(e.label))])}))],1),o("Col",{staticClass:"discount-table-content",attrs:{span:"5"}},[o("DatePicker",{directives:[{name:"show",rawName:"v-show",value:"3"!=e.tacticsType,expression:"item.tacticsType != '3'"}],attrs:{type:"date",placeholder:"开始时间",disabled:""},model:{value:e.validStart,callback:function(o){t.$set(e,"validStart",o)},expression:"item.validStart"}}),o("DatePicker",{directives:[{name:"show",rawName:"v-show",value:"3"==e.tacticsType,expression:"item.tacticsType == '3'"}],attrs:{type:"date",placeholder:"开始时间"},on:{"on-change":t.changeSaleTime},model:{value:e.startDate,callback:function(o){t.$set(e,"startDate",o)},expression:"item.startDate"}})],1),o("Col",{staticClass:"discount-table-content",attrs:{span:"5"}},[o("DatePicker",{attrs:{type:"date",placeholder:"开始时间",disabled:""},model:{value:e.validEnd,callback:function(o){t.$set(e,"validEnd",o)},expression:"item.validEnd"}})],1),o("Col",{staticClass:"discount-table-content",attrs:{span:"5"}},["1"==e.tacticsType?o("Input",{attrs:{placeholder:"折扣",number:t.inputNumberType},on:{"on-blur":t.changezhekou},model:{value:e.discount,callback:function(o){t.$set(e,"discount",o)},expression:"item.discount"}}):t._e(),"1"!==e.tacticsType?o("Input",{attrs:{disabled:""},model:{value:e.zhekou,callback:function(o){t.$set(e,"zhekou",o)},expression:"item.zhekou"}}):t._e()],1)],1)],1)}),o("Row",{staticStyle:{"margin-bottom":"10px"}},[o("Col",{attrs:{sapn:"24"}},[t.formItem.items.length&&t.showSaleDiv?o("div",{staticClass:"total-money"},[o("span",[t._v("优惠金额总计")]),o("span",{staticClass:"money"},[t._v(t._s(t._f("thousand")(t.saleAmount))+" ")]),o("span",{staticClass:"money"},[t._v(t._s(t.saleAmounts))])]):t._e()])],1)],2),o("div",{staticStyle:{"padding-left":"24px"}},[o("Row",[o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"优惠后服务费总额"}},[o("Input",{attrs:{placeholder:"优惠后服务费总额",disabled:""},model:{value:t.formItem.rentAmount,callback:function(e){t.$set(t.formItem,"rentAmount",e)},expression:"formItem.rentAmount"}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"首付款日期",prop:"firstPayTime"}},[o("DatePicker",{staticStyle:{width:"252px"},attrs:{type:"date",placeholder:"首付款日期"},model:{value:t.formItem.firstPayTime,callback:function(e){t.$set(t.formItem,"firstPayTime",e)},expression:"formItem.firstPayTime"}})],1)],1)],1),o("Row",{},[o("Col",{staticClass:"col"},[o("span",{staticClass:"required-label",staticStyle:{width:"252px",padding:"11px 12px 10px 0",color:"#666",display:"block"}},[t._v("付款方式")]),o("div",{staticStyle:{display:"block","min-width":"252px"}},t._l(t.payList,function(e){return o("span",{key:e.value,staticClass:"button-list",class:{active:t.installmentType==e.value},on:{click:function(o){t.selectPayType(e.value)}}},[t._v(t._s(e.label))])})),t.errorPayType?o("div",{staticClass:"pay-error"},[t._v("请选择付款方式")]):t._e()]),o("Col",{staticClass:"col",staticStyle:{"max-width":"560px"}},[o("span",{staticClass:"required-label",staticStyle:{width:"252px",padding:"11px 12px 10px 0",color:"#666",display:"block"}},[t._v("履约保证金总额")]),o("div",{staticStyle:{display:"block","min-width":"252px"}},t._l(t.depositList,function(e){return o("span",{key:e.value,staticClass:"button-list",class:{active:t.depositAmount==e.value},on:{click:function(o){t.selectDeposit(e.value)}}},[t._v(t._s(e.label))])})),t.errorAmount?o("div",{staticClass:"pay-error"},[t._v("请选择履约保证金总额")]):t._e()])],1)],1),o("FormItem",{staticStyle:{"padding-left":"24px","margin-top":"40px"}},[t.disabled?t._e():o("Button",{attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){t.handleSubmit("formItem")}}},[t._v("提交")]),t.disabled?o("Button",{attrs:{disabled:""}},[t._v("提交")]):t._e()],1)],1),o("Modal",{attrs:{title:"选择工位","ok-text":"保存","cancel-text":"取消",width:"90%","class-name":"vertical-center-modal"},model:{value:t.openStation,callback:function(e){t.openStation=e},expression:"openStation"}},[t.openStation?o("planMap",{attrs:{floors:t.floors,params:t.params,stationData:t.stationData},on:{"update:floors":function(e){t.floors=e},"update:params":function(e){t.params=e},"update:stationData":function(e){t.stationData=e},"on-result-change":t.onResultChange}}):t._e(),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"primary"},on:{click:t.submitStation}},[t._v("确定")])],1)],1),o("Modal",{attrs:{title:"填写单价","ok-text":"保存","cancel-text":"取消","class-name":"vertical-center-modal"},model:{value:t.openPrice,callback:function(e){t.openPrice=e},expression:"openPrice"}},[t.openPrice?o("div",[o("span",{staticStyle:{display:"inline-block",height:"32px","line-height":"32px"}},[t._v(" 工位单价： ")]),o("Input",{staticStyle:{width:"150px"},attrs:{placeholder:"工位单价"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}}),t.priceError?o("span",{staticStyle:{display:"block",height:"32px","line-height":"32px",color:"red"}},[t._v(t._s(t.priceError))]):t._e()],1):t._e(),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"primary"},on:{click:t.submitPrice}},[t._v("确定")]),o("Button",{on:{click:t.cancelPrice}},[t._v("取消")])],1)])],1)},n=[],i={render:a,staticRenderFns:n};e.a=i},e0mU:function(t,e,o){"use strict";var a=o("9Jg8");e.a={props:{onchange:Function,value:String,disabled:Boolean,labelInValue:{default:!1,type:Boolean},url:{type:String,default:"get-customer"}},data:function(){return{customer:"",loading1:!1,customerOptions:[]}},mounted:function(){this.remoteCustomer()},methods:{changeContent:function(t){this.onchange(t)},remoteCustomer:function(t){var e=this;this.loading1=!0,setTimeout(function(){e.getCusomerList(t)},200)},getCusomerList:function(t){var e={company:t||""},o=[],n=this;return a.a.get(this.url,e,function(t){o=t.data.customerList,o.map(function(t){var e=t;return e.label=t.company,e.value=t.id+"",e}),n.loading1=!1,n.customerOptions=o},function(t){console.log("error---\x3e",t)}),o}}}},e4V2:function(t,e,o){"use strict";o("9Jg8");e.a={props:["onchange","test","value","disabled"],data:function(){return{community:"",loading1:!1,options1:[],labelInValue:!0,clearable:!0}},mounted:function(){this.getCusomerList(" ")},methods:{changeContent:function(t){this.onchange(t)},remoteMethod1:function(t){var e=this;""!==t?(this.loading1=!0,setTimeout(function(){e.loading1=!1,e.getCusomerList(t)},200)):this.getCusomerList(" ")},getCusomerList:function(t){var e=this,o=[],a=this;this.$http.get("join-bill-community","").then(function(t){o=t.data.items,o.map(function(t){var e=t;return e.label=t.name,e.value=t.id+"",e}),a.loading1=!1,a.options1=o}).catch(function(t){e.$Notice.error({title:t.message})})}}}},ev4r:function(t,e,o){var a=o("+nse");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("19ee93de",a,!0,{sourceMap:!1})},gJbB:function(t,e,o){"use strict";var a=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"com-select-chance"},[o("Select",{attrs:{filterable:"",clearable:t.clearable,placeholder:t.placeholder,loading:t.loading1,disabled:t.disabled,"label-in-value":t.labelinvalue},on:{"on-change":t.changeContent},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.salerOptions,function(e){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)},n=[],i={render:a,staticRenderFns:n};e.a=i},gnYt:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,'.u-clearfix{zoom:1}.u-clearfix:after{clear:both;content:".";height:0;display:block;visibility:hidden}.left{float:left}.ui-detail-layout{padding:0 24px;font-size:14px;color:#333;line-height:14px}.ui-detail-layout .ui-content-title{margin-bottom:24px}.ui-detail-layout .ui-circle{font-weight:700}.ui-detail-layout .ui-circle:before{content:"";width:7px;height:7px;display:inline-block;border:1px solid #333;border-radius:100% 100%;margin-right:6px;vertical-align:middle;margin-top:-3px}',""])},lNj5:function(t,e,o){var a=o("gnYt");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("65d89b4e",a,!0,{sourceMap:!1})},nnyj:function(t,e,o){var a=o("sj7E");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("18e4c826",a,!0,{sourceMap:!1})},"o/MA":function(t,e,o){"use strict";var a=o("9Jg8");e.a={props:{defaultValue:0,clearable:{type:Boolean,default:!1},placeholder:"请选择",orderitems:{type:Object}},data:function(){return{labelinvalue:!0,disabled:!1,saler:"",loading1:!1,salerOptions:[{label:"请选择",value:0},{label:"无需机会",value:-1}]}},computed:{value:{get:function(){return this.defaultValue},set:function(t){}}},watch:{salerOptions:function(){var t=Number(this.orderitems.saleChanceId);this.disabled=!(0==t||!t)},orderitems:function(){this.getSalerChanceList()}},methods:{changeContent:function(t){var e=void 0;e="请选择"===t.label||"无需机会"==t.label?"":t.value,this.$emit("onChange",e)},getSalerChanceList:function(){var t=this,e={customerId:this.orderitems.customerId,communityId:this.orderitems.communityId,receiveId:this.orderitems.salerId};if(e.customerId&&e.communityId&&e.receiveId){var o=[],n=this;a.a.get("get-salechance",e,function(e){e.data.items.data.map(function(t){o.push({label:t.name,value:t.id})}),o.unshift({label:"无需机会",value:-1}),n.salerOptions=o;var a={count:o.length-1,isNewUser:e.data.items.isNewUser,list:o};t.$emit("gotChanceList",a)},function(e){t.$Notice.error({title:e.message})})}}}}},oNwR:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".plan-map-content{width:100%}",""])},p1B2:function(t,e,o){"use strict";function a(t){o("51Ub")}var n=o("4XX8"),i=o("Ds1f"),r=o("VU/8"),s=a,l=r(n.a,i.a,!1,s,null,null);e.a=l.exports},pY0k:function(t,e,o){var a=o("Ucgj");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);o("rjj0")("f811f5dc",a,!0,{sourceMap:!1})},qehU:function(t,e,o){"use strict";function a(t){o("JnUb")}var n=o("e0mU"),i=o("+H/r"),r=o("VU/8"),s=a,l=r(n.a,i.a,!1,s,null,null);e.a=l.exports},sj7E:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".com-select-chance ::-webkit-input-placeholder{color:#666}.com-select-chance ::-moz-placeholder{color:#666}.com-select-chance :-ms-input-placeholder{color:#666}.com-select-chance input:-moz-placeholder{color:#666}",""])},syeK:function(t,e,o){"use strict";function a(t){if(null===t||void 0===t)return 0;if(isNaN(t))return"NaN";var e=t.toString();if(/^-?\d+\.?\d+$/.test(e))if(/^-?\d+$/.test(e))e=e.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");else{var o=e.split("."),a=o[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");e=a+"."+o[1]}return e}e.a=a},tBD1:function(t,e,o){"use strict";e.a={props:{title:String,type:{default:"listTitle",type:String}},data:function(){return{classType:{listTitle:"section-title",detailTitle:"section-detail-title"}}}}},u9UO:function(t,e,o){"use strict";var a=o("woOf"),n=o.n(a),i=o("mvHQ"),r=o.n(i),s=o("J0i4"),l=o("77Yh"),c=o("qehU"),u=o("K+LH"),p=o("VSp2"),d=o("yWLh"),h=o("p1B2"),m=o("g4Hp"),f=o.n(m),g=o("NVoV"),v=(o.n(g),o("bsze"));e.a={data:function(){var t=this,e=function(e,o,a){""===o?a(new Error("请先选择首付款日期")):new Date(t.formItem.startDate)<new Date(o)?a(new Error("首付款日期不得晚于起始日期")):a()};return{defaultChanceID:0,opportunityTipStr:"您没有可用的机会，请确认登录账户或前往CRM检查",OpportunityRequired:!0,showChanceSelector:!0,orderitems:{},test:"test",showSaleChance:!1,showFree:!1,openStation:!1,inputNumberType:!0,selectAll:!1,discountError:!1,index:0,depositAmount:"",disabled:!1,delStation:[],stationAmount:"",installmentType:"",maxDiscount:{},timeError:!1,stationData:{submitData:[],deleteData:[],clearAll:!1},stationAll:{},payList:[{value:"ONE",label:"月付"},{value:"TWO",label:"两月付"},{value:"THREE",label:"季付"},{value:"SIX",label:"半年付"},{value:"TWELVE",label:"年付"},{value:"ALL",label:"全款"}],params:{},depositList:[{label:"2个月",value:"2"},{label:"3个月",value:"3"},{label:"4个月",value:"4"},{label:"5个月",value:"5"},{label:"6个月",value:"6"}],saleAmount:0,saleAmounts:v.a.smalltoBIG(0),youhui:[],columns4:[{type:"selection",width:60,align:"center"},{title:"工位房间编号",key:"name"},{title:"类型",key:"seatType",render:function(t,e){var o=e.row.seatType;return"SPACE"==o?"独立办公室":"开放工位"}},{title:"工位可容纳人数",key:"capacity"},{title:"定价",key:"guidePrice"},{title:"标准单价（元/月）",key:"guidePrice",render:function(e,o){var a=o.row.originalPrice;return e("Input",{props:{min:o.row.guidePrice,value:o.row.originalPrice},on:{"on-change":function(t){var e=t.target.value;isNaN(e)&&(e=o.row.guidePrice),a=e},"on-blur":function(){var e=/^[0-9]+(.[0-9]{1,2})?$/;if(a&&!e.test(a)){t.$Notice.error({title:"单价不得多余小数点后两位"});var n=Number(a).toFixed(3);a=n.substring(0,n.lastIndexOf(".")+3)}a<o.row.guidePrice&&(a=o.row.guidePrice,t.$Notice.error({title:"单价不得小于"+o.row.guidePrice})),t.changePrice(o.index,a)}}},"44")}},{title:"租赁期限",key:"address",render:function(e,o){return e("strong",f.a.dateToStr("YYYY-MM-DD",new Date(t.formItem.startDate))+"至"+f.a.dateToStr("YYYY-MM-DD",new Date(t.formItem.endDate)))}},{title:"小计",key:"originalAmount",render:function(t,e){return v.a.thousand(e.row.originalAmount)}}],stationList:[],floors:[],selectedStation:[],formItem:{customerId:"",communityId:"",startDate:f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date),signDate:f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date),endDate:"",timeRange:"",floor:"",city:"",firstPayTime:"",rentAmount:"",items:[],stationAmount:0,saleChanceId:""},errorPayType:!1,ruleCustom:{startDate:[{required:!0,type:"date",message:"请先选择开始时间",trigger:"change"}],firstPayTime:[{required:!0,trigger:"change",validator:e}],endDate:[{required:!0,type:"date",message:"请先选择结束时间",trigger:"change"}],endDateStatus:[{required:!0,type:"date",message:"请先选择结束时间",trigger:"change"}],communityId:[{required:!0,message:"请选择社区",trigger:"change"}],customerId:[{required:!0,message:"请选择客户",trigger:"change"}],salerId:[{required:!0,message:"请选择销售员",trigger:"change"}],signDate:[{required:!0,type:"date",message:"请先选择签署时间",trigger:"change"}]},getFloor:+new Date,changeSale:+new Date,salerName:"请选择",ssoId:"",errorAmount:!1,ssoName:"",discount:0,minDiscount:"",change:{},showSaleDiv:!0,openPrice:!1,price:"",priceError:!1,priceToStation:[]}},head:function(){return{title:"新建订单"}},components:{SectionTitle:s.a,selectCommunities:l.a,DetailStyle:d.a,selectCustomers:c.a,SelectSaler:u.a,planMap:h.a,SelectChance:p.a},mounted:function(){GLOBALSIDESWITCH("false"),this.getFreeDeposit()},watch:{getFloor:function(){var t=this;if(this.config(),this.formItem.communityId&&this.formItem.customerId){var e={communityId:this.formItem.communityId,customerId:this.formItem.customerId};this.$http.get("get-community-floor",e,function(e){t.floors=e.data.floor,t.ssoId=e.data.ssoId,t.ssoName=e.data.ssoName,t.formItem.salerId||(t.formItem.salerId=r()(e.data.ssoId),t.salerName=e.data.ssoName,t.validSaleChance())},function(e){t.$Notice.error({title:e.message})})}},disabled:function(t){console.log("disabled--\x3e",t)}},methods:{submitPrice:function(){var t=this,e=!1,o=this,a=this.stationList;/^[0-9]+(.[0-9]{1,2})?$/.test(this.price)||(e="工位单价不得多于三位小数");var n=this.selectedStation;a=a.filter(function(t,e){return-1!=n.indexOf(t.seatId)}),a.map(function(o){o.guidePrice>t.price&&(e="工位单价不得小于"+o.guidePrice)}),e?this.priceError=e:(this.priceError=!1,this.openPrice=!this.openPrice,this.stationList=this.stationList.map(function(t){return-1!=n.indexOf(t.seatId)&&(t.originalPrice=Number(o.price)),t}),this.selectedStation=[],this.getStationAmount())},openPriceButton:function(){this.stationList;if(!this.selectedStation.length)return void this.$Notice.error({title:"请先选择录入单价的工位"});this.openPrice=!this.openPrice},cancelPrice:function(){this.openPrice=!this.openPrice,this.priceError=!1,this.price=""},changePrice:function(t,e,o){this.stationList[t].originalPrice=e,this.getStationAmount()},config:function(){this.$Notice.config({top:80,duration:3})},back:function(){window.history.go(-1)},joinFormSubmit:function(){this.config();var t=this.stationList,e=!1;if(t.map(function(t){t.originalPrice<t.guidePrice&&(e=!0)}),e)return void this.$Notice.error({title:"工位单价不得小于最低定价"});var o=!1;if(t.map(function(t){""===t.originalPrice&&(o=!0)}),o)return void this.$Notice.error({title:"工位单价不得为空。"});var a=this.formItem.items.filter(function(t){return!!t.show});if("complete"!=this.dealSaleInfo(!0)){var i=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(this.formItem.startDate)),s=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(this.formItem.signDate||new Date)),l=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(this.formItem.endDate||this.formItem.endDateStatus)),c={};a=a.map(function(t){var e=n()({},t);return 3==t.tacticsType?e.validStart=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.startDate)):e.validStart=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.validStart)),e.validEnd=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.validEnd)),e}),c.installmentType=this.installmentType,c.deposit=this.depositAmount,c.saleList=r()(a),c.seats=r()(this.stationList),c.customerId=this.formItem.customerId,c.communityId=this.formItem.communityId,c.salerId=this.formItem.salerId,c.opportunityId=this.formItem.saleChanceId,c.signDate=s,c.timeRange=this.formItem.timeRange,c.rentAmount=this.formItem.rentAmount,c.firstPayTime=f.a.dateToStr("YYYY-MM-dd 00:00:00",this.formItem.firstPayTime),c.startDate=i,c.endDate=l,c.ssoId=this.ssoId,c.ssoName=this.ssoName;var u=this;this.disabled=!0,this.$http.post("save-join",c).then(function(t){window.location.href="/order-center/order-manage/station-order-manage/"+t.data.orderSeatId+"/joinView"}).catch(function(t){u.$Notice.error({title:t.message}),setTimeout(function(){u.disabled=!1},500),console.log("error",t)})}},dealSaleInfo:function(t){var e=this;this.config();var o=this.formItem.items.filter(function(t){return!!t.show}),a=!0,i=!0;if(o.map(function(t){"1"==t.tacticsType&&e.discount&&(t.discount=e.discount),t.tacticsType||(a=!1),"3"!=t.tacticsType||t.startDate&&t.validEnd||(a=!1),"1"!=t.tacticsType||t.discount?i=e.dealzhekou(t.discount||e.discount):a=!1}),!a&&t)return this.$Notice.error({title:"请填写完整优惠信息"}),this.discountError="请填写完整优惠信息","complete";(a||t)&&(i||t)&&(o.length?this.showSaleDiv=!0:this.showSaleDiv=!1,o=o.map(function(t){var e=n()({},t);return"3"==t.tacticsType?e.validStart=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.startDate)):e.validStart=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.validStart)),e.validEnd=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.validEnd)),e}),this.getSaleAmount(o))},getSaleAmount:function(t){var e=this;this.config();var o={communityId:this.formItem.communityId,leaseBegindate:f.a.dateToStr("YYYY-MM-dd 00:00:00",this.formItem.startDate),leaseEnddate:f.a.dateToStr("YYYY-MM-dd 00:00:00",this.formItem.endDate),seats:r()(this.stationList),saleList:r()(t)},a=this;a.disabled=!1,a.discountError=!1,this.$http.post("count-sale",o,function(t){a.stationList=t.data.seats;var o=e.formItem.stationAmount-t.data.totalrent;a.saleAmount=Math.round(100*o)/100,a.saleAmounts=v.a.smalltoBIG(Math.round(100*o)/100),a.formItem.rentAmount=t.data.totalrent},function(t){a.stationList.length&&(a.disabled=!0,a.discountError=t.message,a.$Notice.error({title:t.message}))})},changezhekou:function(t){var e=t.target.value;if(e){if(e=e.replace(/\s/g,""),!/^(\d|[0-9])(\.\d)?$/.test(e))return this.discountError="折扣只能为一位小数或整数",this.disabled=!0,void this.$Notice.error({title:"折扣只能为一位小数或整数"});if(isNaN(e))return this.discountError="折扣必须是数字",void(this.disabled=!0);if(e<this.minDiscount)return this.discountError="折扣不得小于"+this.minDiscount,this.disabled=!0,void this.$Notice.error({title:"折扣不得小于"+this.minDiscount});if(e>9.9)return this.discountError="折扣不得大于9.9",this.disabled=!0,void this.$Notice.error({title:"折扣不得大于9.9"});this.discount=e,this.dealSaleInfo(!1)}},changeSaleTime:function(t){var e=this;setTimeout(function(){e.dealSaleInfo(!0)},200)},handleSubmit:function(t){var e=this;this.$Notice.config({top:80,duration:3});var o=this;if(this.installmentType||(this.errorPayType=!0),this.depositAmount||(this.errorAmount=!0),this.timeError)return void this.$Notice.error({title:"租赁开始时间不得大于结束时间"});this.$refs[t].validate(function(t){if(t){if(e.errorPayType||e.errorAmount)return void e.$Notice.error({title:"请填写完表单"});if(!o.stationList.length)return o.$Notice.error({title:"请选择入驻工位"}),void(o.disabled=!1);e.joinFormSubmit()}else o.disabled=!1,e.$Notice.error({title:"请填写完表单"})})},selectDiscount:function(t){var e=this.formItem.items;e=e.map(function(e){var o=e;return o.select=t,o}),this.selectAll=t,this.formItem.items=e},deleteDiscount:function(){var t=this.formItem.items;t.map(function(t){return t.selelct}),t=t.map(function(t,e){return t.select&&(t.show=!1),t}),this.formItem.items=t,this.discount="",this.selectDiscount(!1),this.dealSaleInfo(!0)},getTacticsId:function(t){var e="";return e=this.youhui.filter(function(e){return e.tacticsName==t}),e[0].tacticsId},dealzhekou:function(t){return!!t&&(isNaN(t)?(this.discountError="折扣必须是数字",this.disabled=!0,!1):t<this.minDiscount?(this.discountError="折扣不得小于"+this.minDiscount,this.disabled=!0,this.$Notice.error({title:"折扣不得小于"+this.minDiscount}),!1):!(t>9.9)||(this.discountError="折扣不得大于9.9",this.disabled=!0,this.$Notice.error({title:"折扣不得大于9.9"}),!1))},changeType:function(t){var e=this;if(t){var o=t.label,a=t.value;this.config();var n=a.split("/")[0],i=a.split("/")[1],r=a.split("/")[2],s=a.split("/")[3];this.formItem.items[i].tacticsType=n,this.formItem.items[i].tacticsName=r,this.formItem.items[i].tacticsId=s;var l=[];l=this.formItem.items.map(function(t){return"qianmian"==t.value?(t.validStart=e.formItem.startDate,t.discount=""):3==t.tacticsType&&t.show?(t.validStart=t.startDate||"",t.validEnd=e.formItem.endDate,t.tacticsId=t.tacticsId||s,t.discount=""):1==t.tacticsType&&t.show&&(t.validStart=e.formItem.startDate,t.tacticsId=t.tacticsId||s,t.discount=t.discount||"",t.validEnd=e.formItem.endDate),t});var c=!1,u="",p=l.map(function(t){return t.show?t.tacticsType:void 0}),d=p.join(",").split("qianmian").length-1,h=p.join(",").split("3").length-1,m=p.join(",").split("1").length-1;if(d+h>1&&(c=!0,u="只能有一个免租期。"),m>1&&(c=!0,u="只能有一个折扣。"),c)return this.$Notice.error({title:u}),l[i].show=!1,void(this.formItem.items=l);1==n&&(this.minDiscount=this.maxDiscount[o]),this.formItem.items=l,this.dealSaleInfo(!1)}},changeCommunity:function(t){t?(this.formItem.communityId=t,this.getSaleTactics({communityId:t})):this.formItem.communityId="",this.clearStation(),this.getFloor=+new Date,this.validSaleChance()},clearStation:function(){this.stationList.length&&(this.stationData={submitData:[],deleteData:[]},this.stationList=[],this.formItem.items=[],this.formItem.rentAmount="0"),this.formItem.items.length&&(this.formItem.items=[],this.saleAmount=0,this.saleAmounts=v.a.smalltoBIG(0)),this.discountError&&(this.discountError=!1,this.disabled=!1)},changeCustomer:function(t){this.formItem.customerId=t||"",this.getFloor=+new Date,this.validSaleChance()},changeSaler:function(t){this.formItem.salerId=t,this.validSaleChance()},changeChance:function(t){this.formItem.saleChanceId=t&&0!==t&&-1!=t?t:"",console.log(this.formItem.saleChanceId)},handleGotChancelist:function(t){t.isNewUser?t.count>=1?(this.showChanceSelector=!0,this.defaultChanceID=t.list[1].value):(this.showChanceSelector=!1,this.OpportunityRequired=!0,this.opportunityTipStr="您没有可用的机会，请确认登录账户或前往CRM检查"):0==t.count&&(this.showChanceSelector=!1,this.OpportunityRequired=!1,this.opportunityTipStr="您没有可用机会，客户增租续租时不必须")},validSaleChance:function(){this.showSaleChance=this.formItem.salerId&&this.formItem.customerId&&this.formItem.communityId;var t={};t.customerId=this.formItem.customerId,t.communityId=this.formItem.communityId,t.salerId=this.formItem.salerId,this.orderitems=n()({},t)},deleteStation:function(){var t=this.stationList,e=this.selectedStation;t=t.filter(function(t,o){return-1==e.indexOf(t.seatId)}),this.getStationAmount(t),this.formItem.items=[]},showStation:function(){if(this.config(),!this.formItem.communityId)return void this.$Notice.error({title:"请先选择社区"});if(!this.formItem.customerId)return void this.$Notice.error({title:"请先选择客户"});if(!this.formItem.startDate)return void this.$Notice.error({title:"请先选择开始时间"});if(!this.formItem.endDate)return void this.$Notice.error({title:"请先选择结束时间"});var t=this.floors.map(function(t){return t.value}),e={floor:t.join(","),communityId:this.formItem.communityId,mainBillId:null,startDate:f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(this.formItem.startDate)),time:+new Date,endDate:f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(this.formItem.endDate))};this.openStation=!0,this.params=e},selectRow:function(t){var e=[];e=t.map(function(t){return t.seatId}),this.selectedStation=e},handleAdd:function(){if(this.config(),this.showSaleDiv=!0,!this.stationList.length)return void this.$Notice.error({title:"请先选择工位"});this.index++,this.formItem.items.push({value:"",index:this.index,status:1,show:!0,discount:""})},selectDeposit:function(t){this.depositAmount=t,this.errorAmount=!1},selectPayType:function(t){this.installmentType=t,this.errorPayType=!1},submitStation:function(){this.stationList=this.stationData.submitData||[],this.delStation=this.stationData.deleteData||[],this.getStationAmount(),this.openStation=!1,this.clearSale()},clearSale:function(){this.formItem.items=[],this.saleAmounts=v.a.smalltoBIG(0),this.formItem.saleAmount=0},onResultChange:function(t){console.log("onResultChange",t),this.stationData=t},cancelStation:function(){this.stationData={submitData:this.stationList,deleteData:[]},this.openStation=!1},changeBeginTime:function(t){if(this.clearStation(),t&&this.formItem.endDate){var e=!1;this.config(),t=f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(t));var o={end:f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(this.formItem.endDate)),start:t};new Date(t)>new Date(this.formItem.endDate)?(e=!0,this.$Notice.error({title:"租赁开始时间不得大于结束时间"})):this.contractDateRange(o),this.timeError=e}},dealEndDate:function(t){var e=t.split("-"),o=e[0],a=parseInt(e[1],10);return t=o+"-"+a+"-"+new Date(o,a,0).getDate()},changeEndTime:function(t){if(this.clearStation(),t){t=this.dealEndDate(t);var e=!1;if(t=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t)),this.formItem.endDate=t,this.formItem.startDate){var o={start:f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(this.formItem.startDate)),end:t};this.config(),new Date(this.formItem.startDate)>new Date(t)?(e=!0,this.$Notice.error({title:"租赁开始时间不得大于结束时间"})):this.contractDateRange(o),this.timeError=e,this.clearStation()}}},changeEndDateStatus:function(t){if(this.clearStation(),t){var e=!1;if(t=f.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t)),this.formItem.endDate=t,this.formItem.startDate){var o={start:f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(this.formItem.startDate)),end:t};this.config(),new Date(this.formItem.startDate)>=new Date(t)?(e=!0,this.$Notice.error({title:"租赁开始时间不得大于等于结束时间"})):this.contractDateRange(o),this.timeError=e,this.clearStation()}}},contractDateRange:function(t){var e=this;this.config(),this.$http.get("contract-date-range",t).then(function(t){e.formItem.timeRange=t.data}).catch(function(t){e.$Notice.error({title:t.message}),console.log("error",t)})},getSaleTactics:function(t){var e=[],o={},a=this;this.$http.get("sale-tactics",t,function(t){e=t.data.length?t.data.map(function(t){var e=t;return e.label=t.tacticsName,e.value=t.tacticsType+"",e.id=t.tacticsId,e.name=t.tacticsName,1==t.tacticsType&&(o[t.tacticsName]=e.discount),e}):[],a.youhui=e,a.maxDiscount=o},function(t){a.youhui=[],console.log("error",t)})},getStationAmount:function(t){var e=this;this.config();var o=!1,a=t||this.stationList,n=a.map(function(t){var a=t;return a.guidePrice=t.guidePrice||t.seatPrice||0,a.originalPrice=t.originalPrice||0===t.originalPrice||0!=a.guidePrice?t.originalPrice||a.guidePrice:"",a.seatId=t.id||t.seatId,a.floor=t.whereFloor||t.floor,a.endDate=f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(e.formItem.endDate)),a.startDate=f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(e.formItem.startDate)),""===t.originalPrice&&(o=!0),a});if(!o){var i={leaseEnddate:f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(this.formItem.endDate)),leaseBegindate:f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(this.formItem.startDate)),communityId:this.formItem.communityId,seats:r()(n)},s=this;this.$http.post("get-station-amount",i).then(function(t){s.stationList=t.data.seats.map(function(t){var e=t;return e.guidePrice=t.guidePrice,e.startDate=f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(t.startDate)),e.endDate=f.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(t.endDate)),e.belongType=t.seatType,e}),s.stationData.submitData=s.stationList,s.formItem.rentAmount=t.data.totalrent,s.formItem.stationAmount=t.data.totalrent,s.stationAmount=v.a.smalltoBIG(t.data.totalrent),s.selectedStation=[],s.showSaleDiv&&s.dealSaleInfo(!1)}).catch(function(t){s.$Notice.error({title:t.message})})}},getFreeDeposit:function(){var t=this;this.$http.get("get-seat-deposit-free","").then(function(e){t.showFree=e.data,e.data&&(t.depositList.push({value:"0",label:"无押金"}),t.depositList.push({value:"1",label:"1个月"}))}).catch(function(e){t.$Notice.error({title:e.message})})}}}},yWLh:function(t,e,o){"use strict";function a(t){o("lNj5")}var n=o("4O/J"),i=o("NpwQ"),r=o("VU/8"),s=a,l=r(n.a,i.a,!1,s,null,null);e.a=l.exports}});
//# sourceMappingURL=join.73a1b37eccb7ff89d9c2.js.map