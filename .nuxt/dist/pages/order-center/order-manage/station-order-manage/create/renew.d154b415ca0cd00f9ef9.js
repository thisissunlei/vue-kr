webpackJsonp([17,155],{"+2UJ":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"station-list"},[o("div",{staticClass:"station-type"},[t._v(t._s(t.label))]),o("div",t._l(t.stationList,function(e,n){return o("div",{staticStyle:{"margin-bottom":"20px"}},[o("div",{key:n,staticStyle:{"border-bottom":"1px solid #e9e9e9","padding-bottom":"6px","margin-bottom":"6px"}},[o("Checkbox",{key:e.name,attrs:{value:t.checkAll["seat"+n]},on:{"on-change":t.selectDiscount},nativeOn:{click:function(e){e.preventDefault(),t.handleCheckAll(n)}}},[t._v("全选    租赁结束日期："+t._s(e.name))])],1),o("div",{staticClass:"checkbox-list"},t._l(e.value,function(e,i){return o("Checkbox",{key:e.name,attrs:{value:t.selectSeat["seat"+n+e.name]},nativeOn:{click:function(o){o.preventDefault(),t.selectDiscount(n,e.name)}}},[t._v(t._s(e.name))])}))])}))])},i=[],a={render:n,staticRenderFns:i};e.a=a},"+H/r":function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"com-select-customers"},[o("Select",{attrs:{"v-model":t.customer,filterable:"",remote:"",placeholder:t.value,"remote-method":t.remoteCustomer,loading:t.loading1,disabled:t.disabled,"label-in-value":t.labelInValue},on:{"on-change":t.changeContent}},t._l(t.customerOptions,function(e,n){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)},i=[],a={render:n,staticRenderFns:i};e.a=a},"+nse":function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".com-select-community ::-webkit-input-placeholder{color:#666}.com-select-community ::-moz-placeholder{color:#666}.com-select-community :-ms-input-placeholder{color:#666}.com-select-community input:-moz-placeholder{color:#666}",""])},"3W/U":function(t,e,o){"use strict";var n=o("g4Hp");o.n(n);e.a={props:{label:{type:String,required:!0},stationList:{type:Array,required:!0}},data:function(){var t={},e={};return this.stationList.map(function(o,n){return t["seat"+n]=!1,o.value.map(function(t){t.begin=t.begin||t.endDate,e["seat"+n+t.name]=!1}),o}),{checkAll:t,selectSeat:e,selectionIndex:[]}},components:{},watch:{selectionIndex:function(){var t=[],e=[],o="";for(var n in this.selectSeat)this.selectSeat[n]&&(t.push(n.slice(5)),o=n.slice(4,5));this.stationList.map(function(n,i){o==i&&(e=n.value.filter(function(e,o){return-1!=t.indexOf(e.name)}),console.log("filter",e))}),console.log("on-station-change",e),this.$emit("on-station-change",e)}},created:function(){},methods:{checkAllSelect:function(){var t=!1;for(var e in this.checkAll)this.checkAll[e]&&(t=!0);return t},handleCheckAll:function(t){var e=this;if(this.checkAll["seat"+t])this.checkAll["seat"+t]=!1,this.clearAllCheck();else{var o=this.checkAllSelect();if(o)return this.$Notice.error({title:"工位原结束时间不同，不可同时进行续租"}),this.clearAllCheck(),!1;console.log("checkAllSelect",o),this.clearAllCheck(),this.checkAll["seat"+t]=!0}if(this.checkAll["seat"+t]){this.stationList[t].value.map(function(o){return e.selectionIndex.push(t),o.name}).map(function(o){e.selectSeat["seat"+t+o]=!0})}},clearAllCheck:function(){var t={},e={};this.stationList.map(function(o,n){t["seat"+n]=!1,o.value.map(function(t){e["seat"+n+t.name]=!1})}),this.checkAll=t,this.selectSeat=e,this.selectionIndex=[]},selectDiscount:function(t,e){if(this.selectSeat["seat"+t+e]){this.selectSeat["seat"+t+e]=!1;var o=[];for(var n in this.selectSeat)this.selectSeat[n]&&o.push(n.slice(4,5));if(this.selectionIndex=o,o.length){this.getDiffStation()}else this.clearAllCheck()}else{this.selectionIndex.push(t);if(!this.getDiffStation())return;this.selectSeat["seat"+t+e]=!0}},getDiffStation:function(){var t=this.selectionIndex[0],e=this.selectionIndex,o=e.join(",").split(t).length-1;return o!=e.length?(this.$Notice.error({title:"工位原结束时间不同，不可同时进行续租"}),this.clearAllCheck(),!1):(o==e.length&&this.stationList[t].value.length==e.length?this.checkAll["seat"+t]=!0:this.checkAll["seat"+t]=!1,!0)}}}},"4O/J":function(t,e,o){"use strict";e.a={name:"detailStyle",props:["info"]}},"4XX8":function(t,e,o){"use strict";var n=o("woOf"),i=o.n(n),a=o("Rrep"),r=o("9Jg8");e.a={props:{params:Object,floors:Array,stationData:Object,originStationList:Array},data:function(){return console.log("this.stationData.submitData",this.stationData.submitData),{data:"",selectedObjs:this.stationData.submitData,deleteArr:[],newfloor:"3",submitData:[],scaleNumber:60,Map:"",inputEnd:"",inputStart:"",originData:[],floor:"",startToEnd:[],origin:this.originStationList,showSlider:!0,stationArr:this.stationData,page:{},stylePlan:{}}},destroyed:function(){},mounted:function(){this.getData(),this.getPageWidthOrHeight()},updated:function(){},beforeUpdate:function(){},watch:{stationData:function(t){this.selectedObjs=this.stationData.submitData},originStationList:function(t){this.origin=t},stationArr:function(t){this.$emit("on-result-change",t),this.inputStart="",this.inputEnd=""},startToEnd:function(t){var e=this.stationArr,o=e.submitData,n=e.deleteData;o=o.concat(t),this.stationArr={deleteData:n,submitData:o}}},methods:{getPageWidthOrHeight:function(){var t={};t.width=window.innerWidth,t.height=window.innerHeight,"CSS1Compat"==document.compatMode?(t.width=document.documentElement.clientWidth,t.height=document.documentElement.clientHeight):(t.width=document.body.clientWidth,t.height=document.body.clientHeight),this.page=i()({},t),this.stylePlan={width:"100%",height:t.height-200+"px",border:"1px solid #000"}},getData:function(){var t=this,e=this.params,o=[],n=this;r.a.get("getplanmap",e,function(e){var i=e.data,a=[],r={},s=[];i.map(function(t,e){var n=[];a.push({value:""+t.floor,label:""+t.floor}),t.figures.map(function(t,e){for(var i=0;i<o.length;i++){var a="STATION";if(2==o[i].belongType&&(a="SPACE"),t.belongId==o[i].id&&t.belongType==a){var r={};r.name=t.cellName,r.whereFloor=t.floor,r.belongType=t.belongType,r.belongId=Number(t.belongId),n.push(r)}}if(0==o.length&&t.status&&3==t.status){var r={};r.name=t.cellName,r.whereFloor=t.floor,r.belongType=t.belongType,r.belongId=Number(t.belongId),s.push(r),n.push(r)}}),r["a"+t.floor]=[].concat(n)},function(t){n.$Notice.error({title:t.message})}),t.data=i,t.newfloor=a[0].value,t.canvasEles()})},canvasEles:function(){var t=this,e={},o=Number(this.inputStart),n=Number(this.inputEnd),i=this.data,r=this.newfloor,s=this.selectedObjs;console.log("渲染",s);for(var l=[],c=this.origin||[],u=0;u<i.length;u++)if(i[u].floor==r){var d=[];d=i[u].figures.map(function(t,e){var i={},a=Number(t.cellName);t.cellCoordX,t.cellCoordY;i.x=Number(t.cellCoordX),i.y=Number(t.cellCoordY),i.width=Number(t.cellWidth),i.height=Number(t.cellHeight),i.name=t.cellName,i.whereFloor=t.floor,i.belongType=t.belongType,i.belongId=Number(t.belongId),i.id=Number(t.id),i.canFigureId=t.canFigureId,i.capacity=t.capacity,i.type=i.belongType,i.seatPrice=t.seatPrice,i.checked=!1,i.status=t.status||4;for(var r=0;r<c.length;r++){var u="STATION";2!=c[r].belongType&&"SPACE"!=c[r].belongType||(u="SPACE"),t.belongId==c[r].id&&t.belongType==u&&2!=t.status&&(i.checked=!1,i.status=3)}for(var d=0;d<s.length;d++){var p="STATION";2!=s[d].belongType&&"SPACE"!=s[d].belongType||(p="SPACE"),t.belongId==s[d].id&&t.belongType==p&&(i.checked=!0,i.status=3)}if(a>=o&&a<=n&&1!=t.status){i.checked=!0;var h={};h.name=t.cellName,h.whereFloor=t.floor,h.belongType=t.belongType,h.belongId=Number(t.belongId),h.id=Number(t.belongId),h.canFigureId=t.canFigureId,h.type=i.belongType,h.capacity=t.capacity,h.seatType="STATION"==i.belongType?"OPEN":"SPACE",h.seatPrice=t.seatPrice,l.push(h)}return i}),e={stations:d||[],isMode:"select",plugin:{onCheckedStationCallback:t.dataChange},map:{translateX:0,translateY:0,scaleEnable:!1,scale:this.scaleNumber/100,contextMenuEnable:!0},backgroundImageUrl:"http://"+window.location.host+i[u].graphFilePath}}this.Map=Object(a.a)("plan-map-content",e),l.length&&(this.startToEnd=l)},rangeSelect:function(t){var e=parseInt(t);this.scaleNumber=e,this.Map.setScale(e/100)},floorsChange:function(t){this.Map&&(this.Map.destory(),this.canvasEles())},submitStation:function(){this.Map.destory(),this.canvasEles()},dataChange:function(t,e){var o=this.selectedObjs,n=this.newfloor,a=this.submitData,r=this.deleteArr,s=[],l={};o.length&&(o.map(function(t){var e=t.floor||t.whereFloor;-1==s.indexOf(e)&&(s.push(e),l["a"+e]=[])}),o.map(function(t,e){var o=t.floor||t.whereFloor;l["a"+o].push(t)}));var c=[].concat(o),u=i()({},r),d=i()({},a);e=[].concat(e);for(var p=0;p<e.length;p++)for(var h=0;h<c.length;h++){var m="STATION";2==c[h].belongType&&(m="SPACE"),e[p].belongId==c[h].id&&e[p].belongType==m&&c.splice(h,1)}d["a"+n]=[].concat(e),u["a"+n]=[].concat(c),this.submitData=d,this.deleteArr=u;var f=[],g=[];for(var v in d)l[v]&&(l[v]=[]),f=f.concat(d[v]);for(var y in o)for(var b in f)o[y].name==f[b].name&&(f[b].originalPrice=o[y].originalPrice);for(var w in u)g=g.concat(u[w]);f=f.map(function(t,e){var o={},n=1,i="OPEN";return"SPACE"!=t.belongType&&2!=t.belongType||(n=2,i="SPACE"),o.id=t.belongId||t.id,o.type=n,o.seatType=i,o.belongType=n,o.whereFloor=t.whereFloor||t.floor,o.name=t.name,o.seatPrice=t.seatPrice,o.capacity=t.capacity,o.originalPrice=t.originalPrice||o.seatPrice||"",o});var S={submitData:f,deleteData:g};this.stationArr=S}}}},"51Ub":function(t,e,o){var n=o("oNwR");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("65342f3c",n,!0,{sourceMap:!1})},"77Yh":function(t,e,o){"use strict";function n(t){o("ev4r")}var i=o("e4V2"),a=o("OVYt"),r=o("VU/8"),s=n,l=r(i.a,a.a,!1,s,null,null);e.a=l.exports},"7rD+":function(t,e,o){var n=o("KbYJ");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("c5886822",n,!0,{sourceMap:!1})},"9pIO":function(t,e,o){"use strict";function n(t,e){if(t)for(var o=t.querySelectorAll(".ivu-table-sort"),n=0;n<o.length;n++){var a=o[n];a.style.width="auto",a.style.height="40px";var r=a.parentNode,s=r.querySelectorAll("span")[0].innerHTML;i(a,t,s,e)}}function i(t,e,o,n){t.innerHTML="";var i=document.createElement("span");i.className=r("init"),t.appendChild(i),i.onclick=function(t){var i=t.target,l=i.className;s(e),i.className=r(l),n({label:o,order:a(l)})}}function a(t){return"kr-table-sort-icon-asc"===t?"desc":"asc"}function r(t){switch(t){case"kr-table-sort-icon-init":return"kr-table-sort-icon-asc";case"kr-table-sort-icon-asc":return"kr-table-sort-icon-desc";case"kr-table-sort-icon-desc":return"kr-table-sort-icon-asc";default:return"kr-table-sort-icon-init"}}function s(t){for(var e=t.querySelectorAll(".ivu-table-sort span"),o=0;o<e.length;o++){e[o].className=r("init")}}e.a=n},Asao:function(t,e,o){"use strict";function n(){switch((0,Object.prototype.toString.call)(0)){case"[object String]":return"string";case"[object Number]":return"number";case"[object Boolean]":return"boolean";case"[object Symbol]":return"symbol";case"[object Undefined]":return"undefined";case"[object Null]":return"null";case"[object Function]":return"function";case"[object Date]":return"date";case"[object Array]":return"array";case"[object RegExp]":return"regExp";case"[object Error]":return"error";case"[object HTMLDocument]":return"node";case"[object global]":return"global"}}e.a=n},Ds1f:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"plan-map-content",style:{height:t.page.height}},[o("div",{staticClass:"num-type",staticStyle:{"margin-bottom":"15px"}},[o("Select",{staticStyle:{width:"100px","margin-right":"15px"},attrs:{placeholder:"floor"},on:{"on-change":t.floorsChange},model:{value:t.newfloor,callback:function(e){t.newfloor=e},expression:"newfloor"}},t._l(t.floors,function(e){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])})),o("Input",{staticStyle:{width:"80px","margin-right":"5px"},attrs:{placeholder:"开始工位"},model:{value:t.inputStart,callback:function(e){t.inputStart=e},expression:"inputStart"}}),t._v("至\n\t\t    "),o("Input",{staticStyle:{width:"80px","margin-right":"5px"},attrs:{placeholder:"结束工位"},model:{value:t.inputEnd,callback:function(e){t.inputEnd=e},expression:"inputEnd"}}),o("Button",{staticStyle:{"margin-right":"15px"},attrs:{type:"primary"},on:{click:t.submitStation}},[t._v("选择")]),o("span",{staticClass:"til"},[t._v("当前比例：")]),o("Slider",{staticStyle:{width:"150px",display:"inline-block","vertical-align":"middle"},attrs:{"v-model":t.scaleNumber,min:50,max:200,step:10},on:{"on-change":t.rangeSelect}}),o("output",{staticStyle:{"margin-left":"15px"}},[t._v(t._s(t.scaleNumber))]),t._v("%\n\t\t")],1),o("div",{style:t.stylePlan,attrs:{id:"plan-map-content"}})])},i=[],a={render:n,staticRenderFns:i};e.a=a},Eqh0:function(t,e,o){"use strict";function n(t){if(t){return a.a.dateToStr("YYYY/MM/DD HH:mm:SS",new Date(t)).replace(/\//g,"-")}return""}var i=o("g4Hp"),a=o.n(i);e.a=n},IoNu:function(t,e){t.exports=function(t,e,o,n){function i(){function i(){r=Number(new Date),o.apply(l,u)}function s(){a=void 0}var l=this,c=Number(new Date)-r,u=arguments;n&&!a&&i(),a&&clearTimeout(a),void 0===n&&c>t?i():!0!==e&&(a=setTimeout(n?s:i,void 0===n?t-c:t))}var a,r=0;return"boolean"!=typeof e&&(n=o,o=e,e=void 0),i}},J0i4:function(t,e,o){"use strict";function n(t){o("pY0k")}var i=o("tBD1"),a=o("P67S"),r=o("VU/8"),s=n,l=r(i.a,a.a,!1,s,"data-v-872aada8",null);e.a=l.exports},JnUb:function(t,e,o){var n=o("XvJJ");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("428044bc",n,!0,{sourceMap:!1})},"K+LH":function(t,e,o){"use strict";function n(t){o("MyuT")}var i=o("LfLl"),a=o("K6ky"),r=o("VU/8"),s=n,l=r(i.a,a.a,!1,s,null,null);e.a=l.exports},K6ky:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"com-select-saler"},[o("Select",{attrs:{"v-model":t.saler,filterable:"",remote:"",clearable:t.clearable,placeholder:t.value,"remote-method":t.remoteSaler,loading:t.loading1,disabled:t.disabled},on:{"on-change":t.changeContent}},t._l(t.salerOptions,function(e,n){return o("Option",{key:e.label,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)},i=[],a={render:n,staticRenderFns:i};e.a=a},KbYJ:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,'.vertical-center-modal{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.vertical-center-modal .ivu-modal{top:0}.required-label{font-size:14px;position:relative;margin-left:5px}.required-label.required-label:before{content:"*";color:red;position:absolute;font-size:18px;left:-7px;top:14px}.pay-error{color:#ed3f14}#chancemsg{position:absolute;bottom:2px;display:block}.OpportunityRequired{color:#ed3f14}.requiremark .ivu-form-item-label:before{content:""}',""])},LEjd:function(t,e,o){"use strict";var n,i=o("woOf"),a=o.n(i),r=o("mvHQ"),s=o.n(r),l=o("bOdI"),c=o.n(l),u=o("J0i4"),d=o("77Yh"),p=o("qehU"),h=o("K+LH"),m=o("yWLh"),f=o("p1B2"),g=o("lsg5"),v=o("g4Hp"),y=o.n(v),b=o("NVoV"),w=(o.n(b),o("bsze")),S=o("VSp2");e.a={data:function(){var t,e=this,o=function(t,o,n){""===o?n(new Error("请先选择首付款日期")):new Date(e.renewForm.start)<new Date(o)?n(new Error("首付款日期不得晚于起始日期")):n()};return t={defaultChanceID:0,opportunityTipStr:"您没有可用的机会，请确认登录账户或前往CRM检查",OpportunityRequired:!0,showChanceSelector:!0,showSaleChance:!1,orderitems:{},showFree:!1,discount:0,disabled:!1,index:1,openStation:!1,stationAmount:"",renewForm:{communityId:"",customerId:"",endDate:"",saler:"",rentAmount:"",items:[],signDate:new Date,saleChanceId:""}},c()(t,"disabled",!1),c()(t,"discountError",!1),c()(t,"selectedDel",[]),c()(t,"ruleCustom",{communityId:[{required:!0,message:"此项不可为空",trigger:"change"}],customerId:[{required:!0,message:"此项不可为空",trigger:"change"}],salerId:[{required:!0,message:"此项不可为空",trigger:"change"}],time:[{required:!0,type:"date",message:"此项不可为空!",trigger:"change"}],firstPayTime:[{required:!0,trigger:"change",validator:o}],endDate:[{required:!0,type:"date",message:"此项不可为空",trigger:"change"}],signDate:[{required:!0,type:"date",message:"此项不可为空",trigger:"change"}]}),c()(t,"stationListData",[]),c()(t,"selecedStation",[]),c()(t,"selecedArr",[]),c()(t,"depositAmount",""),c()(t,"installmentType",""),c()(t,"maxDiscount",{}),c()(t,"minDiscount",""),c()(t,"errorAmount",!1),c()(t,"columns",[{type:"selection",width:60,align:"center"},{title:"工位房间编号",key:"name"},{title:"类型",key:"seatType",render:function(t,e){var o=e.row.seatType;return"SPACE"==o?"独立办公室":"开放工位"}},{title:"工位可容纳人数",key:"capacity"},{title:"定价",key:"guidePrice"},{title:"标准单价（元/月）",key:"guidePrice",render:function(t,o){var n=o.row.originalPrice;return t("Input",{props:{min:o.row.guidePrice,value:o.row.originalPrice},on:{"on-change":function(t){var e=t.target.value;isNaN(e)&&(e=o.row.guidePrice),n=e},"on-blur":function(){if(!/^[0-9]+(.[0-9]{1,2})?$/.test(n)){e.$Notice.error({title:"单价不得多余小数点后两位"});var t=Number(n).toFixed(3);n=t.substring(0,t.lastIndexOf(".")+3)}n<o.row.guidePrice&&(n=o.row.guidePrice,e.$Notice.error({title:"单价不得小于"+o.row.guidePrice})),e.changePrice(o.index,n)}}},"44")}},{title:"租赁期限",key:"address",render:function(t,e){return t("strong",y.a.dateToStr("YYYY-MM-dd",new Date(e.row.start))+"至"+y.a.dateToStr("YYYY-MM-dd",new Date(e.row.end)))}},{title:"小计",key:"originalAmount",render:function(t,e){return w.a.thousand(e.row.originalAmount)}}]),c()(t,"payList",[{value:"ONE",label:"月付"},{value:"TWO",label:"两月付"},{value:"THREE",label:"季付"},{value:"SIX",label:"半年付"},{value:"TWELVE",label:"年付"},{value:"ALL",label:"全款"}]),c()(t,"depositList",[{label:"2个月",value:"2"},{label:"3个月",value:"3"},{label:"4个月",value:"4"},{label:"5个月",value:"5"},{label:"6个月",value:"6"}]),c()(t,"selectAll",!1),c()(t,"youhui",[]),c()(t,"errorPayType",!1),c()(t,"getStationFn",""),c()(t,"ssoId",""),c()(t,"ssoName",""),c()(t,"salerName","请选择"),c()(t,"saleAmount",0),c()(t,"saleAmounts",w.a.smalltoBIG(0)),c()(t,"change",{}),c()(t,"showSaleDiv",!0),c()(t,"openPrice",!1),c()(t,"price",""),c()(t,"priceError",!1),t},head:function(){return{title:"新建续租服务订单管理"}},components:{SectionTitle:u.a,SelectCommunities:d.a,DetailStyle:m.a,SelectCustomers:p.a,SelectSaler:h.a,stationList:g.default,planMap:f.a,SelectChance:S.a},mounted:function(){GLOBALSIDESWITCH("false"),this.getFreeDeposit()},watch:{getStationFn:function(){this.renewForm.customerId&&this.renewForm.communityId&&this.renewForm.endDate&&this.getRenewStation(),this.renewForm.customerId&&this.renewForm.communityId&&this.getSignUser(),this.renewForm.communityId&&this.getSaleTactics({communityId:this.renewForm.communityId})},selecedStation:function(){}},methods:(n={submitPrice:function(){var t=this,e=!1,o=this,n=this.selecedStation;/^[0-9]+(.[0-9]{1,2})?$/.test(this.price)||(e="工位单价不得多于三位小数");var i=this.selectedDel;n=n.filter(function(t,e){return-1!=i.indexOf(t.seatId)}),n.map(function(o){o.guidePrice>t.price&&(e="工位单价不得小于"+o.guidePrice)}),e?this.priceError=e:(this.priceError=!1,this.openPrice=!this.openPrice,this.selecedArr=this.selecedArr.map(function(t){return-1!=i.indexOf(t.seatId)&&(t.originalPrice=Number(o.price)),t}),this.selectedDel=[],this.getStationAmount())},openPriceButton:function(){var t=(this.selecedStation,this.selectedDel);if(console.log("====>",t),!t.length)return void this.$Notice.error({title:"请先选择录入单价的工位"});this.openPrice=!this.openPrice},cancelPrice:function(){this.openPrice=!this.openPrice,this.priceError=!1,this.price=""},changePrice:function(t,e){this.selecedArr[t].originalPrice=e,this.getStationAmount()},back:function(){window.history.go(-1)},getSignUser:function(){var t={communityId:this.renewForm.communityId,customerId:this.renewForm.customerId},e=this;this.$http.get("get-community-floor",t,function(t){e.ssoId=t.data.ssoId,e.ssoName=t.data.ssoName,e.renewForm.salerId||(e.renewForm.salerId=s()(t.data.ssoId),e.salerName=t.data.ssoName,e.validSaleChance())},function(t){console.log("error",t)})},config:function(){this.$Notice.config({top:80,duration:3})},renewFormSubmit:function(){this.config();var t=this.selecedStation,e=!1;if(t.map(function(t){t.originalPrice<t.guidePrice&&(e=!0)}),e)return void this.$Notice.error({title:"工位单价不得小于最低定价"});var o=y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(this.renewForm.start)),n=y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(this.renewForm.endDate)),i=y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(this.renewForm.signDate)),r={};if("complete"!=this.dealSaleInfo(!0)){var l=this.renewForm.items.filter(function(t){return!!t.show});l=l.map(function(t){var e=a()({},t);return 3==t.tacticsType?e.validStart=y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.startDate)):e.validStart=y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.validStart)),e.validEnd=y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.validEnd)),e}),r.installmentType=this.installmentType,r.deposit=this.depositAmount,r.saleList=s()(l),r.seats=s()(this.selecedStation),r.customerId=this.renewForm.customerId,r.communityId=this.renewForm.communityId,r.salerId=this.renewForm.salerId,r.opportunityId=this.renewForm.saleChanceId,r.rentAmount=this.renewForm.rentAmount,r.signDate=i,r.firstPayTime=y.a.dateToStr("YYYY-MM-dd 00:00:00",this.renewForm.firstPayTime),r.startDate=o,r.endDate=n;var c=this;this.disabled=!0,this.$http.post("save-renew",r).then(function(t){window.location.href="/order-center/order-manage/station-order-manage/"+t.data.orderSeatId+"/renewView"}).catch(function(t){c.$Notice.error({title:t.message}),setTimeout(function(){c.disabled=!1},500),console.log("error",t)})}},handleSubmit:function(t){var e=this;this.config();var o=this;this.installmentType||(this.errorPayType=!0),this.depositAmount||(this.errorAmount=!0),this.$refs[t].validate(function(t){if(t){if(!e.selecedStation.length)return e.$Notice.error({title:"请选择续租工位"}),void(o.disabled=!1);if(e.errorAmount||e.errorPayType)return e.$Notice.error({title:"请填写完整表单"}),void(o.disabled=!1);e.disabled=!0,e.renewFormSubmit()}else o.disabled=!1,e.$Notice.error({title:"请填写完整表单"})})},getRenewStation:function(){var t={customerId:this.renewForm.customerId,communityId:this.renewForm.communityId,continueDate:y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(this.renewForm.endDate)),id:null},e=this;this.$http.get("get-renew-station",t,function(t){var o=[];for(var n in t.data){var i={};i.name=y.a.dateToStr("YYYY-MM-dd",new Date(n)),i.value=t.data[n].map(function(t){var e=t;return e.oldPrice=0==t.guidePrice?"":t.guidePrice,e.originalPrice=0==t.guidePrice?"":t.guidePrice,e}),o.push(i)}e.stationListData=o,console.log("getRenewStation=====",o)},function(t){console.log("error",t)})},changeCustomer:function(t){t?(this.renewForm.customerId=t,this.getStationFn=+new Date,this.clearStation()):this.renewForm.customerId="",this.validSaleChance()},changeCommunity:function(t){t?(this.renewForm.communityId=t,this.getStationFn=+new Date):this.renewForm.communityId="",this.validSaleChance(),this.clearStation()},changeChance:function(t){console.log("changeChance"+t),this.renewForm.saleChanceId=t&&0!==t&&-1!=t?t:"",console.log(this.renewForm.saleChanceId)},handleGotChancelist:function(t){t.isNewUser?t.count>=1?(this.showChanceSelector=!0,this.defaultChanceID=t.list[1].value):(this.showChanceSelector=!1,this.OpportunityRequired=!0,this.opportunityTipStr="您没有可用的机会，请确认登录账户或前往CRM检查"):0==t.count&&(this.showChanceSelector=!1,this.OpportunityRequired=!1,this.opportunityTipStr="您没有可用机会，客户增租续租时不必须")},validSaleChance:function(){this.showSaleChance=this.renewForm.salerId&&this.renewForm.customerId&&this.renewForm.communityId;var t={};t.customerId=this.renewForm.customerId,t.communityId=this.renewForm.communityId,t.salerId=this.renewForm.salerId,this.orderitems=a()({},t)},clearStation:function(){this.selecedStation.length&&(this.selecedStation=[],this.selecedArr=[]),this.renewForm.items.length&&(this.renewForm.items=[],this.saleAmount=0,this.saleAmounts=w.a.smalltoBIG(0)),this.discountError&&(this.discountError=!1,this.disabled=!1),this.renewForm.rentAmount="0"},dealEndDate:function(t){var e=t.split("-"),o=e[0],n=parseInt(e[1],10);return t=o+"-"+n+"-"+new Date(o,n,0).getDate()},changeTime:function(t){if(this.clearStation(),!t)return void(this.renewForm.endDate="");t=this.dealEndDate(t),this.renewForm.endDate=t;var e=this;setTimeout(function(){e.getStationFn=+new Date},200)},changeTimeStatus:function(t){if(this.clearStation(),!t)return void(this.renewForm.endDate="");this.renewForm.endDate=y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t));var e=this;setTimeout(function(){e.getStationFn=+new Date,e.selecedStation=[],e.discountError=!1,e.renewForm.items=e.renewForm.items.map(function(t){var e=t;return e.show=!1,e})},200)},changeSaler:function(t){this.renewForm.salerId=t,this.validSaleChance()},showStation:function(){return this.config(),this.renewForm.communityId?this.renewForm.customerId?this.renewForm.endDate?void(this.openStation=!0):void this.$Notice.error({title:"请先选择续租结束时间"}):void this.$Notice.error({title:"请先选择客户"}):void this.$Notice.error({title:"请先选择社区"})},selectDeposit:function(t){this.depositAmount=t,this.errorAmount=!1},selectPayType:function(t){this.installmentType=t,this.errorPayType=!1},handleAdd:function(){return this.config(),this.renewForm.communityId?this.renewForm.customerId?this.renewForm.endDate?(this.showSaleDiv=!0,this.selecedStation.length?(this.index++,void this.renewForm.items.push({value:"",index:this.index,show:!0,status:1,type:""})):void this.$Notice.error({title:"请先选择续租工位"})):void this.$Notice.error({title:"请先选择续租结束时间"}):void this.$Notice.error({title:"请先选择客户"}):void this.$Notice.error({title:"请先选择社区"})},deleteDiscount:function(){var t=this.renewForm.items;t.map(function(t){return t.selelct}),t=t.map(function(t,e){return t.select&&(t.show=!1),t}),this.renewForm.items=t,this.discount="",this.selectDiscount(!1),this.dealSaleInfo(!0)},deleteStation:function(){var t=this.selecedStation,e=this.selectedDel;t=t.filter(function(t,o){return-1==e.indexOf(t.seatId)}),this.selecedStation=t,this.selecedArr=t,this.getStationAmount()},selectRow:function(t){var e=[];e=t.map(function(t){return t.seatId}),this.selectedDel=e},selectDiscount:function(t){var e=this.renewForm.items;e=e.map(function(e){var o=e;return o.select=t,o}),this.selectAll=t,this.renewForm.items=e},getTacticsId:function(t){var e="";return e=this.youhui.filter(function(e){return e.tacticsName==t}),e[0].tacticsId},changeType:function(t){var e=this;if(t){var o=t.label,n=t.value;this.config();var i=n.split("/")[0],a=n.split("/")[1],r=n.split("/")[2],s=n.split("/")[3];this.renewForm.items[a].tacticsName=r,this.renewForm.items[a].tacticsId=s,this.renewForm.items[a].tacticsType=i;var l=[];l=this.renewForm.items.map(function(t){return"qianmian"==t.tacticsType?(t.validStart=e.renewForm.start,t.discount="",t.tacticsId=e.getTacticsId()):3==t.tacticsType&&t.show?(t.validStart=t.startDate||"",t.validEnd=e.renewForm.endDate,t.tacticsId=t.tacticsId||s):1==t.tacticsType&&t.show&&(t.validStart=e.renewForm.start,t.tacticsId=t.tacticsId||s,t.validEnd=e.renewForm.endDate,t.discount=t.discount||""),t});var c=!1,u="",d=l.map(function(t){return t.show?t.tacticsType:void 0}),p=d.join(",").split("qianmian").length-1,h=d.join(",").split("3").length-1,m=d.join(",").split("1").length-1;if(p+h>1&&(c=!0,u="只能有一个免租期。"),m>1&&(c=!0,u="只能有一个折扣。"),c)return this.$Notice.error({title:u}),l[a].show=!1,void(this.renewForm.items=l);1==i&&(this.minDiscount=this.maxDiscount[o]),this.renewForm.items=l,this.dealSaleInfo(!1)}},submitStation:function(){var t=this.selecedArr||[];if(this.openStation=!1,t.length){console.log("submitStation====",this.selecedArr),this.selecedArr=this.selecedArr.map(function(t){var e=t;return e.originalPrice=t.oldPrice,e});var e=t[0].begin;e=new Date(e).getTime();var o=e+864e5;this.renewForm.start=y.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(o)),console.log("========"),this.getStationAmount(),this.clearStation()}}},c()(n,"clearStation",function(){this.renewForm.items=[],this.renewForm.saleAmount=0,this.saleAmount=w.a.smalltoBIG(0)}),c()(n,"getStationAmount",function(){var t=this,e=this.selecedArr,o=this;this.config();var n="",i=!1,a=e.map(function(e){var o=e;return o.guidePrice=e.guidePrice||0,""==e.originalPrice&&(i=!0),o.seatId=e.seatId,n=o.endDate,o.floor=e.whereFloor||e.floor,o.startDate=t.renewForm.start,o.start=t.renewForm.start,o.endDate=y.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(t.renewForm.endDate)),o.end=y.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(t.renewForm.endDate)),o}),r={leaseEnddate:y.a.dateToStr("YYYY-MM-DD 00:00:00",new Date(this.renewForm.endDate)),leaseBegindate:this.renewForm.start,communityId:this.renewForm.communityId,seats:s()(a)};console.log("========",a),this.selecedStation=a,i||e.length&&this.$http.post("get-station-amount",r,function(t){var e=0;o.selecedStation=t.data.seats.map(function(t){var o=t;return e+=t.amount,o.guidePrice=t.guidePrice||0,o.start=t.startDate,o.end=t.endDate,o}),o.disabled=!1,o.selectedDel=[],o.renewForm.rentAmount=Math.round(100*e)/100,o.renewForm.stationAmount=Math.round(100*e)/100,o.stationAmount=w.a.smalltoBIG(Math.round(100*e)/100),o.showSaleDiv&&o.dealSaleInfo(!1)},function(t){o.$Notice.error({title:t.message}),console.log("error",t)})}),c()(n,"cancelStation",function(){this.selecedStation=this.selecedStation.map(function(t){var e=t;return e.time=+new Date,e}),this.openStation=!1}),c()(n,"onStationChange",function(t){console.log(t,"mmmmm"),this.selecedArr=t}),c()(n,"getSaleTactics",function(t){var e=[],o={},n=this;this.$http.get("sale-tactics",t,function(t){e=t.data.length?t.data.map(function(t){var e=t;return e.label=t.tacticsName,e.value=t.tacticsType+"",e.name=t.tacticsName,e.id=t.tacticsId,1==t.tacticsType&&(o[t.tacticsName]=e.discount),e}):[],n.youhui=e,n.maxDiscount=o},function(t){n.youhui=[],console.log("error",t)})}),c()(n,"setCheckFalse",function(t){this.selectDiscount(!1)}),c()(n,"changeSaleTime",function(t){var e=this;setTimeout(function(){e.dealSaleInfo(!0)},200)}),c()(n,"changezhekou",function(t){if(t=t.target.value){if(t=t.replace(/\s/g,""),!/^(\d|[0-9])(\.\d)?$/.test(t))return this.discountError="折扣只能为一位小数或整数",this.disabled=!0,void this.$Notice.error({title:"折扣只能为一位小数或整数"});if(isNaN(t))return this.discountError="折扣必须是数字",void(this.disabled=!0);if(t<this.minDiscount)return this.discountError="折扣不得小于"+this.minDiscount,this.disabled=!0,void this.$Notice.error({title:"折扣不得小于"+this.minDiscount});if(t>9.9)return this.discountError="折扣不得大于9.9",this.disabled=!0,void this.$Notice.error({title:"折扣不得大于9.9"});this.discount=t,this.dealSaleInfo(!0)}}),c()(n,"dealSaleInfo",function(t){var e=this;this.config();var o=this.renewForm.items.filter(function(t){return!!t.show}),n=!0,i=!0;if(o.map(function(t){"1"==t.tacticsType&&e.discount&&(t.discount=e.discount),t.tacticsType||(n=!1),"3"!=t.tacticsType||t.startDate&&t.validEnd||(n=!1),"1"!=t.tacticsType||t.discount?i=e.dealzhekou(t.discount||e.discount):n=!1}),o.length?this.showSaleDiv=!0:this.showSaleDiv=!1,!n&&t)return this.$Notice.error({title:"请填写完整优惠信息"}),this.discountError="请填写完整优惠信息","complete";(n||t)&&(i||t)&&(o=o.map(function(t){var e=a()({},t);return"3"==t.tacticsType?e.validStart=y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.startDate)):e.validStart=y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.validStart)),e.validEnd=y.a.dateToStr("YYYY-MM-dd 00:00:00",new Date(t.validEnd)),e}),this.getSaleAmount(o))}),c()(n,"dealzhekou",function(t){return!!t&&(isNaN(t)?(this.discountError="折扣必须是数字",this.disabled=!0,!1):t<this.minDiscount?(this.discountError="折扣不得小于"+this.minDiscount,this.disabled=!0,this.$Notice.error({title:"折扣不得小于"+this.minDiscount}),!1):!(t>9.9)||(this.discountError="折扣不得大于9.9",this.disabled=!0,this.$Notice.error({title:"折扣不得大于9.9"}),!1))}),c()(n,"getSaleAmount",function(t){var e=this;this.config();var o=this,n={communityId:this.renewForm.communityId,leaseBegindate:this.renewForm.start,leaseEnddate:y.a.dateToStr("YYYY-MM-dd 00:00:00",this.renewForm.endDate),seats:s()(this.selecedStation),saleList:s()(t)};o.disabled=!1,o.discountError=!1,this.$http.post("count-sale",n,function(t){var n=e.renewForm.stationAmount-t.data.totalrent;o.saleAmount=Math.round(100*n)/100,o.saleAmounts=w.a.smalltoBIG(Math.round(100*n)/100),o.renewForm.rentAmount=Math.round(100*t.data.totalrent)/100},function(t){o.disabled=!0,o.discountError=t.message,o.$Notice.error({title:t.message}),console.log("error",t)})}),c()(n,"getFreeDeposit",function(){var t=this;this.$http.get("get-seat-deposit-free","").then(function(e){t.showFree=e.data,e.data&&(t.depositList.push({value:"0",label:"无押金"}),t.depositList.push({value:"1",label:"1个月"}))}).catch(function(e){t.$Notice.error({title:e.message})})}),n)}},LfLl:function(t,e,o){"use strict";var n=o("9Jg8");e.a={props:{onchange:Function,value:String,disabled:Boolean,clearable:{type:Boolean,default:!1}},data:function(){return{saler:"",loading1:!1,salerOptions:[]}},methods:{changeContent:function(t){this.onchange(t)},remoteSaler:function(t){var e=this;""!==t&&(this.loading1=!0,setTimeout(function(){e.getSalerList(t)},200))},getSalerList:function(t){var e={phoneOrEmail:t},o=[],i=this;n.a.get("get-saler",e,function(t){o=t.data.slice(0,10),o.map(function(t){var e=t;return e.label=t.lastname,e.value=t.id+"",e}),i.loading1=!1,i.salerOptions=o},function(t){console.log("error",t)})}}}},MyuT:function(t,e,o){var n=o("P75S");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("041bc169",n,!0,{sourceMap:!1})},NVoV:function(t,e,o){var n=o("Nknv");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("35938d8c",n,!0,{sourceMap:!1})},Nknv:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".create-new-order{padding-bottom:60px}.create-new-order .creat-order-form{max-width:1140px;padding:30px 0}.create-new-order .creat-order-form .col{display:inline-block;width:50%;max-width:450px;padding-right:10px;vertical-align:top}.create-new-order .creat-order-form .total-money{border:1px solid #e9eaec;border-top:0;height:48px;line-height:48px;text-align:right;padding-right:28px;margin-bottom:20px}.create-new-order .creat-order-form .total-money span+span{margin-left:20px}.create-new-order .creat-order-form .total-money .money{color:#ff6868}.create-new-order .creat-order-form .button-list{font-size:14px;color:#499df1;display:inline-block;border:1px solid #499df1;border-radius:4px;margin-right:5px;height:32px;line-height:32px;padding:0 14px;cursor:pointer;margin-bottom:10px}.create-new-order .creat-order-form .active{background-color:#499df1;color:#fff}.create-new-order .creat-order-form .discount-table-head{background:#f5f6fa;height:50px;line-height:50px;text-align:center;font-weight:500;border:1px solid #e9eaec;border-left:none;border-right:none;border-left:1px solid #e9eaec}.create-new-order .creat-order-form .discount-table-content{background:#fff;padding:0 15px;height:50px;line-height:50px;text-align:center;border-left:1px solid #e9eaec;border-bottom:1px solid #e9eaec}.create-new-order .creat-order-form .lastRow{border-bottom:1px solid #e9eaec;margin-bottom:20px}",""])},NpwQ:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"ui-detail-layout"},[o("div",{staticClass:"ui-content-title"},[o("span",{staticClass:"ui-circle"},[t._v(t._s(t.info))])]),t._t("default")],2)},i=[],a={render:n,staticRenderFns:i};e.a=a},OVYt:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"com-select-community"},[o("Select",{attrs:{"v-model":t.test.communityId,filterable:"",placeholder:t.value,disabled:t.disabled},on:{"on-change":t.changeContent}},t._l(t.options1,function(e,n){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)},i=[],a={render:n,staticRenderFns:i};e.a=a},P67S:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement;return(t._self._c||e)("div",{class:t.classType[t.type]},[t._v("\n    "+t._s(t.title)+"\n")])},i=[],a={render:n,staticRenderFns:i};e.a=a},P75S:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".com-select-saler ::-webkit-input-placeholder{color:#666}.com-select-saler ::-moz-placeholder{color:#666}.com-select-saler :-ms-input-placeholder{color:#666}.com-select-saler input:-moz-placeholder{color:#666}",""])},Rrep:function(t,e,o){"use strict";var n=o("pFYg"),i=o.n(n),a=o("woOf"),r=o.n(a),s=function(t,e){var o,n,a,s,l,c,u,d=[],p=1,h=null,m=[],f=[],g={z:1,isMode:"select",modes:["edit","view","select"],stations:[],rulers:[],backgroundImageUrl:""};g.db={reset:function(){g.stations=[]},getAllStation:function(){return[].concat(g.stations)},setAllStation:function(t){g.stations=[].concat(t)},findStationIndex:function(t){var e;return this.getAllStation().map(function(o,n){o.key==t&&(e=n)}),e},newStation:function(t){return t=r()({},t),void 0===this.findStationIndex(t.key)&&g.stations.push(t),this},removeStation:function(t){var e,o=this.getAllStation();if(o.map(function(o,n){t==o.key&&(e=n)}),void 0!==e){o.splice(e,1),this.setAllStation(o);var e;m.map(function(o,n){o.getProps().key==t&&(e=n)}),void 0!==e&&m.splice(e,1)}},getStation:function(t){var e=this.findStationIndex(t),o=this.getAllStation(),n=o[e];return r()({},n)},setStation:function(t,e){var o=this.getStation(t),n=this.findStationIndex(t);if(void 0!==n)return o=r()({},o,e),g.stations.splice(n,1,o),this},getImageUrl:function(){return g.backgroundImageUrl},setImageUrl:function(t){g.backgroundImageUrl=t}},g.utils={isEditMode:function(){return"edit"===g.isMode},isViewMode:function(){return"view"===g.isMode},isSelectMode:function(){return"select"===g.isMode}},g.stationStatus={1:{status:"join",mark:"已入住",textColor:"#fff",backgroundColor:"#499df1"},2:{status:"admit",mark:"不可选工位",textColor:"#fff",backgroundColor:"#499df1"},3:{status:"default",mark:"默认",textColor:"#499df1",backgroundColor:"#ffffff"},4:{status:"notChecked",mark:"未选择",textColor:"#499df1",backgroundColor:"#ffffff"},5:{status:"checked",mark:"已选中",textColor:"#fff",backgroundColor:"#28c288"}},g.station={width:30,height:30,minWidth:30,minHeight:30,maxWidth:200,maxHeight:200,scaleSpeed:20,isToSameSize:!0},g.operationTypeConfigs={canvasTopLineHover:{style:"pointer"},canvasLeftLineHover:{style:"pointer"},rulerHover:{style:"pointer"},mapHover:{style:"move"},stationMove:{style:"move"},stationHover:{style:"pointer"},stationLeftTopScale:{style:"nw-resize"},stationLeftCenterScale:{style:"w-resize"},stationLeftBottomScale:{style:"sw-resize"},stationTopCenterScale:{style:"n-resize"},stationRightTopScale:{style:"ne-resize"},stationRightCenterScale:{style:"e-resize"},stationRightBottomScale:{style:"se-resize"},stationBottomCenterScale:{style:"s-resize"}},g.plugin={onRemoveCallback:null,onScaleMapCallback:null,onCheckedStationCallback:null,onHoverInStationCallback:null,onHoverOutStationCallback:null,onErrorCallback:null,onReadyCallback:null,onRenderMapCallback:null},g.map={contextMenuEnable:!1,menuEnable:!1,mouseEnable:!1,deleteEnable:!0,scaleEnable:!0,rulerEnable:!0,stationClick:!0,scale:1,scaleMax:2,scaleMin:.1,scaleSpeed:.1,translateX:0,translateY:0,isLoadImageError:!1};var v,y,b={down:{},up:{},move:{}},w=function(t){var e=function t(e){e=r()({},t.defaultPropTypes,e),this.setProps(e)};return e.defaultPropTypes={type:"horizontal",x:0,y:0,checked:!1},e.prototype.isHorizontalLine=function(){var t=this.getProps();t.x,t.y;return"horizontal"===t.type},e.prototype.isVerticalLine=function(){var t=this.getProps();t.x,t.y;return"vertical"===t.type},e.prototype.componentWillReceiveProps=function(){this.render()},e.prototype.hasPosition=function(t,e){var o=this.getProps(),n=o.x,i=o.y,a=o.type,r=n-2,s=n+2,l=i-2,c=i+2;return"horizontal"==a?e>=l&&e<=c:"vertical"==a&&t>=r&&t<=s},e.prototype.drawHorizontalLine=function(){var t=this.getProps(),e=t.x,n=t.y,i=t.checked,a=x.transformPositionToView(e,n);o.beginPath(),o.moveTo(0,a.y),o.strokeStyle="red",i&&(o.strokeStyle="green"),o.lineTo(s,a.y),o.closePath(),o.stroke()},e.prototype.drawVerticalLine=function(){var t=this.getProps(),e=t.x,n=t.y,i=t.checked,a=x.transformPositionToView(e,n);o.beginPath(),o.moveTo(a.x,0),o.strokeStyle="red",i&&(o.strokeStyle="green"),o.lineTo(a.x,l),o.closePath(),o.stroke()},e.prototype.move=function(t,e){this.setProps({x:t,y:e})},e.prototype.setProps=function(t){this.props=r()({},this.props,t),this.componentWillReceiveProps()},e.prototype.getProps=function(){return r()({},this.props)},e.prototype.toChecked=function(){var t=this.getProps(),e=t.checked;e=!e,this.setProps({checked:e})},e.prototype.render=function(){"horizontal"==this.getProps().type?this.drawHorizontalLine():this.drawVerticalLine()},new e(t)},S=function t(e){e=e||{},p++,g.z++;var n=function t(e){var e=r()({},t.defaultPropTypes,e);this.stashProps=r()({},t.defaultPropTypes,e),this.componentWillReceiveProps(e)};return n.defaultPropTypes={x:0,y:0,z:g.z,width:g.station.width,height:g.station.height,name:"demo",type:"station",drag:!1,checked:!1,removed:!1,key:p,status:3,switchHoverIn:!1},n.prototype.onHoverIn=function(){var t=g.plugin.onHoverInStationCallback,e=this.getProps();if(!e.switchHoverIn){var o=a.getBoundingClientRect(),n=x.canvasToWindow(e.x,e.y);e.clientX=n.x+o.left,e.clientY=n.y+o.top,this.setProps({switchHoverIn:!0}),t&&t(e)}},n.prototype.onHoverOut=function(){var t=g.plugin.onHoverOutStationCallback,e=this.getProps();if(e.switchHoverIn){this.setProps({switchHoverIn:!1});var o=a.getBoundingClientRect(),n=x.canvasToWindow(e.x,e.y);e.clientX=n.x+o.left,e.clientY=n.y+o.top,t&&t(e)}},n.prototype.getProps=function(){return r()({},this.props)},n.prototype.setProps=function(t){var e=g.station,o=e.minWidth,n=e.minHeight,i=r()({},this.props);i=r()({},this.props,t),i.width<=o&&(i.width=o),i.height<=n&&(i.height=n),this.props=r()({},i),void 0===g.db.findStationIndex(i.key)&&g.db.newStation(i),g.db.setStation(i.key,i)},n.prototype.move=function(t,e){var o=this.stashProps.key,n=(g.db.findStationIndex(o),r()({},{key:o,x:t,y:e,drag:!0}));this.componentWillReceiveProps(n)},n.prototype.remove=function(){var t=this.props.key;this.setProps({removed:!0});g.db.getAllStation();g.db.removeStation(t),g.db.getAllStation()},n.prototype.componentWillReceiveProps=function(t){this.setProps(t),this.render()},n.prototype.saveProps=function(){this.stashProps=r()({},this.props)},n.prototype.getStashProps=function(){return r()({},this.stashProps)},n.prototype.render=function(){var t=this.props,e=t.drag,n=t.checked,a=t.removed,r=t.status;if(!a&&this.props.name){var s=this.props,l=g.stationStatus[r];n&&(l=g.stationStatus[5]);var c=x.transformWidthOrHeightToView(s.width,s.height),u=c.width,d=c.height,p=this.getLeftTopPosition();p=x.transformPositionToView(p.x,p.y),o.moveTo(p.x,p.y),o.beginPath(),o.fillStyle="#fff","object"===(void 0===l?"undefined":i()(l))&&l.hasOwnProperty("backgroundColor")&&(o.fillStyle=l.backgroundColor),o.fillRect(p.x,p.y,u,d),o.closePath(),o.beginPath(),o.font=12*g.map.scale+"px",o.fillStyle="#fff","object"===(void 0===l?"undefined":i()(l))&&l.hasOwnProperty("textColor")&&(o.fillStyle=l.textColor),o.textAlign="center",o.fillText(this.props.name,p.x+u/2,p.y+d/2+5),o.closePath(),e&&this.drawDragStyle()}},n.prototype.isSpace=function(){var t=this.props.type,e=!1;return"SPACE"===t&&(e=!0),e},n.prototype.toChecked=function(){var t=this.props,e=t.checked,o=(t.type,t.status),n=t.z;1!=o&&2!=o&&(n=g.z,g.z++,e=!e,this.componentWillReceiveProps({checked:e,z:n}))},n.prototype.isRemove=function(){return this.props.removed},n.prototype.isStation=function(){var t=this.props.type,e=!1;return"STATION"===t&&(e=!0),e},n.prototype.drawDragStyle=function(){var t=this.props,e=(t.x,t.y,this.props),n=x.transformWidthOrHeightToView(e.width,e.height),i=n.width,a=n.height,r=this.getLeftTopPosition();r=x.transformPositionToView(r.x,r.y),o.beginPath(),o.arc(r.x,r.y,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x,r.y,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.moveTo(r.x+4,r.y),o.lineTo(r.x+i/2,r.y),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x+i/2,r.y),o.lineTo(r.x+i,r.y),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x+4,r.y+a),o.lineTo(r.x+i/2,r.y+a),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x+i/2,r.y+a),o.lineTo(r.x+i,r.y+a),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x,r.y+4),o.lineTo(r.x,r.y+a/2),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x,r.y+a/2),o.lineTo(r.x,r.y+a),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x+i,r.y+4),o.lineTo(r.x+i,r.y+a/2),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.moveTo(r.x+i,r.y+a/2),o.lineTo(r.x+i,r.y+a),o.strokeStyle="#444",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+i,r.y,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+i,r.y,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x+i,r.y+a,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+i,r.y+a,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x,r.y+a,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x,r.y+a,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x+i/2,r.y,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+i/2,r.y,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x+i/2,r.y+a,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+i/2,r.y+a,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x,r.y+a/2,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x,r.y+a/2,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath(),o.beginPath(),o.arc(r.x+i,r.y+a/2,3,0,2*Math.PI),o.strokeStyle="#000",o.stroke(),o.closePath(),o.beginPath(),o.arc(r.x+i,r.y+a/2,2,0,2*Math.PI),o.fillStyle="#3efe0b",o.fill(),o.closePath()},n.prototype.getCenterPosition=function(){var t=this.props;return{x:t.x,y:t.y}},n.prototype.getLeftTopPosition=function(){var t=this.props,e=t.x,o=t.y,n=t.width,i=t.height;return e-=n/2,o-=i/2,{x:e,y:o}},n.prototype.getTopCenterPosition=function(){var t=this.props,e=t.x,o=t.y;t.width;return o-=t.height/2,{x:e,y:o}},n.prototype.getLeftCenterPosition=function(){var t=this.props,e=t.x,o=t.y,n=t.width;t.height;return e-=n/2,{x:e,y:o}},n.prototype.getLeftBottomPosition=function(){var t=this.props,e=t.x,o=t.y,n=t.width,i=t.height;return e-=n/2,o+=i/2,{x:e,y:o}},n.prototype.getBottomCenterPosition=function(){var t=this.props,e=t.x,o=t.y;t.width;return o+=t.height/2,{x:e,y:o}},n.prototype.getRightTopPosition=function(){var t=this.props,e=t.x,o=t.y,n=t.width,i=t.height;return e+=n/2,o-=i/2,{x:e,y:o}},n.prototype.getRightBottomPosition=function(){var t=this.props,e=t.x,o=t.y,n=t.width,i=t.height;return e+=n/2,o+=i/2,{x:e,y:o}},n.prototype.getRightCenterPosition=function(){var t=this.props,e=t.x,o=t.y,n=t.width;t.height;return e+=n/2,{x:e,y:o}},n.prototype.inScalePosition=function(e,o){if(!this.hasPosition(e,o))return!1;var n=this.getLeftTopPosition(),i=this.getTopCenterPosition(),a=this.getLeftCenterPosition(),r=this.getLeftBottomPosition(),s=this.getBottomCenterPosition(),l=this.getRightTopPosition(),c=this.getRightCenterPosition(),d=this.getRightBottomPosition();return t.inRange(e,n.x,6)&&t.inRange(o,n.y,6)?(v="leftTop",u="stationLeftTopScale",!0):t.inRange(e,a.x,6)&&t.inRange(o,a.y,6)?(v="leftCenter",u="stationLeftCenterScale",!0):t.inRange(e,r.x,6)&&t.inRange(o,r.y,6)?(v="leftBottom",u="stationLeftBottomScale",!0):t.inRange(e,i.x,6)&&t.inRange(o,i.y,6)?(v="topCenter",u="stationTopCenterScale",!0):t.inRange(e,s.x,6)&&t.inRange(o,s.y,6)?(v="bottomCenter",u="stationBottomCenterScale",!0):t.inRange(e,l.x,6)&&t.inRange(o,l.y,6)?(v="rightTop",u="stationRightTopScale",!0):t.inRange(e,c.x,6)&&t.inRange(o,c.y,6)?(v="rightCenter",u="stationRightCenterScale",!0):!(!t.inRange(e,d.x,6)||!t.inRange(o,d.y,6))&&(v="rightBottom",u="stationRightBottomScale",!0)},n.prototype.opration=function(){var t=r()({},b.move),e=r()({},b.down);switch(v){case"leftTop":var o=this.getStashProps(),n=Math.sqrt(Math.pow(t.x-e.x,2),Math.pow(t.y-e.y,2));n=t.y-e.y>0?-n:n;var i=this.getProps();i.width=o.width+n,i.height=o.height+n,i.drag=!0,this.componentWillReceiveProps(i);break;case"leftCenter":var o=this.getStashProps(),n=-(t.x-e.x),i=this.getProps();i.width=o.width+n,i.height=o.height,i.width>g.station.minWidth&&(i.x=o.x-n/2),i.drag=!0,this.componentWillReceiveProps(i);break;case"leftBottom":var o=this.getStashProps(),n=Math.sqrt(Math.pow(t.x-e.x,2),Math.pow(t.y-e.y,2));n=t.y-e.y>0?n:-n;var i=this.getProps();i.width=o.width+n,i.height=o.height+n,i.drag=!0,this.componentWillReceiveProps(i);break;case"rightTop":var o=this.getStashProps(),n=Math.sqrt(Math.pow(t.x-e.x,2),Math.pow(t.y-e.y,2));n=t.y-e.y>0?-n:n;var i=this.getProps();i.width=o.width+n,i.height=o.height+n,i.drag=!0,this.componentWillReceiveProps(i);break;case"rightCenter":var o=this.getStashProps(),n=t.x-e.x,i=this.getProps();i.width=o.width+n,i.height=o.height,i.width>=g.station.minWidth&&(i.x=o.x+n/2),i.drag=!0,this.componentWillReceiveProps(i);break;case"rightBottom":var o=this.getStashProps(),n=Math.sqrt(Math.pow(t.x-e.x,2),Math.pow(t.x-e.x,2));n=t.y-e.y>0?n:-n;var i=this.getProps();i.width=o.width+n,i.height=o.height+n,i.drag=!0,this.componentWillReceiveProps(i);break;case"topCenter":var o=this.getStashProps(),n=-(t.y-e.y),i=this.getProps();i.width=i.width,i.height=o.height+n,i.height>=g.station.minHeight&&(i.y=o.y-n/2),i.drag=!0,this.componentWillReceiveProps(i);break;case"bottomCenter":var o=this.getStashProps(),n=t.y-e.y,i=this.getProps();i.width=i.width,i.height=o.height+n,i.height>=g.station.minHeight&&(i.y=o.y+n/2),i.drag=!0,this.componentWillReceiveProps(i)}},n.prototype.hasPosition=function(t,e){var o=this.props,n=o.width,i=o.height,a=this.getLeftTopPosition(),r=a.x,s=r+n,l=a.y,c=l+i;return t>=r&&t<=s&&e>=l&&e<=c},new n(e)};S.inRange=function(t,e,o){e=Math.ceil(Number(e)),o=Math.ceil(Number(o));var n=Math.min(e-o,e+o),i=Math.max(e-o,e+o);return t>=n&&t<=i};var x=function t(e,i){var p=function(t,e){g.db.reset(),m=[],this.isComponentDidMout=!1,this.readyCallback=function(){},n=document.getElementById(t),s=n.clientWidth,l=n.clientHeight,e.hasOwnProperty("stationToSame")&&(g.station.isToSameSize=e.stationToSame),e.hasOwnProperty("backgroundImageUrl")&&g.db.setImageUrl(e.backgroundImageUrl),e.hasOwnProperty("isMode")&&(g.isMode=e.isMode),this.initializeModeConfigs(),e.hasOwnProperty("station")&&(g.station=r()({},g.station,e.station)),e.hasOwnProperty("translateX")&&(g.map.translateX=e.translateX),e.hasOwnProperty("translateY")&&(g.map.translateY=e.translateY),e.hasOwnProperty("map")&&(g.map=r()({},g.map,e.map)),e.hasOwnProperty("stationStatus")&&(g.stationStatus=r()({},g.stationStatus,e.stationStatus)),e.hasOwnProperty("plugin")&&(g.plugin=r()({},g.plugin,e.plugin)),a=document.createElement("canvas"),a.width=s,a.height=l,n.appendChild(a),o=a.getContext("2d"),e.stations.map(function(t,e){var o=r()({},t);o.x=Number(o.x),o.y=Number(o.y),o.width=Number(o.width),o.height=Number(o.height),m.push(S(o))}),g.rulers.map(function(t,e){var o=r()({},t);o.x=Number(o.x),o.y=Number(o.y),f.push(w(o))}),this.loadImage()};return p.prototype.initializeModeConfigs=function(){var t=g.operationTypeConfigs,e=g.utils;e.isViewMode()&&(g.map.deleteEnable=!1,g.map.scaleEnable=!0,g.map.mouseEnable=!1,g.map.rulerEnable=!1,g.map.stationClick=!1,t.stationHover.style="auto"),e.isSelectMode()&&(g.map.deleteEnable=!1,g.map.scaleEnable=!0,g.map.mouseEnable=!1,g.map.rulerEnable=!1),g.operationTypeConfigs=r()({},t)},p.prototype.mapMenu={element:null,create:function(t){if(void 0===c){c=document.createElement("div");document.querySelectorAll('[data-type="left"]');c.style.position="absolute",c.style.width="100px",c.style.height="100px",c.style.right="10px",c.style.top="10px",c.style.border="1px solid red",c.style.zIndex=8,c.innerHTML='<div>\n                        <span data-type="left">左</span>\n                        <span data-type="up">上</span>\n                        <span data-type="right">右</span>\n                        <span data-type="down">下</span>\n                    </div>';var e=null;c.addEventListener("mousedown",function(o){var n=o.target,i=n.getAttribute("data-type");e=window.setInterval(function(){switch(i){case"up":t.operationToTranslateUp();break;case"right":t.operationToTranslateRight();break;case"down":t.operationToTranslateDown();break;case"left":t.operationToTranslateLeft()}},200)}),c.addEventListener("mouseup",function(t){window.clearInterval(e)}),n.appendChild(c)}c.style.display="block"}},p.prototype.loadImage=function(t){var e=this;t=t||g.db.getImageUrl(),t||(g.map.isLoadImageError=!0),g.map.isLoadImageError=!1,h=new Image,h.src=t,h.onerror=function(){g.plugin.onErrorCallback&&g.plugin.onErrorCallback("图片加载错误"),g.map.isLoadImageError=!0,e.render()},h.onload=function(){e.render()}},p.prototype.componentDidMount=function(){var t=g.plugin.readyCallback;this.isComponentDidMout=!0,this.registerEvents(),t&&t()},p.prototype.setMouseStyle=function(){if(void 0!==u){var t=g.operationTypeConfigs,e=t[u];n.style.cursor=e.style}},p.prototype.clear=function(){a.width=s},p.prototype.drawMouserPosition=function(){if(g.map.mouseEnable){var e=b.move,n=t.transformPositionToView(e.x,e.y),i=n.x,a=n.y;o.beginPath(),o.moveTo(i,0),o.strokeStyle="red",o.lineTo(i,l),o.closePath(),o.stroke(),o.beginPath(),o.moveTo(0,a),o.strokeStyle="red",o.lineTo(s,a),o.closePath(),o.stroke()}},p.prototype.operationToTranslateLeft=function(){g.map.translateX-=50,this.render()},p.prototype.operationToTranslateRight=function(){g.map.translateX+=50,this.render()},p.prototype.operationToTranslateUp=function(){g.map.translateY-=50,this.render()},p.prototype.operationToTranslateDown=function(){g.map.translateY+=50,this.render()},p.prototype.render=function(){var t=g.map.menuEnable;if(this.clear(),this.calcMaxMin(),this.drawImage(),this.drawStations(),this.drawRulers(),this.setMouseStyle(),this.drawMouserPosition(),t&&this.mapMenu.create(this),!this.isComponentDidMout)return void this.componentDidMount();var e=g.plugin.onRenderMapCallback;e&&e(a.toDataURL("image/jpeg"))},p.prototype.onRenderMap=function(t){g.plugin.onRenderMapCallback=t},p.prototype.onScaleMap=function(t){g.plugin.onScaleMapCallback=t},p.prototype.onCheckedStation=function(t){g.plugin.onCheckedStationCallback=t},p.prototype.onHoverInStation=function(t){g.plugin.onHoverInStationCallback=t},p.prototype.onHoverOutStation=function(t){g.plugin.onHoverOutStationCallback=t},p.prototype.onError=function(t){g.plugin.onErrorCallback=t},p.prototype.drawRulers=function(){if(f.length)return void f.map(function(t){t.render()})},p.prototype.drawStations=function(){if(m.length)return this.sortStation(),void m.map(function(t){t.isRemove()||t.render()})},p.prototype.cleanStationDragStyle=function(){this.getDragStations().map(function(t){t.setProps({drag:!1})}),this.render()},p.prototype.savePropsToStash=function(){var t=g.map,e=t.translateX,o=t.translateY,n=t.scale;this.stashProps={translateX:e,translateY:o,scale:n}},p.prototype.getStashProps=function(){return r()({},this.stashProps)},p.prototype.scaleMap=function(t){this.savePropsToStash();var e=g.map,o=e.scaleSpeed,n=e.scaleMax,i=e.scaleMin,a=g.plugin.onScaleMapCallback;t>0?g.map.scale+=o:g.map.scale-=o,g.map.scale>n&&(g.map.scale=n,g.map.scale=n),g.map.scale<=i&&(g.map.scale=i);this.getStashProps();a&&a(Math.abs(g.map.scale)),this.render()},p.prototype.registerEvents=function(){var e=this,o=g.map.scaleEnable,n=function(o){t.setMovePosition(o),e.drawRulerMove()},i=function(o){t.setMovePosition(o),e.drawRulerMove()},r=function(t){t.preventDefault();var o=t.deltaY;return e.scaleMap(o),!1},s=function(o){t.setMovePosition(o),e.drawScaleStationMove(),a.addEventListener("mouseup",l,!1)},l=function(e){t.setUpPosition(e),a.removeEventListener("mousemove",s,!1)},c=function(o){t.setMovePosition(o),e.drawDragStationMove(),a.addEventListener("mouseup",h,!1)},h=function o(n){t.setUpPosition(n),e.endDragStation(),a.removeEventListener("mouseup",o,!1),a.removeEventListener("mousemove",c,!1)},m=function(o){t.setMovePosition(o),d.push(b.move);var n=d[0],i=d[d.length-1];(Math.abs(n.x-i.x)>=1||Math.abs(n.y-i.y)>=1)&&e.dragMap(),a.addEventListener("mouseup",f,!1)},f=function e(o){t.setUpPosition(o),a.removeEventListener("mouseup",e,!1),a.removeEventListener("mousemove",m,!1),d=[]},v=function(e){t.setDownPosition(e),g.map.contextMenuEnable&&(p.contextMenu.create(),e.preventDefault())},y=function(o){if(t.setDownPosition(o),!g.map.stationClick)return void a.addEventListener("mousemove",m,!1);var r=b.down;if(2===o.button)return document.addEventListener("contextmenu",v,!1),!1;if(e.isInStation(r.x,r.y)){if(g.utils.isSelectMode())return void e.setCheckedStationStyle(r.x,r.y);e.setDragStationStyle(r.x,r.y),e.startDragStation(),e.isInStationDragPosition(r.x,r.y)?a.addEventListener("mousemove",s,!1):a.addEventListener("mousemove",c,!1)}else e.isInRuler(r.x,r.y)?(e.setCheckedRulerStyle(r.x,r.y),a.addEventListener("mousemove",i,!1)):e.isInCanvasTopLine(r.x,r.y)?(e.newRulerInCanvasTop(r.x,r.y),a.addEventListener("mousemove",n,!1)):e.isInCanvasLeftLine(r.x,r.y)?(e.newRulerInCanvasLeft(r.x,r.y),a.addEventListener("mousemove",n,!1)):(e.cleanStationDragStyle(),a.removeEventListener("mousemove",s,!1),a.removeEventListener("mousemove",c,!1),a.addEventListener("mousemove",m,!1));a.addEventListener("mouseup",w,!1),a.removeEventListener("mousemove",S,!1)},w=function t(e){a.removeEventListener("mousemove",i,!1),a.removeEventListener("mousemove",n,!1),a.removeEventListener("mousemove",s,!1),a.removeEventListener("mousemove",l,!1),a.removeEventListener("mousemove",c,!1),a.removeEventListener("mousemove",h,!1),a.removeEventListener("mousemove",m,!1),a.removeEventListener("mousemove",f,!1),a.removeEventListener("mouseup",t,!1),a.addEventListener("mousemove",S,!1),p.contextMenu.close()},S=function(o){t.setMovePosition(o);var n=b.move;e.judgeHoverInStation(n.x,n.y),e.isInStation(n.x,n.y)?e.isInStationDragPosition(n.x,n.y)||(u="stationHover"):u=e.isInRuler(n.x,n.y)?"rulerHover":e.isInCanvasTopLine(n.x,n.y)?"canvasTopLineHover":e.isInCanvasLeftLine(n.x,n.y)?"canvasLeftLineHover":"mapHover",e.render()},x=function(t){switch(t.keyCode){case 8:case 46:e.removeCheckedStation()}},P=function(t){a.addEventListener("mousemove",S,!1),document.addEventListener("keyup",x,!1),a.addEventListener("mouseleave",k,!1),o&&a.addEventListener("mousewheel",r,!1)},k=function(e){t.setDownPosition(e),a.removeEventListener("mousemove",c,!1),a.removeEventListener("mousemove",m,!1),a.removeEventListener("mousemove",s,!1),a.removeEventListener("mouseup",w,!1),document.removeEventListener("keyup",x,!1),document.removeEventListener("contextmenu",v,!1),a.removeEventListener("mousewheel",r,!1)};a.addEventListener("mousedown",y,!1),a.addEventListener("mouseover",P,!1),document.addEventListener("keyup",x,!1),o&&a.addEventListener("mousewheel",r,!1)},p.prototype.calcMaxMin=function(){g.map.scale>g.map.scaleMax&&(g.map.scale=g.map.scaleMax,g.map.scale=g.map.scaleMax),g.map.scale<=g.map.scaleMin&&(g.map.scale=g.map.scaleMin)},p.prototype.drawImage=function(){if(!g.map.isLoadImageError){var t=h;o.beginPath(),o.drawImage(t,g.map.translateX*g.map.scale,g.map.translateY*g.map.scale,t.width*g.map.scale,t.height*g.map.scale),o.closePath()}},p.prototype.isInStationDragPosition=function(t,e){var o=this.getDragStations(),n=!1;return o.map(function(o){o.inScalePosition(t,e)&&(n=!0)}),n},p.prototype.getDragStations=function(){var t=[],e=null;return m.map(function(o){e=o.getProps(),e.drag&&t.push(o)}),t},p.prototype.sortDescStationObjectArray=function(){m.sort(function(t,e){var o=t.getProps(),n=e.getProps();return parseInt(n.z)-parseInt(o.z)})},p.prototype.sortAscStationObjectArray=function(){m.sort(function(t,e){var o=t.getProps(),n=e.getProps();return parseInt(o.z)-parseInt(n.z)})},p.prototype.setCheckedRulerStyle=function(t,e){for(var o=null,n=0,i=f.length;n<i;n++)o=f[n],o.hasPosition(t,e)?(o.getProps(),o.toChecked()):o.setProps({checked:!1})},p.prototype.setCheckedStationStyle=function(t,e){if(!g.utils.isEditMode()){this.sortDescStationObjectArray();for(var o=null,n={},i=0,a=m.length;i<a;i++)if(o=m[i],o.hasPosition(t,e)){o.toChecked(),n=o.getProps();break}var r=g.plugin.onCheckedStationCallback,s=this.getCheckedAll();r&&r(n,s)}},p.prototype.setDragStationStyle=function(t,e){if(g.utils.isEditMode()){this.cleanDragStations(),this.sortDescStationObjectArray();for(var o=null,n=null,i=0,a=m.length;i<a;i++)if(o=m[i],o.hasPosition(t,e)){n=o.getProps(),n.drag||(n.drag=!0),n.z=g.z,o.componentWillReceiveProps(n);break}g.z++}},p.prototype.sortStation=function(){m.sort(function(t,e){var o=t.getProps(),n=e.getProps();return o.z-n.z})},p.prototype.isInCanvasLeftLine=function(e,o){return t.canvasToWindow(e,o).x<5},p.prototype.newRulerInCanvasTop=function(t,e){if(g.map.rulerEnable){f.map(function(t){t.setProps({checked:!1})});var o=r()({},{x:t,y:e,type:"horizontal",checked:!0});f.push(w(o))}},p.prototype.newRulerInCanvasLeft=function(t,e){if(g.map.rulerEnable){f.map(function(t){t.setProps({checked:!1})});var o=r()({},{x:t,y:e,type:"vertical",checked:!0});f.push(w(o))}},p.prototype.isInCanvasTopLine=function(e,o){return t.canvasToWindow(e,o).y<=8},p.prototype.isInCanvasTopLeft=function(e,o){return t.canvasToWindow(e,o).x<=8},p.prototype.isInRuler=function(t,e){for(var o=null,n=!1,i=0,a=f.length;i<a;i++)if(o=f[i],o.hasPosition(t,e)){n=!0;break}return n},p.prototype.isInStation=function(t,e){for(var o=null,n=!1,i=0,a=m.length;i<a;i++)if(o=m[i],o.hasPosition(t,e)){n=!0;break}return n},p.prototype.stationOtherHoverOut=function(t){for(var e=null,o=null,n=0,i=m.length;n<i;n++)o=m[n],e=o.getProps(),e.key!==t&&o.onHoverOut()},p.prototype.judgeHoverInStation=function(t,e){var o=(g.plugin.onHoverInStationCallback,this),n=null,i=null;this.sortDescStationObjectArray();for(var a=0,r=m.length;a<r;a++){if(n=m[a],i=n.getProps(),n.hasPosition(t,e)){o.stationOtherHoverOut(i.key),n.onHoverIn();break}n.onHoverOut()}},p.prototype.dragMap=function(){var t=d[0],e=d[d.length-1],o=e.x-t.x,n=e.y-t.y,i=Math.abs(o),a=Math.abs(n);Math.max(i,a)<10||(g.map.translateX+=3*(e.x-t.x),g.map.translateY+=3*(e.y-t.y),this.render(),d=[])},p.prototype.startDragStation=function(){this.getDragStations().map(function(t){t.saveProps()})},p.prototype.moveDragStation=function(){},p.prototype.endDragStation=function(){},p.prototype.removeStation=function(){},p.prototype.removeCheckedStation=function(){if(g.map.deleteEnable){var t=this.getDragStations();if(t.length){var e,o=[];t.map(function(t){e=t.getProps(),t.remove(),o.push(e)});var n=[];m=m.filter(function(t){var e=!t.isRemove();return e&&n.push(t.getProps()),e}),this.render(),g.plugin.onRemoveCallback&&g.plugin.onRemoveCallback(o,n)}}},p.prototype.cleanDragStations=function(){var t=this.getDragStations();t=t.filter(function(t){return!t.removed}),this.render()},p.prototype.drawDragStationMove=function(){var t=g.utils,e=this;if(t.isEditMode()){var o=this.getDragStations();m.map(function(t){t.setProps({drag:!1})});var n=b.move.x-b.down.x,i=b.move.y-b.down.y,a={},r=null,s=!1,l={};o.map(function(t,o){r=t.getStashProps(),a.x=r.x+n,a.y=r.y+i;var c=e.getAdsorbPosition(a.x-r.width/2,a.y-r.height/2);if(l.x=c.x+r.width/2,l.y=c.y+r.height/2,a.x===l.x&&a.y===l.y||(s=!0),a.x=l.x,a.y=l.y,t.move(a.x,a.y),c=e.getAdsorbPosition(a.x+r.width/2,a.y+r.height/2),l.x=c.x-r.width/2,l.y=c.y-r.height/2,!s)return a.x=l.x,a.y=l.y,void t.move(a.x,a.y);var u={},d=l.x-a.x,p=l.y-a.y;u.x=a.x+d/2,u.y=a.y+p/2,u.width=r.width+d/2,u.height=r.height+p/2,t.setProps(u)}),this.render()}},p.prototype.getDragRuler=function(){var t=[];return f.map(function(e){e.getProps().checked&&t.push(e)}),t},p.prototype.drawRulerMove=function(){var t=b.move;this.getDragRuler().map(function(e){e.move(t.x,t.y)}),this.render()},p.prototype.drawScaleStationMove=function(){if(g.utils.isEditMode()){var t=(b.move,this.getDragStations());t.map(function(t,e){t.opration(v)});var e=t[0],o=e.getProps();e.isStation()&&(g.station.width=o.width,g.station.height=o.height),this.stationToSameAction(),this.render()}},p.prototype.ready=function(t){g.plugin.readyCallback=t},p.prototype.getCanvasElement=function(){return a},p.prototype.save=function(t){var e={};e.translateX=g.map.translateX,e.translateY=g.map.translateY,e.scale=g.map.scale,e.stations=g.db.getAllStation(),t&&t(e)},p.prototype.destory=function(){m=[],h=null,g.map.scale=1,g.map.translateX=0,g.map.translateY=0,g.db.reset(),n.removeChild(a)},p.prototype.getAdsorbPosition=function(t,e){return f.map(function(o){var n=o.getProps();o.isHorizontalLine()?n.y-20<e&&e<n.y+20&&(e=n.y):o.isVerticalLine()&&n.x-20<t&&t<n.x+20&&(t=n.x)}),{x:t,y:e}},p.prototype.getStationLeftTopPosition=function(){},p.prototype.createStation=function(t){var e=(this.getDragStations(),g.station),o=e.width,n=e.height,i=e.isToSameSize;if(t){g.z++,i&&"STATION"===t.type&&(t.width=o,t.height=n),t.z=g.z;var a=this.getAdsorbPosition(t.x-t.width/2,t.y-t.height/2);t.x=a.x+t.width/2,t.y=a.y+t.height/2;var r=S(t);m.push(r)}},p.prototype.getCheckedAll=function(){var t=[],e={};return m.map(function(o){e=o.getProps(),e.checked&&t.push(e)}),t},p.prototype.setBackgroundImage=function(t){var e=this;g.map.scale=1,g.map.translateX=0,g.map.translateY=0;var o=new FileReader;o.onloadend=function(){e.loadImage(o.result)},o.readAsDataURL(t)},p.prototype.stationToSameAction=function(){this.getDragStations();if(g.station.isToSameSize){var t=g.station,e=t.width,o=t.height;m.map(function(t){t.getProps();t.isStation()&&t.setProps({width:e,height:o})})}},p.prototype.onRemove=function(t){g.plugin.onRemoveCallback=t},p.prototype.setStationToSame=function(t,e){g.station.isToSameSize=t,this.stationToSameAction(),this.render()},p.prototype.setScale=function(t){g.map.scale=t,this.render()},p.contextMenu={create:function(){var e=b.down,o=t.canvasToWindow(e.x,e.y),i=o.x,a=o.y;void 0===y&&(y=document.createElement("div"),y.id="contextMenu",y.className="m-context-menu",y.innerHTML='<ul class="right-menu"><li>加载</li><li>关闭</li></ul>',n.appendChild(y)),y.style.left=i+"px",y.style.top=a+"px",y.style.display="block"},close:function(){void 0!==y&&(y.style.display="none")}},new p(e,i)};x.setUpPosition=function(t){b.up=x.windowToCanvas(t)},x.setDownPosition=function(t){b.down=x.windowToCanvas(t)},x.setMovePosition=function(t){b.move=x.windowToCanvas(t)},x.windowToCanvas=function(t){var e={x:0,y:0},o={};o=a.getBoundingClientRect();var n=t.clientX,i=t.clientY;return e.x=n-o.left*(s/o.width),e.y=i-o.top*(l/o.height),e.x=e.x<0?Math.ceil(e.x):Math.floor(e.x),e.y=e.y<0?Math.ceil(e.y):Math.floor(e.y),x.transformPositionToOrigin(e.x,e.y)},x.canvasToWindow=function(t,e){var o={x:0,y:0},n={};n=a.getBoundingClientRect();var i=t,r=e;return o.x=i+n.left/(s*n.width),o.y=r+n.top/(l*n.height),o.x=o.x<0?Math.ceil(o.x):Math.floor(o.x),o.y=o.y<0?Math.ceil(o.y):Math.floor(o.y),x.transformPositionToView(o.x,o.y)},x.transformWidthOrHeightToView=function(t,e){var o=g.map.scale;return{width:Number(t)*o,height:Number(e)*o}},x.transformWidthOrHeightToOrigin=function(t,e){var o=g.map.scale;return{width:Number(t)/o,height:Number(e)/o}},x.transformPositionToView=function(t,e){var o=g.map,n=o.translateX,i=o.translateY,a=o.scale;return{x:(Number(t)+Number(n))*a,y:(Number(e)+Number(i))*a}},x.transformPositionToOrigin=function(t,e){var o=g.map,n=o.translateX,i=o.translateY,a=o.scale;return{x:Number(t)/a-Number(n),y:Number(e)/a-Number(i)}};var P=x(t,e);return{ready:function(){P.ready.apply(P,arguments)},change:function(){},setScale:function(){P.setScale.apply(P,arguments)},onError:function(){P.onError.apply(P,arguments)},setStationToSame:function(){P.setStationToSame.apply(P,arguments)},save:function(){P.save.apply(P,arguments)},destory:function(){P.destory.apply(P,arguments)},setBackgroundImage:function(){P.setBackgroundImage.apply(P,arguments)},getCheckedAll:function(){P.getCheckedAll.apply(P,arguments)},onRemove:function(){P.onRemove.apply(P,arguments)},onScaleMap:function(){P.onScaleMap.apply(P,arguments)},onCheckedStation:function(){P.onCheckedStation.apply(P,arguments)},onHoverInStation:function(){P.onHoverInStation.apply(P,arguments)},onHoverOutStation:function(){P.onHoverOutStation.apply(P,arguments)},onRenderMap:function(){P.onRenderMap.apply(P,arguments)},createStation:function(){var t=P.getCanvasElement(),e=t.getBoundingClientRect(),o=r()({},arguments[0]);o.x=Number(o.x)-Number(e.left),o.y=Number(o.y)-Number(e.top);var n=x.transformPositionToOrigin(o.x,o.y);o.x=n.x,o.y=n.y,P.createStation(o)}}};e.a=s},T01X:function(t,e,o){var n=o("U5YB");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("7fdf1c90",n,!0,{sourceMap:!1})},"Ta+G":function(t,e,o){"use strict";function n(t){var e=t.type;return"DOMMouseScroll"!=e&&"mousewheel"!=e||(t.delta=t.wheelDelta?t.wheelDelta/120:-(t.detail||0)/3),t.srcElement&&!t.target&&(t.target=t.srcElement),t.preventDefault||void 0===t.returnValue||(t.preventDefault=function(){t.returnValue=!1}),t}var i=function(t,e,o,i){console.log("-------"),window.addEventListener?("mousewheel"===e&&void 0!==document.mozFullScreen&&(e="DOMMouseScroll"),t.addEventListener(e,function(t){o(n(t))},i||!1)):window.attachEvent&&t.attachEvent("on"+e,function(t){t=t||window.event,o(n(t))})};e.a=i},U5YB:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,'.select-station-list{border:1px solid #e9eaec;padding:10px}.station-type{padding:10px 0;font-size:14px;position:relative;margin-left:5px}.station-type.station-type:before{content:"*";color:red;position:absolute;font-size:18px;left:-7px}.station-list{max-height:400px;overflow:auto}',""])},Ucgj:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,'.section-title[data-v-872aada8]{border-bottom:1px solid #e8e9e9;height:50px;font-size:16px;color:#666;line-height:50px;padding-left:25px;position:relative}.section-title[data-v-872aada8]:before{height:24px;border:2px solid #499df1;position:absolute;width:0;content:"";display:inline-block;top:12px;left:0}.section-detail-title[data-v-872aada8]{border-bottom:1px solid #e8e9e9;height:50px;font-size:16px;color:#666;line-height:50px;padding-left:15px;position:relative}',""])},VSp2:function(t,e,o){"use strict";function n(t){o("nnyj")}var i=o("o/MA"),a=o("gJbB"),r=o("VU/8"),s=n,l=r(i.a,a.a,!1,s,null,null);e.a=l.exports},XvJJ:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".com-select-customers ::-webkit-input-placeholder{color:#666}.com-select-customers ::-moz-placeholder{color:#666}.com-select-customers :-ms-input-placeholder{color:#666}.com-select-customers input:-moz-placeholder{color:#666}",""])},bsze:function(t,e,o){"use strict";function n(t){var e=["角","分"],o=["零","壹","贰","叁","肆","伍","陆","柒","捌","玖"],n=[["元","万","亿"],["","拾","佰","仟"]],i=t<0?"负":"";t=Math.abs(t);var a="",r=(t+"").split(".").length,s="00";r>1&&(s=(t+"").split(".")[1]);for(var l=0;l<e.length;l++)o[s[l]]&&(a+=(o[s[l]]+e[l]).replace(/零./,""));a=a||"整",t=Math.floor(t);for(var l=0;l<n[0].length&&t>0;l++){for(var c="",u=0;u<n[1].length&&t>0;u++)c=o[t%10]+n[1][u]+c,t=Math.floor(t/10);a=c.replace(/(零.)*零$/,"").replace(/^$/,"零")+n[0][l]+a}return i+a.replace(/(零.)*零元/,"元").replace(/(零.)+/g,"零").replace(/^整$/,"零元整")}function i(t){for(var e in t)t[e]=""}function a(t,e){var o=[];for(var n in t)t.hasOwnProperty(n)&&o.push(n+"="+t[n]);var e=e+"?"+o.join("&");window.location.href=e}function r(){var t=location.search,e=new Object;if(-1!=t.indexOf("?"))for(var o=t.substr(1),n=o.split("&"),i=0;i<n.length;i++)e[n[i].split("=")[0]]=unescape(n[i].split("=")[1]);return e}function s(t){var e=window.location.href,o=e.split("?")[0],n=[];for(var i in t)t.hasOwnProperty(i)&&n.push(i+"="+t[i]);o=o+"?"+n.join("&"),location.href=o}function l(t){for(var e,o=0,n={},i=[];e=t[o++];){var a=e.id;n[a]||(n[a]=!0,i.push(e))}return i}function c(t,e,o,n){for(var i=0;i<e.length;i++)for(var a=0;a<t.length;a++){var r=o?t[a][o]:t[a],s=n?e[i][n]:e[i];r==s&&t.splice(a,1)}return t}function u(t,e){var o=document.createElement("a");o.href=t,o.download=e,console.log("a--",o,t,e),o.click()}function d(t,e){var o=document.createElement("a");o.href=t,o.target="_blank",o.download=e,o.click()}function p(t,e){return e=parseInt(e,10),new Date(t,e,0).getDate()}function h(t,e){var o,n,i;return o=t.split("-"),n=new Date(o[1]+"/"+o[2]+"/"+o[0]),o=e.split("-"),i=new Date(o[1]+"/"+o[2]+"/"+o[0]),parseInt(Math.abs(n-i)/1e3/60/60/24)}function m(t,e,o){return void 0===o?x()(t,e,!1):x()(t,o,!1!==e)}function f(t,e){var o=new Date(t),n=new Date(o.getFullYear(),o.getMonth(),o.getDate()+e);o.getFullYear(),o.getMonth(),o.getDate();return n.getFullYear()+"-"+(n.getMonth()+1)+"-"+n.getDate()}function g(){var t=document.createElement("div");t.style.width="100%",t.style.height="200px";var e=document.createElement("div"),o=e.style;o.position="absolute",o.top=0,o.left=0,o.pointerEvents="none",o.visibility="hidden",o.width="200px",o.height="150px",o.overflow="hidden",e.appendChild(t),document.body.appendChild(e);var n=t.offsetWidth;e.style.overflow="scroll";var i=t.offsetWidth;return n===i&&(i=e.clientWidth),document.body.removeChild(e),n-i}function v(t,e){var o,n,i;return o=t.split("-"),n=new Date(o[1]+"/"+o[2]+"/"+o[0]),o=e.split("-"),i=new Date(o[1]+"/"+o[2]+"/"+o[0]),parseInt(Math.abs(n-i)/1e3/60/60/24)}var y=o("syeK"),b=o("Ta+G"),w=o("Asao"),S=o("IoNu"),x=o.n(S),P=o("Eqh0"),k=o("9pIO");e.a={smalltoBIG:n,clearForm:i,commonExport:a,getRequest:r,addParams:s,arrayNoRepeat:l,arrayCompare:c,thousand:y.a,downFile:u,addEvent:b.a,dataType:w.a,getDaysInOneMonth:p,dateDiff:h,debounce:m,getScrollBarSize:g,dateCompatible:P.a,tableSort:k.a,dateRange:f,downImg:d,timeRange:v}},c665:function(t,e,o){"use strict";function n(t){o("7rD+")}Object.defineProperty(e,"__esModule",{value:!0});var i=o("LEjd"),a=o("galb"),r=o("VU/8"),s=n,l=r(i.a,a.a,!1,s,null,null);e.default=l.exports},e0mU:function(t,e,o){"use strict";var n=o("9Jg8");e.a={props:{onchange:Function,value:String,disabled:Boolean,labelInValue:{default:!1,type:Boolean},url:{type:String,default:"get-customer"}},data:function(){return{customer:"",loading1:!1,customerOptions:[]}},mounted:function(){this.remoteCustomer()},methods:{changeContent:function(t){this.onchange(t)},remoteCustomer:function(t){var e=this;this.loading1=!0,setTimeout(function(){e.getCusomerList(t)},200)},getCusomerList:function(t){var e={company:t||""},o=[],i=this;return n.a.get(this.url,e,function(t){o=t.data.customerList,o.map(function(t){var e=t;return e.label=t.company,e.value=t.id+"",e}),i.loading1=!1,i.customerOptions=o},function(t){console.log("error---\x3e",t)}),o}}}},e4V2:function(t,e,o){"use strict";o("9Jg8");e.a={props:["onchange","test","value","disabled"],data:function(){return{community:"",loading1:!1,options1:[],labelInValue:!0,clearable:!0}},mounted:function(){this.getCusomerList(" ")},methods:{changeContent:function(t){this.onchange(t)},remoteMethod1:function(t){var e=this;""!==t?(this.loading1=!0,setTimeout(function(){e.loading1=!1,e.getCusomerList(t)},200)):this.getCusomerList(" ")},getCusomerList:function(t){var e=this,o=[],n=this;this.$http.get("join-bill-community","").then(function(t){o=t.data.items,o.map(function(t){var e=t;return e.label=t.name,e.value=t.id+"",e}),n.loading1=!1,n.options1=o}).catch(function(t){e.$Notice.error({title:t.message})})}}}},ev4r:function(t,e,o){var n=o("+nse");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("19ee93de",n,!0,{sourceMap:!1})},gJbB:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"com-select-chance"},[o("Select",{attrs:{filterable:"",clearable:t.clearable,placeholder:t.placeholder,loading:t.loading1,disabled:t.disabled,"label-in-value":t.labelinvalue},on:{"on-change":t.changeContent},model:{value:t.value,callback:function(e){t.value=e},expression:"value"}},t._l(t.salerOptions,function(e){return o("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)},i=[],a={render:n,staticRenderFns:i};e.a=a},galb:function(t,e,o){"use strict";var n=function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"create-new-order"},[o("SectionTitle",{attrs:{title:"新建续租服务订单管理"}}),o("Form",{ref:"renewForm",staticClass:"creat-order-form",attrs:{model:t.renewForm,rules:t.ruleCustom}},[o("DetailStyle",{attrs:{info:"续租信息"}},[o("Row",{staticStyle:{"margin-bottom":"20px"}},[o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"客户名称",prop:"customerId"}},[o("SelectCustomers",{attrs:{name:"renewForm.customerId",onchange:t.changeCustomer}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"所属社区",prop:"communityId"}},[o("SelectCommunities",{attrs:{test:"renewForm",onchange:t.changeCommunity}})],1)],1),t._e(),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"续租结束日期",prop:"endDate"}},[o("DatePicker",{staticStyle:{display:"block"},attrs:{type:"date",placeholder:"续租结束日期",format:"yyyy-MM-dd"},on:{"on-change":t.changeTimeStatus},model:{value:t.renewForm.endDate,callback:function(e){t.$set(t.renewForm,"endDate",e)},expression:"renewForm.endDate"}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"销售员",prop:"salerId"}},[o("SelectSaler",{attrs:{name:"renewForm.salerId",onchange:t.changeSaler,value:t.salerName}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"签署日期",prop:"signDate"}},[o("DatePicker",{staticStyle:{display:"block"},attrs:{type:"date",placeholder:"签署日期",format:"yyyy-MM-dd"},model:{value:t.renewForm.signDate,callback:function(e){t.$set(t.renewForm,"signDate",e)},expression:"renewForm.signDate"}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{directives:[{name:"show",rawName:"v-show",value:t.showSaleChance,expression:"showSaleChance"}],class:{requiremark:!t.OpportunityRequired},staticStyle:{width:"252px"},attrs:{label:"机会",prop:"salerId"}},[o("SelectChance",{directives:[{name:"show",rawName:"v-show",value:t.showChanceSelector,expression:"showChanceSelector"}],attrs:{name:"formItem.salerId",orderitems:t.orderitems,defaultValue:t.defaultChanceID},on:{onChange:t.changeChance,gotChanceList:t.handleGotChancelist}})],1),o("p",{directives:[{name:"show",rawName:"v-show",value:!t.showChanceSelector,expression:"!showChanceSelector"}],class:{OpportunityRequired:t.OpportunityRequired},attrs:{id:"chancemsg"}},[t._v(t._s(t.opportunityTipStr))])],1)],1)],1),o("DetailStyle",{attrs:{info:"金额信息"}},[o("Row",{staticStyle:{"margin-bottom":"10px"}},[o("Col",{staticClass:"col"},[o("Button",{staticStyle:{"margin-right":"20px","font-size":"14px"},attrs:{type:"primary"},on:{click:t.showStation}},[t._v("选择工位")]),o("Button",{staticStyle:{"margin-right":"20px","font-size":"14px"},attrs:{type:"ghost"},on:{click:t.deleteStation}},[t._v("删除")]),o("Button",{staticStyle:{"font-size":"14px"},attrs:{type:"primary"},on:{click:t.openPriceButton}},[t._v("录入单价")])],1)],1),o("Row",{staticStyle:{"margin-bottom":"10px"}},[o("Col",{attrs:{sapn:"24"}},[o("Table",{ref:"selection",attrs:{border:"",columns:t.columns,data:t.selecedStation},on:{"on-selection-change":t.selectRow}}),t.selecedStation.length?o("div",{staticClass:"total-money"},[o("span",[t._v("服务费总计")]),o("span",{staticClass:"money"},[t._v(t._s(t._f("thousand")(t.renewForm.stationAmount)))]),o("span",{staticClass:"money"},[t._v(t._s(t.stationAmount))])]):t._e()],1)],1)],1),o("DetailStyle",{directives:[{name:"show",rawName:"v-show",value:t.youhui.length,expression:"youhui.length"}],staticStyle:{"margin-top":"40px"},attrs:{info:"优惠信息"}},[o("Row",{staticStyle:{"margin-bottom":"10px"}},[o("Col",{staticClass:"col"},[o("Button",{staticStyle:{"margin-right":"20px","font-size":"14px"},attrs:{type:"primary"},on:{click:t.handleAdd}},[t._v("添加")]),o("Button",{staticStyle:{"font-size":"14px"},attrs:{type:"ghost"},on:{click:t.deleteDiscount}},[t._v("删除")]),o("span",{directives:[{name:"show",rawName:"v-show",value:t.discountError,expression:"discountError"}],staticClass:"pay-error"},[t._v(t._s(t.discountError))])],1)],1),o("Row",[o("Col",{staticClass:"discount-table-head",attrs:{span:"3"}},[o("Checkbox",{on:{"on-change":t.selectDiscount},model:{value:t.selectAll,callback:function(e){t.selectAll=e},expression:"selectAll"}})],1),o("Col",{staticClass:"discount-table-head",attrs:{span:"6"}},[o("span",[t._v(" 优惠类型")])]),o("Col",{staticClass:"discount-table-head",attrs:{span:"5"}},[o("span",[t._v("开始时间")])]),o("Col",{staticClass:"discount-table-head",attrs:{span:"5"}},[o("span",[t._v("结束时间")])]),o("Col",{staticClass:"discount-table-head",attrs:{span:"5"}},[o("span",[t._v("折扣")])])],1),t._l(t.renewForm.items,function(e,n){return o("FormItem",{key:n,staticStyle:{margin:"0",border:"1px solid e9eaec","border-top":"none","border-bottom":"none"}},[o("Row",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"item.show"}]},[o("Col",{staticClass:"discount-table-content",staticStyle:{padding:"0"},attrs:{span:"3"}},[o("Checkbox",{model:{value:e.select,callback:function(o){t.$set(e,"select",o)},expression:"item.select"}})],1),o("Col",{staticClass:"discount-table-content",attrs:{span:"6"}},[o("Select",{attrs:{"label-in-value":""},on:{"on-change":t.changeType},model:{value:e.type,callback:function(o){t.$set(e,"type",o)},expression:"item.type"}},t._l(t.youhui,function(e,i){return o("Option",{key:e.value+n+e.name+e.id,attrs:{value:e.value+"/"+n+"/"+e.name+"/"+e.id}},[t._v(t._s(e.label))])}))],1),o("Col",{staticClass:"discount-table-content",attrs:{span:"5"}},[o("DatePicker",{directives:[{name:"show",rawName:"v-show",value:"3"!=e.tacticsType,expression:"item.tacticsType != '3'"}],attrs:{type:"date",placeholder:"开始时间",disabled:""},model:{value:e.validStart,callback:function(o){t.$set(e,"validStart",o)},expression:"item.validStart"}}),o("DatePicker",{directives:[{name:"show",rawName:"v-show",value:"3"==e.tacticsType,expression:"item.tacticsType == '3'"}],attrs:{type:"date",placeholder:"开始时间"},on:{"on-change":t.changeSaleTime},model:{value:e.startDate,callback:function(o){t.$set(e,"startDate",o)},expression:"item.startDate"}})],1),o("Col",{staticClass:"discount-table-content",attrs:{span:"5"}},[o("DatePicker",{attrs:{type:"date",placeholder:"开始时间",disabled:""},model:{value:e.validEnd,callback:function(o){t.$set(e,"validEnd",o)},expression:"item.validEnd"}})],1),o("Col",{staticClass:"discount-table-content",attrs:{span:"5"}},["1"==e.tacticsType?o("Input",{attrs:{placeholder:"折扣"},on:{"on-blur":t.changezhekou},model:{value:e.discount,callback:function(o){t.$set(e,"discount",o)},expression:"item.discount"}}):t._e(),"1"!==e.tacticsType?o("Input",{attrs:{disabled:""},model:{value:e.zhekou,callback:function(o){t.$set(e,"zhekou",o)},expression:"item.zhekou"}}):t._e()],1)],1)],1)}),o("Row",{staticStyle:{"margin-bottom":"10px"}},[o("Col",{attrs:{sapn:"24"}},[t.renewForm.items.length&&t.showSaleDiv?o("div",{staticClass:"total-money"},[o("span",[t._v("优惠金额总计")]),o("span",{staticClass:"money"},[t._v(t._s(t._f("thousand")(t.saleAmount))+" ")]),o("span",{staticClass:"money"},[t._v(t._s(t.saleAmounts))])]):t._e()])],1)],2),o("div",{staticStyle:{"padding-left":"24px"}},[o("Row",[o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"优惠后服务费总额"}},[o("Input",{attrs:{placeholder:"优惠后服务费总额",disabled:""},model:{value:t.renewForm.rentAmount,callback:function(e){t.$set(t.renewForm,"rentAmount",e)},expression:"renewForm.rentAmount"}})],1)],1),o("Col",{staticClass:"col"},[o("FormItem",{staticStyle:{width:"252px"},attrs:{label:"首付款日期",prop:"firstPayTime"}},[o("DatePicker",{staticStyle:{width:"252px"},attrs:{type:"date",placeholder:"首付款日期"},model:{value:t.renewForm.firstPayTime,callback:function(e){t.$set(t.renewForm,"firstPayTime",e)},expression:"renewForm.firstPayTime"}})],1)],1)],1),o("Row",[o("Col",{staticClass:"col"},[o("span",{staticClass:"required-label",staticStyle:{width:"252px",padding:"11px 12px 10px 0",color:"#666",display:"block"}},[t._v("付款方式")]),o("div",{staticStyle:{display:"block","min-width":"252px"}},t._l(t.payList,function(e){return o("span",{key:e.value,staticClass:"button-list",class:{active:t.installmentType==e.value},on:{click:function(o){t.selectPayType(e.value)}}},[t._v(t._s(e.label))])})),t.errorPayType?o("div",{staticClass:"pay-error"},[t._v("请选择付款方式")]):t._e()]),o("Col",{staticClass:"col",staticStyle:{"max-width":"560px"}},[o("span",{staticClass:"required-label",staticStyle:{width:"252px",padding:"11px 12px 10px 0",color:"#666",display:"block"}},[t._v("履约保证金总额")]),o("div",{staticStyle:{display:"block","min-width":"252px"}},t._l(t.depositList,function(e){return o("span",{key:e.value,staticClass:"button-list",class:{active:t.depositAmount==e.value},on:{click:function(o){t.selectDeposit(e.value)}}},[t._v(t._s(e.label))])})),t.errorAmount?o("div",{staticClass:"pay-error"},[t._v("请选择履约保证金总额")]):t._e()])],1)],1),o("FormItem",{staticStyle:{"padding-left":"24px","margin-top":"40px"}},[o("Button",{attrs:{type:"primary",disabled:t.disabled},on:{click:function(e){t.handleSubmit("renewForm")}}},[t._v("提交")])],1)],1),o("Modal",{attrs:{title:"选择工位","ok-text":"保存","cancel-text":"取消",width:"600","class-name":"vertical-center-modal"},model:{value:t.openStation,callback:function(e){t.openStation=e},expression:"openStation"}},[t.stationListData.length?t._e():o("div",[t._v("无可续租工位")]),t.openStation&&t.stationListData.length?o("stationList",{attrs:{label:"可续租工位",stationList:t.stationListData},on:{"on-station-change":t.onStationChange}}):t._e(),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"primary"},on:{click:t.submitStation}},[t._v("确定")]),o("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.cancelStation}},[t._v("取消")])],1)],1),o("Modal",{attrs:{title:"填写单价","ok-text":"保存","cancel-text":"取消","class-name":"vertical-center-modal"},model:{value:t.openPrice,callback:function(e){t.openPrice=e},expression:"openPrice"}},[t.openPrice?o("div",[o("span",{staticStyle:{display:"inline-block",height:"32px","line-height":"32px"}},[t._v(" 工位单价： ")]),o("Input",{staticStyle:{width:"150px"},attrs:{placeholder:"工位单价"},model:{value:t.price,callback:function(e){t.price=e},expression:"price"}}),t.priceError?o("span",{staticStyle:{display:"block",height:"32px","line-height":"32px",color:"red"}},[t._v(t._s(t.priceError))]):t._e()],1):t._e(),o("div",{attrs:{slot:"footer"},slot:"footer"},[o("Button",{attrs:{type:"primary"},on:{click:t.submitPrice}},[t._v("确定")]),o("Button",{on:{click:t.cancelPrice}},[t._v("取消")])],1)])],1)},i=[],a={render:n,staticRenderFns:i};e.a=a},gnYt:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,'.u-clearfix{zoom:1}.u-clearfix:after{clear:both;content:".";height:0;display:block;visibility:hidden}.left{float:left}.ui-detail-layout{padding:0 24px;font-size:14px;color:#333;line-height:14px}.ui-detail-layout .ui-content-title{margin-bottom:24px}.ui-detail-layout .ui-circle{font-weight:700}.ui-detail-layout .ui-circle:before{content:"";width:7px;height:7px;display:inline-block;border:1px solid #333;border-radius:100% 100%;margin-right:6px;vertical-align:middle;margin-top:-3px}',""])},lNj5:function(t,e,o){var n=o("gnYt");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("65d89b4e",n,!0,{sourceMap:!1})},lsg5:function(t,e,o){"use strict";function n(t){o("T01X")}Object.defineProperty(e,"__esModule",{value:!0});var i=o("3W/U"),a=o("+2UJ"),r=o("VU/8"),s=n,l=r(i.a,a.a,!1,s,null,null);e.default=l.exports},nnyj:function(t,e,o){var n=o("sj7E");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("18e4c826",n,!0,{sourceMap:!1})},"o/MA":function(t,e,o){"use strict";var n=o("9Jg8");e.a={props:{defaultValue:0,clearable:{type:Boolean,default:!1},placeholder:"请选择",orderitems:{type:Object}},data:function(){return{labelinvalue:!0,disabled:!1,saler:"",loading1:!1,salerOptions:[{label:"请选择",value:0},{label:"无需机会",value:-1}]}},computed:{value:{get:function(){return this.defaultValue},set:function(t){}}},watch:{salerOptions:function(){var t=Number(this.orderitems.saleChanceId);this.disabled=!(0==t||!t)},orderitems:function(){this.getSalerChanceList()}},methods:{changeContent:function(t){var e=void 0;e="请选择"===t.label||"无需机会"==t.label?"":t.value,this.$emit("onChange",e)},getSalerChanceList:function(){var t=this,e={customerId:this.orderitems.customerId,communityId:this.orderitems.communityId,receiveId:this.orderitems.salerId};if(e.customerId&&e.communityId&&e.receiveId){var o=[],i=this;n.a.get("get-salechance",e,function(e){e.data.items.data.map(function(t){o.push({label:t.name,value:t.id})}),o.unshift({label:"无需机会",value:-1}),i.salerOptions=o;var n={count:o.length-1,isNewUser:e.data.items.isNewUser,list:o};t.$emit("gotChanceList",n)},function(e){t.$Notice.error({title:e.message})})}}}}},oNwR:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".plan-map-content{width:100%}",""])},p1B2:function(t,e,o){"use strict";function n(t){o("51Ub")}var i=o("4XX8"),a=o("Ds1f"),r=o("VU/8"),s=n,l=r(i.a,a.a,!1,s,null,null);e.a=l.exports},pY0k:function(t,e,o){var n=o("Ucgj");"string"==typeof n&&(n=[[t.i,n,""]]),n.locals&&(t.exports=n.locals);o("rjj0")("f811f5dc",n,!0,{sourceMap:!1})},qehU:function(t,e,o){"use strict";function n(t){o("JnUb")}var i=o("e0mU"),a=o("+H/r"),r=o("VU/8"),s=n,l=r(i.a,a.a,!1,s,null,null);e.a=l.exports},sj7E:function(t,e,o){e=t.exports=o("FZ+f")(!1),e.push([t.i,".com-select-chance ::-webkit-input-placeholder{color:#666}.com-select-chance ::-moz-placeholder{color:#666}.com-select-chance :-ms-input-placeholder{color:#666}.com-select-chance input:-moz-placeholder{color:#666}",""])},syeK:function(t,e,o){"use strict";function n(t){if(null===t||void 0===t)return 0;if(isNaN(t))return"NaN";var e=t.toString();if(/^-?\d+\.?\d+$/.test(e))if(/^-?\d+$/.test(e))e=e.replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");else{var o=e.split("."),n=o[0].replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,");e=n+"."+o[1]}return e}e.a=n},tBD1:function(t,e,o){"use strict";e.a={props:{title:String,type:{default:"listTitle",type:String}},data:function(){return{classType:{listTitle:"section-title",detailTitle:"section-detail-title"}}}}},yWLh:function(t,e,o){"use strict";function n(t){o("lNj5")}var i=o("4O/J"),a=o("NpwQ"),r=o("VU/8"),s=n,l=r(i.a,a.a,!1,s,null,null);e.a=l.exports}});
//# sourceMappingURL=renew.d154b415ca0cd00f9ef9.js.map