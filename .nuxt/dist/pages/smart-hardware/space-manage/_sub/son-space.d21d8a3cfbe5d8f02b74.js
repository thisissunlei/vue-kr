webpackJsonp([149],{"+Cbq":function(t,e,a){"use strict";var l=a("g4Hp"),i=a.n(l);e.a={components:{},props:{},data:function(){var t=this;return{faterName:"",page:1,pageSize:15,totalCount:0,pageAll:1,pageAllSize:10,totalAllCount:0,openCreate:!1,deleteSpace:!1,deleteId:"",addId:"",showSpaceList:!1,spaceList:!1,addSpace:!1,tabAllParams:{page:1,pageSize:10},tabParams:{page:1,pageSize:15},formItem:{communityId:"",floor:"",type:""},communityList:[],floorList:[],typeList:[{label:"会议室",value:"BOARDROOM"},{label:"路演厅",value:"ROADSHOW_HALL"},{label:"开放区",value:"OPEN_ZONE"},{label:"走廊",value:"AISLE"},{label:"通用空间",value:"COMMON"},{label:"独立办公室",value:"OFFICE"},{label:"工位",value:"STATION"}],spaceColumns:[{type:"selection",width:60,align:"center"},{title:"空间名称",key:"name",align:"center"},{title:"空间类型",key:"type",align:"center",render:function(t,e){return{OFFICE:"独立办公室",BOARDROOM:"会议室",ROADSHOW_HALL:"路演厅",OPEN_ZONE:"开放区",STATION:"工位",AISLE:"走廊",COMMON:"通用空间"}[e.row.type]}},{title:"添加时间",key:"ctime",align:"center",render:function(t,e){if(e.row.ctime){return i.a.dateToStr("YYYY-MM-DD HH:mm",new Date(e.row.ctime))}}},{title:"操作",key:"operation",align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){t.openDelete(a.row)}}},"移除")])}}],ModelColumns:[{type:"selection",width:60,align:"center"},{title:"社区",key:"communityName",align:"center"},{title:"楼层",key:"floor",align:"center"},{title:"空间名称",key:"name",align:"center"},{title:"空间类型",key:"type",align:"center",render:function(t,e){return{OFFICE:"独立办公室",BOARDROOM:"会议室",ROADSHOW_HALL:"路演厅",OPEN_ZONE:"开放区",STATION:"工位",AISLE:"走廊",COMMON:"通用空间"}[e.row.type]}},{title:"操作",key:"operation",align:"center",render:function(e,a){return e("div",[e("Button",{props:{type:"text",size:"small"},style:{color:"#2b85e4"},on:{click:function(){t.openAdd(a.row)}}},"添加")])}}],tableListAll:[],tableList:[]}},mounted:function(){GLOBALSIDESWITCH("false"),this.faterName=this.$route.query.name,this.getTableData(this.tabParams);var t=this.$route.query.communityId;this.tabAllParams.communityId=t,this.getTableAllData(this.tabAllParams),this.getFloor(t)},methods:{showCreate:function(){this.showSpaceList=!this.showSpaceList,this.spaceList=!this.spaceList;var t=this.$route.query.communityId;this.formItem={communityId:t,floor:"",type:""},this.tabAllParams={page:1,pageSize:10,communityId:t,hasParent:!1},this.getTableAllData(this.tabAllParams)},spaceListCancel:function(){this.showSpaceList=!this.showSpaceList},changePage:function(t){this.tabParams.page=t,this.page=t,this.getTableData(this.tabParams)},changeAllPage:function(t){this.tabAllParams.page=t,this.pageAll=t,this.getTableAllData(this.tabAllParams)},selectCheckBox:function(t){var e=[];t.forEach(function(t,a){e.push(t.id.toString())}),this.deleteId=e.join(",")},selectAddCheckBox:function(t){var e=[];t.forEach(function(t,a){e.push(t.id.toString())}),this.addId=e.join(",")},getTableAllData:function(t){var e=this;this.$http.get("get-space-actions-list",t).then(function(t){e.tableListAll=e.setCheckboxDisable(t.data.items),e.totalAllCount=t.data.totalCount}).catch(function(t){e.$Notice.error({title:t.message})})},setCheckboxDisable:function(t){var e=t,a=this.$route.params,l=a.sub;return e.map(function(t,e){return t.id==l&&(t._disabled=!0),t})},getTableData:function(t){var e=this,a=this.$route.params;t.parentId=a.sub,this.$http.get("get-space-actions-list",t).then(function(t){e.tableList=t.data.items,e.totalCount=t.data.totalCount}).catch(function(t){e.$Notice.error({title:t.message})})},floorChange:function(t){this.tabAllParams.page=1,this.tabAllParams.floor=t,this.pageAll=1,this.getTableAllData(this.tabAllParams)},typeChange:function(t){this.tabAllParams.page=1,this.tabAllParams.type=t,this.pageAll=1,this.getTableAllData(this.tabAllParams)},getFloor:function(t){var e=this,a={communityId:t};this.$http.get("get-space-floor",a).then(function(t){var a=[];t.data.floors.map(function(t,e){var l={};l.label=t,l.value=t,a.push(l)}),e.floorList=a}).catch(function(t){e.$Notice.error({title:t.message})})},deleteAll:function(){this.deleteId?this.deleteSpace=!this.deleteSpace:this.$Notice.error({title:"请选择要移除的空间"})},openDelete:function(t){t&&t.id&&(this.deleteId=t.id.toString()),this.deleteSpace=!this.deleteSpace},onDeleteSpace:function(){var t=this;this.$http.post("remove-children",{ids:this.deleteId}).then(function(e){t.$Notice.success({title:"删除成功"}),t.openDelete(),t.deleteId="",t.getTableData(t.tabParams)}).catch(function(e){t.$Notice.error({title:e.message})})},openAdd:function(t){t&&t.id&&(this.addId=t.id.toString()),this.addSpace=!this.addSpace},addAll:function(){this.addId?this.addSpace=!this.addSpace:this.$Notice.error({title:"请选择要添加的空间"})},onAddSpace:function(){var t=this,e=this.$route.params;this.$http.post("add-children",{childIds:this.addId,spaceId:e.sub}).then(function(e){t.$Notice.success({title:"添加成功"}),t.openAdd(),t.showCreate(),t.addId="",t.getTableData(t.tabParams)}).catch(function(e){t.$Notice.error({title:e.message})})}}}},"9oir":function(t,e,a){var l=a("fljY");"string"==typeof l&&(l=[[t.i,l,""]]),l.locals&&(t.exports=l.locals);a("rjj0")("37812153",l,!0,{sourceMap:!1})},fljY:function(t,e,a){e=t.exports=a("FZ+f")(!1),e.push([t.i,".g-spacemanage-detail .u-table{padding:0 20px}.g-spacemanage-detail .ivu-table-cell{padding:0}.u-bread{padding:20px 0 0 20px}.u-search{height:32px;margin:16px 0;padding:0 20px}.u-search .u-btn-add{margin-right:20px}.u-select-content{float:right}.u-select-content .u-select{float:left;width:200px;margin-left:10px}.u-spacemanage-cancel{margin-top:30px;text-align:center}",""])},"k+9a":function(t,e,a){"use strict";var l=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"g-spacemanage-detail"},[a("div",{staticClass:"u-bread"},[a("Breadcrumb",[a("BreadcrumbItem",[t._v("主页")]),a("BreadcrumbItem",[t._v(t._s(t.faterName))])],1)],1),a("div",{staticClass:"u-search"},[a("Button",{staticClass:"u-btn-add",attrs:{type:"primary"},on:{click:t.showCreate}},[t._v("添加空间")]),a("Button",{attrs:{type:"error"},on:{click:t.deleteAll}},[t._v("批量移除")])],1),a("div",{staticClass:"u-table"},[a("Table",{attrs:{border:"",columns:t.spaceColumns,data:t.tableList},on:{"on-select":t.selectCheckBox,"on-select-all":t.selectCheckBox,"on-selection-change":t.selectCheckBox}}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{current:t.page,total:t.totalCount,"page-size":t.pageSize,"show-total":"","show-elevator":""},on:{"on-change":t.changePage}})],1)])],1),a("Modal",{attrs:{title:"移除","ok-text":"确定","cancel-text":"取消",width:"490"},model:{value:t.deleteSpace,callback:function(e){t.deleteSpace=e},expression:"deleteSpace"}},[a("div",{staticClass:"u-spacemanage-cancel"},[t._v("\n            确认要移除空间吗？\n        ")]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:t.onDeleteSpace}},[t._v("确定")]),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.openDelete}},[t._v("取消")])],1)]),t.showSpaceList?a("div",[a("Modal",{attrs:{title:"添加",width:"1000"},on:{"on-cancel":t.spaceListCancel},model:{value:t.spaceList,callback:function(e){t.spaceList=e},expression:"spaceList"}},[a("div",{staticClass:"u-search"},[a("Button",{attrs:{type:"primary"},on:{click:t.addAll}},[t._v("批量添加")]),a("div",{staticClass:"u-select-content"},[a("div",{staticClass:"u-select"},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择楼层",clearable:""},on:{"on-change":t.floorChange},model:{value:t.formItem.floor,callback:function(e){t.$set(t.formItem,"floor",e)},expression:"formItem.floor"}},t._l(t.floorList,function(e){return a("Option",{key:e.value,attrs:{value:""+e.value}},[t._v(t._s(e.label))])}))],1),a("div",{staticClass:"u-select"},[a("Select",{staticStyle:{width:"200px"},attrs:{placeholder:"请选择空间类型",clearable:""},on:{"on-change":t.typeChange},model:{value:t.formItem.type,callback:function(e){t.$set(t.formItem,"type",e)},expression:"formItem.type"}},t._l(t.typeList,function(e){return a("Option",{key:e.value,attrs:{value:e.value}},[t._v(t._s(e.label))])}))],1)])],1),a("Table",{attrs:{border:"",columns:t.ModelColumns,data:t.tableListAll},on:{"on-select":t.selectAddCheckBox,"on-select-all":t.selectAddCheckBox,"on-selection-change":t.selectAddCheckBox}}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{current:t.pageAll,total:t.totalAllCount,"page-size":t.pageAllSize,"show-total":"","show-elevator":""},on:{"on-change":t.changeAllPage}})],1)]),a("div",{attrs:{slot:"footer"},slot:"footer"})],1),a("Modal",{attrs:{title:"添加","ok-text":"确定","cancel-text":"取消",width:"490"},model:{value:t.addSpace,callback:function(e){t.addSpace=e},expression:"addSpace"}},[a("div",{staticClass:"u-spacemanage-cancel"},[t._v("\n                确认要添加空间吗？\n            ")]),a("div",{attrs:{slot:"footer"},slot:"footer"},[a("Button",{attrs:{type:"primary"},on:{click:t.onAddSpace}},[t._v("确定")]),a("Button",{staticStyle:{"margin-left":"8px"},attrs:{type:"ghost"},on:{click:t.openAdd}},[t._v("取消")])],1)])],1):t._e()],1)},i=[],s={render:l,staticRenderFns:i};e.a=s},p2bi:function(t,e,a){"use strict";function l(t){a("9oir")}Object.defineProperty(e,"__esModule",{value:!0});var i=a("+Cbq"),s=a("k+9a"),o=a("VU/8"),n=l,c=o(i.a,s.a,!1,n,null,null);e.default=c.exports}});
//# sourceMappingURL=son-space.d21d8a3cfbe5d8f02b74.js.map